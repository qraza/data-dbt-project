{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.1", "generated_at": "2025-06-23T19:52:51.771716Z", "invocation_id": "217aec72-7e0d-4622-b208-3afc7924f3f3", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T19:52:51.739711Z", "completed_at": "2025-06-23T19:52:51.742589Z"}, {"name": "execute", "started_at": "2025-06-23T19:52:51.743882Z", "completed_at": "2025-06-23T19:52:51.743889Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005630016326904297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.data_takehome.raw_activities", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T19:52:51.743097Z", "completed_at": "2025-06-23T19:52:51.743722Z"}, {"name": "execute", "started_at": "2025-06-23T19:52:51.745794Z", "completed_at": "2025-06-23T19:52:51.745798Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0070302486419677734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.data_takehome.raw_patients", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T19:52:51.744203Z", "completed_at": "2025-06-23T19:52:51.744849Z"}, {"name": "execute", "started_at": "2025-06-23T19:52:51.746157Z", "completed_at": "2025-06-23T19:52:51.746160Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0070188045501708984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.data_takehome.raw_pcns", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T19:52:51.745004Z", "completed_at": "2025-06-23T19:52:51.745636Z"}, {"name": "execute", "started_at": "2025-06-23T19:52:51.746671Z", "completed_at": "2025-06-23T19:52:51.746674Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.00733494758605957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.data_takehome.raw_practices", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T19:52:51.750062Z", "completed_at": "2025-06-23T19:52:51.754125Z"}, {"name": "execute", "started_at": "2025-06-23T19:52:51.754530Z", "completed_at": "2025-06-23T19:52:51.754536Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.0070171356201171875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.data_takehome.stg__patients", "compiled": true, "compiled_code": "with patients as (\nselect * from \"data_takehome\".\"main\".\"raw_patients\" )\n\nselect * from patients", "relation_name": "\"data_takehome\".\"main\".\"stg__patients\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T19:52:51.748630Z", "completed_at": "2025-06-23T19:52:51.754286Z"}, {"name": "execute", "started_at": "2025-06-23T19:52:51.754920Z", "completed_at": "2025-06-23T19:52:51.754923Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.007756710052490234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.data_takehome.stg__activities", "compiled": true, "compiled_code": "with activities as (\nselect * from \"data_takehome\".\"main\".\"raw_activities\" )\n\nselect * from activities", "relation_name": "\"data_takehome\".\"main\".\"stg__activities\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T19:52:51.751426Z", "completed_at": "2025-06-23T19:52:51.755224Z"}, {"name": "execute", "started_at": "2025-06-23T19:52:51.755777Z", "completed_at": "2025-06-23T19:52:51.755780Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.0076847076416015625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.data_takehome.stg__pcns", "compiled": true, "compiled_code": "with pcns as (\nselect * from \"data_takehome\".\"main\".\"raw_pcns\" )\n\nselect * from pcns", "relation_name": "\"data_takehome\".\"main\".\"stg__pcns\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T19:52:51.752621Z", "completed_at": "2025-06-23T19:52:51.755364Z"}, {"name": "execute", "started_at": "2025-06-23T19:52:51.756045Z", "completed_at": "2025-06-23T19:52:51.756048Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.00763392448425293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.data_takehome.stg__practices", "compiled": true, "compiled_code": "with practices as (\nselect * from \"data_takehome\".\"main\".\"raw_practices\" )\n\nselect * from practices", "relation_name": "\"data_takehome\".\"main\".\"stg__practices\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T19:52:51.756907Z", "completed_at": "2025-06-23T19:52:51.760035Z"}, {"name": "execute", "started_at": "2025-06-23T19:52:51.760186Z", "completed_at": "2025-06-23T19:52:51.760189Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.003919839859008789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.data_takehome.int__patients", "compiled": true, "compiled_code": "WITH patients AS (\n  SELECT \n    json_extract_string(data, '$.patient_id') AS patient_id,\n    json_extract_string(data, '$.practice_id') AS practice_id,\n    json_extract_string(data, '$.age') AS age,\n    json_extract_string(data, '$.gender') AS gender,\n    json_extract_string(data, '$.registration_date') AS registration_date,\n    json_extract_string(data, '$.conditions') AS conditions,\n    json_extract_string(data, '$.contact.email') AS email,\n    json_extract_string(data, '$.contact.phone') AS phone\n  FROM \"data_takehome\".\"main\".\"stg__patients\"\n)\n\n, clean_patients as (\n-- remove square brackets from conditions column and clean phone number\nSELECT \n  patient_id,\n  case when practice_id = 'invalid' then '999'\n       when practice_id IS NULL then '0' ELSE practice_id END AS practice_id,\n  age,\n  gender,\n  registration_date,\n  replace(CASE\n    WHEN conditions LIKE '[%' AND conditions LIKE '%]'\n    THEN substr(conditions, 2, length(conditions)-2)\n    ELSE conditions\n  END, '\"', '') as conditions,\n  email,\n      regexp_replace(\n        -- Step 2: Handle leading 1 or 001\n        CASE\n            WHEN regexp_matches(regexp_replace(phone, '[^0-9]', '', 'g'), '^(1|001)')\n            THEN regexp_replace(regexp_replace(phone, '[^0-9]', '', 'g'), '^(1|001)', '')\n            -- Step 3: Preserve numbers before letters, remove after\n            ELSE regexp_replace(\n                regexp_replace(phone, '([0-9]+)[a-zA-Z].*', '\\1'),\n                '[^0-9]', '', 'g'\n            )\n        END,\n        -- Final cleanup in case any special chars remain\n        '[^0-9]', '', 'g'\n    ) AS phone\nFROM patients)\n\nselect\n     patient_id\n   , CAST(practice_id AS INT) AS practice_id\n   , CAST(nullif(age, 'unknown') AS INT) AS age\n   , gender\n   , registration_date\n   , conditions\n   , email\n   , phone\nfrom (\nselect *\n , dense_rank() over (partition by patient_id order by registration_date desc) as rank\nfrom clean_patients) as a\nwhere rank = 1", "relation_name": "\"data_takehome\".\"main\".\"int__patients\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T19:52:51.758665Z", "completed_at": "2025-06-23T19:52:51.760686Z"}, {"name": "execute", "started_at": "2025-06-23T19:52:51.761051Z", "completed_at": "2025-06-23T19:52:51.761054Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.002794981002807617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.data_takehome.int__practices", "compiled": true, "compiled_code": "with pcns as (\nselect *\nFROM \"data_takehome\".\"main\".\"stg__pcns\"\n)\n\n, practices as (\nselect *\nFROM \"data_takehome\".\"main\".\"stg__practices\"\n)\n\n\nselect\n     practices.id\n   , practices.practice_name\n   , practices.location\n   , practices.established_date\n   , practices.pcn\n   , pcn_name\n  from practices\n  left join pcns\n  on pcns.id = practices.pcn", "relation_name": "\"data_takehome\".\"main\".\"int__practices\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T19:52:51.761513Z", "completed_at": "2025-06-23T19:52:51.768852Z"}, {"name": "execute", "started_at": "2025-06-23T19:52:51.769008Z", "completed_at": "2025-06-23T19:52:51.769011Z"}], "thread_id": "Thread-17 (worker)", "execution_time": 0.008222818374633789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.data_takehome.unique_int__patients_patient_id.96eaf91145", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    patient_id as unique_field,\n    count(*) as n_records\n\nfrom \"data_takehome\".\"main\".\"int__patients\"\nwhere patient_id is not null\ngroup by patient_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-06-23T19:52:51.766754Z", "completed_at": "2025-06-23T19:52:51.769355Z"}, {"name": "execute", "started_at": "2025-06-23T19:52:51.769519Z", "completed_at": "2025-06-23T19:52:51.769523Z"}], "thread_id": "Thread-19 (worker)", "execution_time": 0.003192901611328125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.data_takehome.patient_metadata", "compiled": true, "compiled_code": "with patients as (\nselect *\n FROM \"data_takehome\".\"main\".\"int__patients\"\n)\n\n, practices as (\nselect *\n FROM \"data_takehome\".\"main\".\"int__practices\"\n)\n\nselect\n      patient_id\n    , practice_id\n    , practices.practice_name\n    , practices.location\n    , pcn_name\n    , age\n    , gender\n    , registration_date\n    , conditions\nFROM patients\nLEFT JOIN practices\nON patients.practice_id = practices.id", "relation_name": "\"data_takehome\".\"main\".\"patient_metadata\""}], "elapsed_time": 0.11565303802490234, "args": {"quiet": false, "show_resource_report": false, "enable_legacy_logger": false, "profiles_dir": "/Users/qamr/Documents/Development/suvera/data-dbt-takehome", "populate_cache": true, "use_colors": true, "macro_debugging": false, "version_check": true, "partial_parse_file_diff": true, "vars": {}, "compile": true, "exclude": [], "warn_error_options": {"include": [], "exclude": []}, "log_format": "default", "require_resource_names_without_spaces": false, "send_anonymous_usage_stats": true, "select": [], "introspect": true, "source_freshness_run_project_hooks": false, "strict_mode": false, "log_level_file": "debug", "indirect_selection": "eager", "which": "generate", "log_file_max_bytes": 10485760, "print": true, "static": true, "log_format_file": "debug", "write_json": true, "printer_width": 80, "partial_parse": true, "static_parser": true, "log_path": "/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs", "cache_selected_only": false, "empty_catalog": false, "project_dir": "/Users/qamr/Documents/Development/suvera/data-dbt-takehome", "use_colors_file": true, "log_level": "info", "favor_state": false, "defer": false, "invocation_command": "dbt docs generate --static", "require_explicit_package_overrides_for_builtin_materializations": true}}