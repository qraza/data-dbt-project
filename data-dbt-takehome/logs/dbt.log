[0m18:47:32.034478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109585a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a27d520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a27d2b0>]}


============================== 18:47:32.037014 | 57a65672-90d9-40fe-aca4-140a6b5c8ba8 ==============================
[0m18:47:32.037014 [info ] [MainThread]: Running with dbt=1.8.1
[0m18:47:32.037318 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt init', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:47:32.045085 [info ] [MainThread]: Setting up your profile.
[0m18:47:49.144240 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 17.146177, "process_user_time": 0.700516, "process_kernel_time": 0.131183, "process_mem_max_rss": "94289920", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:47:49.145844 [debug] [MainThread]: Command `dbt init` succeeded at 18:47:49.145586 after 17.15 seconds
[0m18:47:49.146664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a07fd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a30f8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a238c50>]}
[0m18:47:49.147562 [debug] [MainThread]: Flushing usage events
[0m18:49:55.343756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a7830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088f98e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088f9610>]}


============================== 18:49:55.346396 | e786b6cd-4ce4-4601-aa2f-95cbc38c0e05 ==============================
[0m18:49:55.346396 [info ] [MainThread]: Running with dbt=1.8.1
[0m18:49:55.346736 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt seed', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:49:55.999102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e786b6cd-4ce4-4601-aa2f-95cbc38c0e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a01550>]}
[0m18:49:56.042584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e786b6cd-4ce4-4601-aa2f-95cbc38c0e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085c7b00>]}
[0m18:49:56.043258 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m18:49:56.096145 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m18:49:56.096582 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:49:56.096759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e786b6cd-4ce4-4601-aa2f-95cbc38c0e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108528530>]}
[0m18:49:56.472438 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_takehome
- models.data_takehome.staging
[0m18:49:56.475031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e786b6cd-4ce4-4601-aa2f-95cbc38c0e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dbba70>]}
[0m18:49:56.507902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e786b6cd-4ce4-4601-aa2f-95cbc38c0e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d62d20>]}
[0m18:49:56.508191 [info ] [MainThread]: Found 4 seeds, 421 macros
[0m18:49:56.508353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e786b6cd-4ce4-4601-aa2f-95cbc38c0e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cd0f80>]}
[0m18:49:56.511130 [info ] [MainThread]: 
[0m18:49:56.511567 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:49:56.513993 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_data_takehome'
[0m18:49:56.544867 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome"
[0m18:49:56.545110 [debug] [ThreadPool]: On list_data_takehome: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m18:49:56.545259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:49:56.550458 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m18:49:56.551253 [debug] [ThreadPool]: On list_data_takehome: Close
[0m18:49:56.553652 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data_takehome, now create_data_takehome_main)
[0m18:49:56.553866 [debug] [ThreadPool]: Creating schema "database: "data_takehome"
schema: "main"
"
[0m18:49:56.557168 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m18:49:56.557341 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
        select type from duckdb_databases()
        where database_name='data_takehome'
        and type='sqlite'
    
  
[0m18:49:56.557474 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:49:56.560208 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m18:49:56.560916 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m18:49:56.561057 [debug] [ThreadPool]: On create_data_takehome_main: BEGIN
[0m18:49:56.561206 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:49:56.561322 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m18:49:56.561440 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
    
        create schema if not exists "data_takehome"."main"
    
[0m18:49:56.561676 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:49:56.562062 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m18:49:56.562185 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m18:49:56.562294 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m18:49:56.562430 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m18:49:56.562546 [debug] [ThreadPool]: On create_data_takehome_main: Close
[0m18:49:56.563436 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_data_takehome_main, now list_data_takehome_main)
[0m18:49:56.566027 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m18:49:56.566181 [debug] [ThreadPool]: On list_data_takehome_main: BEGIN
[0m18:49:56.566299 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:49:56.568311 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:49:56.568456 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m18:49:56.568584 [debug] [ThreadPool]: On list_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome_main"} */
select
      'data_takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'data_takehome'
  
[0m18:49:56.579914 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m18:49:56.580543 [debug] [ThreadPool]: On list_data_takehome_main: ROLLBACK
[0m18:49:56.581517 [debug] [ThreadPool]: Failed to rollback 'list_data_takehome_main'
[0m18:49:56.581660 [debug] [ThreadPool]: On list_data_takehome_main: Close
[0m18:49:56.582425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e786b6cd-4ce4-4601-aa2f-95cbc38c0e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d8b230>]}
[0m18:49:56.582627 [debug] [MainThread]: Using duckdb connection "master"
[0m18:49:56.582752 [debug] [MainThread]: On master: BEGIN
[0m18:49:56.582872 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:49:56.584960 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m18:49:56.585115 [debug] [MainThread]: On master: COMMIT
[0m18:49:56.585242 [debug] [MainThread]: Using duckdb connection "master"
[0m18:49:56.585355 [debug] [MainThread]: On master: COMMIT
[0m18:49:56.585493 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:49:56.585613 [debug] [MainThread]: On master: Close
[0m18:49:56.586061 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m18:49:56.586256 [info ] [MainThread]: 
[0m18:49:56.588202 [debug] [Thread-1 (]: Began running node seed.data_takehome.raw_activities
[0m18:49:56.588394 [debug] [Thread-2 (]: Began running node seed.data_takehome.raw_patients
[0m18:49:56.588781 [debug] [Thread-3 (]: Began running node seed.data_takehome.raw_pcns
[0m18:49:56.588944 [debug] [Thread-4 (]: Began running node seed.data_takehome.raw_practices
[0m18:49:56.588645 [info ] [Thread-1 (]: 1 of 4 START seed file main.raw_activities ..................................... [RUN]
[0m18:49:56.589172 [info ] [Thread-2 (]: 2 of 4 START seed file main.raw_patients ....................................... [RUN]
[0m18:49:56.589403 [info ] [Thread-3 (]: 3 of 4 START seed file main.raw_pcns ........................................... [RUN]
[0m18:49:56.589602 [info ] [Thread-4 (]: 4 of 4 START seed file main.raw_practices ...................................... [RUN]
[0m18:49:56.589811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_takehome_main, now seed.data_takehome.raw_activities)
[0m18:49:56.590034 [debug] [Thread-2 (]: Acquiring new duckdb connection 'seed.data_takehome.raw_patients'
[0m18:49:56.590244 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.data_takehome.raw_pcns'
[0m18:49:56.590430 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.data_takehome.raw_practices'
[0m18:49:56.590579 [debug] [Thread-1 (]: Began compiling node seed.data_takehome.raw_activities
[0m18:49:56.590729 [debug] [Thread-2 (]: Began compiling node seed.data_takehome.raw_patients
[0m18:49:56.590862 [debug] [Thread-3 (]: Began compiling node seed.data_takehome.raw_pcns
[0m18:49:56.590993 [debug] [Thread-4 (]: Began compiling node seed.data_takehome.raw_practices
[0m18:49:56.591132 [debug] [Thread-1 (]: Began executing node seed.data_takehome.raw_activities
[0m18:49:56.591267 [debug] [Thread-2 (]: Began executing node seed.data_takehome.raw_patients
[0m18:49:56.591403 [debug] [Thread-3 (]: Began executing node seed.data_takehome.raw_pcns
[0m18:49:56.591541 [debug] [Thread-4 (]: Began executing node seed.data_takehome.raw_practices
[0m18:49:56.606239 [debug] [Thread-2 (]: Using duckdb connection "seed.data_takehome.raw_patients"
[0m18:49:56.610421 [debug] [Thread-3 (]: Using duckdb connection "seed.data_takehome.raw_pcns"
[0m18:49:56.610984 [debug] [Thread-4 (]: Using duckdb connection "seed.data_takehome.raw_practices"
[0m18:49:56.616441 [debug] [Thread-2 (]: On seed.data_takehome.raw_patients: BEGIN
[0m18:49:56.635211 [debug] [Thread-3 (]: On seed.data_takehome.raw_pcns: BEGIN
[0m18:49:56.645277 [debug] [Thread-1 (]: Using duckdb connection "seed.data_takehome.raw_activities"
[0m18:49:56.645450 [debug] [Thread-4 (]: On seed.data_takehome.raw_practices: BEGIN
[0m18:49:56.645596 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:49:56.645736 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:49:56.645871 [debug] [Thread-1 (]: On seed.data_takehome.raw_activities: BEGIN
[0m18:49:56.645998 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:49:56.648297 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:49:56.648464 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m18:49:56.648650 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m18:49:56.648781 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m18:49:56.648964 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:49:56.649094 [debug] [Thread-3 (]: Using duckdb connection "seed.data_takehome.raw_pcns"
[0m18:49:56.649227 [debug] [Thread-4 (]: Using duckdb connection "seed.data_takehome.raw_practices"
[0m18:49:56.649359 [debug] [Thread-2 (]: Using duckdb connection "seed.data_takehome.raw_patients"
[0m18:49:56.649492 [debug] [Thread-1 (]: Using duckdb connection "seed.data_takehome.raw_activities"
[0m18:49:56.649631 [debug] [Thread-3 (]: On seed.data_takehome.raw_pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "seed.data_takehome.raw_pcns"} */

    create table "data_takehome"."main"."raw_pcns" ("id" integer,"pcn_name" text)
  
[0m18:49:56.649779 [debug] [Thread-4 (]: On seed.data_takehome.raw_practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "seed.data_takehome.raw_practices"} */

    create table "data_takehome"."main"."raw_practices" ("id" integer,"practice_name" text,"location" text,"established_date" date,"pcn" integer)
  
[0m18:49:56.649921 [debug] [Thread-2 (]: On seed.data_takehome.raw_patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "seed.data_takehome.raw_patients"} */

    create table "data_takehome"."main"."raw_patients" ("data" text)
  
[0m18:49:56.650064 [debug] [Thread-1 (]: On seed.data_takehome.raw_activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "seed.data_takehome.raw_activities"} */

    create table "data_takehome"."main"."raw_activities" ("activity_id" integer,"patient_id" integer,"activity_type" text,"activity_date" timestamp without time zone,"duration_minutes" integer)
  
[0m18:49:56.650485 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m18:49:56.655967 [debug] [Thread-4 (]: Using duckdb connection "seed.data_takehome.raw_practices"
[0m18:49:56.656157 [debug] [Thread-4 (]: On seed.data_takehome.raw_practices: 
          COPY "data_takehome"."main"."raw_practices" FROM '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/seeds/raw_practices.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:49:56.656377 [debug] [Thread-1 (]: SQL status: OK in 0.006 seconds
[0m18:49:56.656960 [debug] [Thread-1 (]: Using duckdb connection "seed.data_takehome.raw_activities"
[0m18:49:56.657114 [debug] [Thread-1 (]: On seed.data_takehome.raw_activities: 
          COPY "data_takehome"."main"."raw_activities" FROM '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/seeds/raw_activities.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:49:56.657320 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m18:49:56.657511 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m18:49:56.658070 [debug] [Thread-3 (]: Using duckdb connection "seed.data_takehome.raw_pcns"
[0m18:49:56.658679 [debug] [Thread-2 (]: Using duckdb connection "seed.data_takehome.raw_patients"
[0m18:49:56.658849 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m18:49:56.659012 [debug] [Thread-3 (]: On seed.data_takehome.raw_pcns: 
          COPY "data_takehome"."main"."raw_pcns" FROM '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/seeds/raw_pcns.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:49:56.659167 [debug] [Thread-2 (]: On seed.data_takehome.raw_patients: 
          COPY "data_takehome"."main"."raw_patients" FROM '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/seeds/raw_patients.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m18:49:56.661928 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.data_takehome.raw_practices"
[0m18:49:56.671339 [debug] [Thread-4 (]: On seed.data_takehome.raw_practices: COMMIT
[0m18:49:56.671590 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m18:49:56.671768 [debug] [Thread-4 (]: Using duckdb connection "seed.data_takehome.raw_practices"
[0m18:49:56.671926 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m18:49:56.672217 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.data_takehome.raw_pcns"
[0m18:49:56.672375 [debug] [Thread-4 (]: On seed.data_takehome.raw_practices: COMMIT
[0m18:49:56.672626 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.data_takehome.raw_patients"
[0m18:49:56.673682 [debug] [Thread-3 (]: On seed.data_takehome.raw_pcns: COMMIT
[0m18:49:56.673856 [debug] [Thread-3 (]: Using duckdb connection "seed.data_takehome.raw_pcns"
[0m18:49:56.674005 [debug] [Thread-3 (]: On seed.data_takehome.raw_pcns: COMMIT
[0m18:49:56.674184 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:49:56.675048 [debug] [Thread-4 (]: On seed.data_takehome.raw_practices: Close
[0m18:49:56.675776 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e786b6cd-4ce4-4601-aa2f-95cbc38c0e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092128a0>]}
[0m18:49:56.676010 [info ] [Thread-4 (]: 4 of 4 OK loaded seed file main.raw_practices .................................. [[32mINSERT 5[0m in 0.08s]
[0m18:49:56.676304 [debug] [Thread-4 (]: Finished running node seed.data_takehome.raw_practices
[0m18:49:56.677146 [debug] [Thread-2 (]: On seed.data_takehome.raw_patients: COMMIT
[0m18:49:56.677310 [debug] [Thread-2 (]: Using duckdb connection "seed.data_takehome.raw_patients"
[0m18:49:56.677455 [debug] [Thread-2 (]: On seed.data_takehome.raw_patients: COMMIT
[0m18:49:56.677607 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m18:49:56.677936 [debug] [Thread-3 (]: On seed.data_takehome.raw_pcns: Close
[0m18:49:56.678141 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e786b6cd-4ce4-4601-aa2f-95cbc38c0e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109155f40>]}
[0m18:49:56.678298 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:49:56.678489 [info ] [Thread-3 (]: 3 of 4 OK loaded seed file main.raw_pcns ....................................... [[32mINSERT 2[0m in 0.09s]
[0m18:49:56.678809 [debug] [Thread-2 (]: On seed.data_takehome.raw_patients: Close
[0m18:49:56.679034 [debug] [Thread-3 (]: Finished running node seed.data_takehome.raw_pcns
[0m18:49:56.679258 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e786b6cd-4ce4-4601-aa2f-95cbc38c0e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109212ba0>]}
[0m18:49:56.679522 [info ] [Thread-2 (]: 2 of 4 OK loaded seed file main.raw_patients ................................... [[32mINSERT 255[0m in 0.09s]
[0m18:49:56.679744 [debug] [Thread-2 (]: Finished running node seed.data_takehome.raw_patients
[0m18:49:56.730666 [debug] [Thread-1 (]: SQL status: OK in 0.073 seconds
[0m18:49:56.731019 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.data_takehome.raw_activities"
[0m18:49:56.731963 [debug] [Thread-1 (]: On seed.data_takehome.raw_activities: COMMIT
[0m18:49:56.732119 [debug] [Thread-1 (]: Using duckdb connection "seed.data_takehome.raw_activities"
[0m18:49:56.732257 [debug] [Thread-1 (]: On seed.data_takehome.raw_activities: COMMIT
[0m18:49:56.732781 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:49:56.733074 [debug] [Thread-1 (]: On seed.data_takehome.raw_activities: Close
[0m18:49:56.737614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e786b6cd-4ce4-4601-aa2f-95cbc38c0e05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dc0980>]}
[0m18:49:56.737888 [info ] [Thread-1 (]: 1 of 4 OK loaded seed file main.raw_activities ................................. [[32mINSERT 2007[0m in 0.15s]
[0m18:49:56.738152 [debug] [Thread-1 (]: Finished running node seed.data_takehome.raw_activities
[0m18:49:56.739050 [debug] [MainThread]: Using duckdb connection "master"
[0m18:49:56.739217 [debug] [MainThread]: On master: BEGIN
[0m18:49:56.739344 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:49:56.741644 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m18:49:56.741802 [debug] [MainThread]: On master: COMMIT
[0m18:49:56.741932 [debug] [MainThread]: Using duckdb connection "master"
[0m18:49:56.742051 [debug] [MainThread]: On master: COMMIT
[0m18:49:56.742188 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m18:49:56.742310 [debug] [MainThread]: On master: Close
[0m18:49:56.742733 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:49:56.742865 [debug] [MainThread]: Connection 'seed.data_takehome.raw_activities' was properly closed.
[0m18:49:56.742975 [debug] [MainThread]: Connection 'seed.data_takehome.raw_patients' was properly closed.
[0m18:49:56.743076 [debug] [MainThread]: Connection 'seed.data_takehome.raw_pcns' was properly closed.
[0m18:49:56.743172 [debug] [MainThread]: Connection 'seed.data_takehome.raw_practices' was properly closed.
[0m18:49:56.743308 [info ] [MainThread]: 
[0m18:49:56.743445 [info ] [MainThread]: Finished running 4 seeds in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m18:49:56.743910 [debug] [MainThread]: Command end result
[0m18:49:56.755877 [info ] [MainThread]: 
[0m18:49:56.756097 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:49:56.756244 [info ] [MainThread]: 
[0m18:49:56.756395 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m18:49:56.758263 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.4475462, "process_user_time": 1.363877, "process_kernel_time": 0.188359, "process_mem_max_rss": "139476992", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:49:56.758540 [debug] [MainThread]: Command `dbt seed` succeeded at 18:49:56.758498 after 1.45 seconds
[0m18:49:56.758711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088f98b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10895e900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bad7f0>]}
[0m18:49:56.758864 [debug] [MainThread]: Flushing usage events
[0m18:54:39.048619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105320350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d818b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d814f0>]}


============================== 18:54:39.052421 | 706efd29-b0d5-487c-bcdd-206c395a7769 ==============================
[0m18:54:39.052421 [info ] [MainThread]: Running with dbt=1.8.1
[0m18:54:39.052749 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:54:39.217642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '706efd29-b0d5-487c-bcdd-206c395a7769', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ddeba0>]}
[0m18:54:39.262150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '706efd29-b0d5-487c-bcdd-206c395a7769', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f11d00>]}
[0m18:54:39.262905 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m18:54:39.319398 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m18:54:39.367381 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:54:39.367618 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:54:39.370409 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.data_takehome.staging
- models.data_takehome
[0m18:54:39.378154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '706efd29-b0d5-487c-bcdd-206c395a7769', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ddca10>]}
[0m18:54:39.413228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '706efd29-b0d5-487c-bcdd-206c395a7769', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c4e90>]}
[0m18:54:39.413500 [info ] [MainThread]: Found 4 seeds, 421 macros
[0m18:54:39.413655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '706efd29-b0d5-487c-bcdd-206c395a7769', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060bf8f0>]}
[0m18:54:39.414356 [info ] [MainThread]: 
[0m18:54:39.414537 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:54:39.415451 [debug] [MainThread]: Command end result
[0m18:54:39.428536 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.41474703, "process_user_time": 0.801111, "process_kernel_time": 0.171584, "process_mem_max_rss": "114229248", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m18:54:39.428824 [debug] [MainThread]: Command `dbt run` succeeded at 18:54:39.428778 after 0.42 seconds
[0m18:54:39.429008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d816d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057c78c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057c6ea0>]}
[0m18:54:39.429164 [debug] [MainThread]: Flushing usage events
[0m01:02:52.357065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10812cce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108415850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108415490>]}


============================== 01:02:52.361288 | 0864b2a2-e3b4-45ae-a0d5-53d7414da624 ==============================
[0m01:02:52.361288 [info ] [MainThread]: Running with dbt=1.8.1
[0m01:02:52.361605 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'debug': 'False', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:02:52.891484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0864b2a2-e3b4-45ae-a0d5-53d7414da624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085661e0>]}
[0m01:02:52.935752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0864b2a2-e3b4-45ae-a0d5-53d7414da624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e5bfe0>]}
[0m01:02:52.936503 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m01:02:52.998797 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m01:02:53.044736 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m01:02:53.045021 [debug] [MainThread]: Partial parsing: added file: data_takehome://models/staging/raw_activities.sql
[0m01:02:53.146862 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two resources with the database representation ""data_takehome"."main"."raw_activities"".
  dbt cannot create two resources with identical database representations. To fix this,
  change the configuration of one of these resources:
  - seed.data_takehome.raw_activities (seeds/raw_activities.csv)
  - model.data_takehome.raw_activities (models/staging/raw_activities.sql)
[0m01:02:53.153316 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.834601, "process_user_time": 0.896778, "process_kernel_time": 0.213904, "process_mem_max_rss": "116604928", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:02:53.153645 [debug] [MainThread]: Command `dbt run` failed at 01:02:53.153590 after 0.84 seconds
[0m01:02:53.153876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10797b620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c2e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108912db0>]}
[0m01:02:53.154064 [debug] [MainThread]: Flushing usage events
[0m01:15:24.928563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d74c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106065970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060655b0>]}


============================== 01:15:24.931615 | d265fee7-e09a-4906-b7ab-3bb3d4a03e2d ==============================
[0m01:15:24.931615 [info ] [MainThread]: Running with dbt=1.8.1
[0m01:15:24.931971 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'version_check': 'True', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:15:25.091025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd265fee7-e09a-4906-b7ab-3bb3d4a03e2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061b9880>]}
[0m01:15:25.134181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd265fee7-e09a-4906-b7ab-3bb3d4a03e2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060ccbf0>]}
[0m01:15:25.134985 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m01:15:25.189375 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m01:15:25.243073 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m01:15:25.243368 [debug] [MainThread]: Partial parsing: added file: data_takehome://models/staging/raw_patients.sql
[0m01:15:25.336498 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two resources with the database representation ""data_takehome"."main"."raw_activities"".
  dbt cannot create two resources with identical database representations. To fix this,
  change the configuration of one of these resources:
  - seed.data_takehome.raw_activities (seeds/raw_activities.csv)
  - model.data_takehome.raw_activities (models/staging/raw_activities.sql)
[0m01:15:25.338689 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.44572037, "process_user_time": 0.835569, "process_kernel_time": 0.17149, "process_mem_max_rss": "117620736", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:15:25.338989 [debug] [MainThread]: Command `dbt run` failed at 01:15:25.338935 after 0.45 seconds
[0m01:15:25.339209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105daa060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055cf8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061b8980>]}
[0m01:15:25.339386 [debug] [MainThread]: Flushing usage events
[0m01:25:23.936508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046b3440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10499d820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10499d430>]}


============================== 01:25:23.939393 | 351b3510-577d-43dc-ba92-b3e6728ebe21 ==============================
[0m01:25:23.939393 [info ] [MainThread]: Running with dbt=1.8.1
[0m01:25:23.939740 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:25:24.081425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '351b3510-577d-43dc-ba92-b3e6728ebe21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10499fdd0>]}
[0m01:25:24.123997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '351b3510-577d-43dc-ba92-b3e6728ebe21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043bd4c0>]}
[0m01:25:24.124823 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m01:25:24.178904 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m01:25:24.232041 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:25:24.232365 [debug] [MainThread]: Partial parsing: updated file: data_takehome://models/staging/raw_patients.sql
[0m01:25:24.324443 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two resources with the database representation ""data_takehome"."main"."raw_activities"".
  dbt cannot create two resources with identical database representations. To fix this,
  change the configuration of one of these resources:
  - seed.data_takehome.raw_activities (seeds/raw_activities.csv)
  - model.data_takehome.raw_activities (models/staging/raw_activities.sql)
[0m01:25:24.326823 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.4230873, "process_user_time": 0.846422, "process_kernel_time": 0.146238, "process_mem_max_rss": "116932608", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:25:24.327123 [debug] [MainThread]: Command `dbt run` failed at 01:25:24.327070 after 0.42 seconds
[0m01:25:24.327333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10499d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b80320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a04fb0>]}
[0m01:25:24.327508 [debug] [MainThread]: Flushing usage events
[0m01:26:38.556743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106602e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ae58b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ae5490>]}


============================== 01:26:38.559579 | 86b7bce0-b2cf-49cf-9211-7be72c3ad030 ==============================
[0m01:26:38.559579 [info ] [MainThread]: Running with dbt=1.8.1
[0m01:26:38.559922 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:26:38.715159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86b7bce0-b2cf-49cf-9211-7be72c3ad030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bbcd40>]}
[0m01:26:38.758050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86b7bce0-b2cf-49cf-9211-7be72c3ad030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c71d00>]}
[0m01:26:38.759329 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m01:26:38.814005 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m01:26:38.866836 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 0 files changed.
[0m01:26:38.867162 [debug] [MainThread]: Partial parsing: added file: data_takehome://models/staging/activities.sql
[0m01:26:38.867349 [debug] [MainThread]: Partial parsing: added file: data_takehome://models/staging/patients.sql
[0m01:26:38.867492 [debug] [MainThread]: Partial parsing: deleted file: data_takehome://models/staging/raw_activities.sql
[0m01:26:38.867617 [debug] [MainThread]: Partial parsing: deleted file: data_takehome://models/staging/raw_patients.sql
[0m01:26:38.963743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86b7bce0-b2cf-49cf-9211-7be72c3ad030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10613dfa0>]}
[0m01:26:39.003973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86b7bce0-b2cf-49cf-9211-7be72c3ad030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fc44a0>]}
[0m01:26:39.004239 [info ] [MainThread]: Found 4 seeds, 2 models, 421 macros
[0m01:26:39.004397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86b7bce0-b2cf-49cf-9211-7be72c3ad030', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ab8080>]}
[0m01:26:39.005130 [info ] [MainThread]: 
[0m01:26:39.005399 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:26:39.007483 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_data_takehome'
[0m01:26:39.043723 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome"
[0m01:26:39.043953 [debug] [ThreadPool]: On list_data_takehome: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m01:26:39.044103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:26:39.052166 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m01:26:39.052395 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m01:26:39.052818 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:26:39.052980 [debug] [MainThread]: Connection 'list_data_takehome' was properly closed.
[0m01:26:39.053131 [info ] [MainThread]: 
[0m01:26:39.053290 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.05 seconds (0.05s).
[0m01:26:39.053518 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/qamr/Documents/Development/suvera/data-dbt-takehome/data_takehome.duckdb": Conflicting lock is held in /opt/homebrew/Cellar/duckdb/1.1.1/bin/duckdb (PID 6272) by user qamr. See also https://duckdb.org/docs/connect/concurrency
[0m01:26:39.055443 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5312157, "process_user_time": 0.889489, "process_kernel_time": 0.177289, "process_mem_max_rss": "123240448", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:26:39.055701 [debug] [MainThread]: Command `dbt run` failed at 01:26:39.055654 after 0.53 seconds
[0m01:26:39.055875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ae58b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f56bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ddf680>]}
[0m01:26:39.056033 [debug] [MainThread]: Flushing usage events
[0m01:26:56.635484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c44860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e81940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e81550>]}


============================== 01:26:56.638262 | f567f6db-a93e-4b40-8554-1aee381c9d84 ==============================
[0m01:26:56.638262 [info ] [MainThread]: Running with dbt=1.8.1
[0m01:26:56.638574 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:26:56.746924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f567f6db-a93e-4b40-8554-1aee381c9d84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ee89e0>]}
[0m01:26:56.789673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f567f6db-a93e-4b40-8554-1aee381c9d84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106edda30>]}
[0m01:26:56.791073 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m01:26:56.846232 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m01:26:56.898557 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:26:56.898778 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:26:56.913989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f567f6db-a93e-4b40-8554-1aee381c9d84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067082f0>]}
[0m01:26:56.953576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f567f6db-a93e-4b40-8554-1aee381c9d84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071d1ca0>]}
[0m01:26:56.953869 [info ] [MainThread]: Found 4 seeds, 2 models, 421 macros
[0m01:26:56.954042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f567f6db-a93e-4b40-8554-1aee381c9d84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074a3110>]}
[0m01:26:56.954807 [info ] [MainThread]: 
[0m01:26:56.955091 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:26:56.957228 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_data_takehome'
[0m01:26:56.989868 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome"
[0m01:26:56.990121 [debug] [ThreadPool]: On list_data_takehome: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m01:26:56.990269 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:26:57.005501 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m01:26:57.006762 [debug] [ThreadPool]: On list_data_takehome: Close
[0m01:26:57.007576 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data_takehome, now create_data_takehome_main)
[0m01:26:57.007799 [debug] [ThreadPool]: Creating schema "database: "data_takehome"
schema: "main"
"
[0m01:26:57.011071 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m01:26:57.011229 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
        select type from duckdb_databases()
        where database_name='data_takehome'
        and type='sqlite'
    
  
[0m01:26:57.011356 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:26:57.014205 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m01:26:57.014869 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m01:26:57.015005 [debug] [ThreadPool]: On create_data_takehome_main: BEGIN
[0m01:26:57.015148 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:26:57.015267 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m01:26:57.015387 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
    
        create schema if not exists "data_takehome"."main"
    
[0m01:26:57.015954 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:26:57.016342 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m01:26:57.016461 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m01:26:57.016570 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m01:26:57.016706 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:26:57.016828 [debug] [ThreadPool]: On create_data_takehome_main: Close
[0m01:26:57.017788 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_data_takehome_main, now list_data_takehome_main)
[0m01:26:57.020362 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m01:26:57.020510 [debug] [ThreadPool]: On list_data_takehome_main: BEGIN
[0m01:26:57.020621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:26:57.022757 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m01:26:57.022907 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m01:26:57.023049 [debug] [ThreadPool]: On list_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome_main"} */
select
      'data_takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'data_takehome'
  
[0m01:26:57.035484 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m01:26:57.038315 [debug] [ThreadPool]: On list_data_takehome_main: ROLLBACK
[0m01:26:57.039447 [debug] [ThreadPool]: Failed to rollback 'list_data_takehome_main'
[0m01:26:57.039592 [debug] [ThreadPool]: On list_data_takehome_main: Close
[0m01:26:57.040647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f567f6db-a93e-4b40-8554-1aee381c9d84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074a0470>]}
[0m01:26:57.040880 [debug] [MainThread]: Using duckdb connection "master"
[0m01:26:57.041009 [debug] [MainThread]: On master: BEGIN
[0m01:26:57.041121 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:26:57.043333 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m01:26:57.043508 [debug] [MainThread]: On master: COMMIT
[0m01:26:57.043637 [debug] [MainThread]: Using duckdb connection "master"
[0m01:26:57.043751 [debug] [MainThread]: On master: COMMIT
[0m01:26:57.043883 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:26:57.044016 [debug] [MainThread]: On master: Close
[0m01:26:57.044488 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m01:26:57.044695 [info ] [MainThread]: 
[0m01:26:57.046843 [debug] [Thread-1 (]: Began running node model.data_takehome.activities
[0m01:26:57.047035 [debug] [Thread-2 (]: Began running node model.data_takehome.patients
[0m01:26:57.047289 [info ] [Thread-1 (]: 1 of 2 START sql view model main.activities .................................... [RUN]
[0m01:26:57.047719 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_takehome_main, now model.data_takehome.activities)
[0m01:26:57.047486 [info ] [Thread-2 (]: 2 of 2 START sql view model main.patients ...................................... [RUN]
[0m01:26:57.047918 [debug] [Thread-1 (]: Began compiling node model.data_takehome.activities
[0m01:26:57.048126 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.data_takehome.patients'
[0m01:26:57.051488 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_takehome.activities"
[0m01:26:57.051673 [debug] [Thread-2 (]: Began compiling node model.data_takehome.patients
[0m01:26:57.052530 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_takehome.patients"
[0m01:26:57.053116 [debug] [Thread-2 (]: Began executing node model.data_takehome.patients
[0m01:26:57.053279 [debug] [Thread-1 (]: Began executing node model.data_takehome.activities
[0m01:26:57.070957 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_takehome.activities"
[0m01:26:57.071802 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_takehome.patients"
[0m01:26:57.072300 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients"
[0m01:26:57.072452 [debug] [Thread-2 (]: On model.data_takehome.patients: BEGIN
[0m01:26:57.072589 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:26:57.075028 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m01:26:57.075222 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities"
[0m01:26:57.075370 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients"
[0m01:26:57.075516 [debug] [Thread-1 (]: On model.data_takehome.activities: BEGIN
[0m01:26:57.075679 [debug] [Thread-2 (]: On model.data_takehome.patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients"} */

  
  create view "data_takehome"."main"."patients__dbt_tmp" as (
    WITH patients AS (
  SELECT 
    json_extract_string(data, '$.patient_id') AS patient_id,
    json_extract_string(data, '$.practice_id') AS practice_id,
    json_extract_string(data, '$.age') AS age,
    json_extract_string(data, '$.gender') AS gender,
    json_extract_string(data, '$.registration_date') AS registration_date,
    json_extract_string(data, '$.conditions') AS conditions,
    json_extract_string(data, '$.contact.email') AS email,
    json_extract_string(data, '$.contact.phone') AS phone
  FROM raw_patients
  --WHERE data IS NOT NULL
)

-- Create the final normalized table
SELECT 
  patient_id,
  practice_id,
  age,
  gender,
  registration_date,
  conditions,
  email,
  phone
FROM patients
--WHERE patient_id IS NOT NULL;
  );

[0m01:26:57.075840 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:26:57.076055 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:26:57.076194 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities"
[0m01:26:57.076333 [debug] [Thread-1 (]: On model.data_takehome.activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities"} */

  
  create view "data_takehome"."main"."activities__dbt_tmp" as (
    with activities as (
select * from ref  )

select * from activities
  );

[0m01:26:57.076738 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m01:26:57.079872 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients"
[0m01:26:57.080054 [debug] [Thread-2 (]: On model.data_takehome.patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients"} */
alter view "data_takehome"."main"."patients__dbt_tmp" rename to "patients"
[0m01:26:57.080504 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m01:26:57.087774 [debug] [Thread-2 (]: On model.data_takehome.patients: COMMIT
[0m01:26:57.087976 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients"
[0m01:26:57.088229 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities"} */

  
  create view "data_takehome"."main"."activities__dbt_tmp" as (
    with activities as (
select * from ref  )

select * from activities
  );

[0m01:26:57.088398 [debug] [Thread-2 (]: On model.data_takehome.patients: COMMIT
[0m01:26:57.088551 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:26:57.088813 [debug] [Thread-1 (]: On model.data_takehome.activities: ROLLBACK
[0m01:26:57.089712 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m01:26:57.091996 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients"
[0m01:26:57.092166 [debug] [Thread-2 (]: On model.data_takehome.patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients"} */
drop view if exists "data_takehome"."main"."patients__dbt_backup" cascade
[0m01:26:57.092380 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m01:26:57.093523 [debug] [Thread-2 (]: On model.data_takehome.patients: Close
[0m01:26:57.094172 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f567f6db-a93e-4b40-8554-1aee381c9d84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105493a70>]}
[0m01:26:57.094487 [info ] [Thread-2 (]: 2 of 2 OK created sql view model main.patients ................................. [[32mOK[0m in 0.05s]
[0m01:26:57.094762 [debug] [Thread-2 (]: Finished running node model.data_takehome.patients
[0m01:26:57.097873 [debug] [Thread-1 (]: Failed to rollback 'model.data_takehome.activities'
[0m01:26:57.098051 [debug] [Thread-1 (]: On model.data_takehome.activities: Close
[0m01:26:57.101833 [debug] [Thread-1 (]: Runtime Error in model activities (models/staging/activities.sql)
  Catalog Error: Table with name ref does not exist!
  Did you mean "pg_attrdef"?
  LINE 6: select * from ref  )
                        ^
[0m01:26:57.102051 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f567f6db-a93e-4b40-8554-1aee381c9d84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078e44d0>]}
[0m01:26:57.102317 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model main.activities ........................... [[31mERROR[0m in 0.05s]
[0m01:26:57.102578 [debug] [Thread-1 (]: Finished running node model.data_takehome.activities
[0m01:26:57.103437 [debug] [MainThread]: Using duckdb connection "master"
[0m01:26:57.103581 [debug] [MainThread]: On master: BEGIN
[0m01:26:57.103697 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:26:57.106032 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m01:26:57.106189 [debug] [MainThread]: On master: COMMIT
[0m01:26:57.106310 [debug] [MainThread]: Using duckdb connection "master"
[0m01:26:57.106421 [debug] [MainThread]: On master: COMMIT
[0m01:26:57.106554 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:26:57.106676 [debug] [MainThread]: On master: Close
[0m01:26:57.107120 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:26:57.107261 [debug] [MainThread]: Connection 'model.data_takehome.activities' was properly closed.
[0m01:26:57.107372 [debug] [MainThread]: Connection 'model.data_takehome.patients' was properly closed.
[0m01:26:57.107532 [info ] [MainThread]: 
[0m01:26:57.107676 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m01:26:57.108024 [debug] [MainThread]: Command end result
[0m01:26:57.121137 [info ] [MainThread]: 
[0m01:26:57.121397 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:26:57.121543 [info ] [MainThread]: 
[0m01:26:57.121717 [error] [MainThread]:   Runtime Error in model activities (models/staging/activities.sql)
  Catalog Error: Table with name ref does not exist!
  Did you mean "pg_attrdef"?
  LINE 6: select * from ref  )
                        ^
[0m01:26:57.121854 [info ] [MainThread]: 
[0m01:26:57.122001 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m01:26:57.124013 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.51948756, "process_user_time": 0.934819, "process_kernel_time": 0.164057, "process_mem_max_rss": "129449984", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:26:57.124263 [debug] [MainThread]: Command `dbt run` failed at 01:26:57.124222 after 0.52 seconds
[0m01:26:57.124446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106adf680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105be1df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e13a70>]}
[0m01:26:57.124598 [debug] [MainThread]: Flushing usage events
[0m01:27:28.937417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e04290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104861970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104861610>]}


============================== 01:27:28.940096 | 8b23f47c-09ab-482e-b714-4c07fe242a36 ==============================
[0m01:27:28.940096 [info ] [MainThread]: Running with dbt=1.8.1
[0m01:27:28.940403 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'version_check': 'True', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:27:29.094235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b23f47c-09ab-482e-b714-4c07fe242a36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048c3bf0>]}
[0m01:27:29.137287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b23f47c-09ab-482e-b714-4c07fe242a36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e7f020>]}
[0m01:27:29.138109 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m01:27:29.196060 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m01:27:29.249023 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:27:29.249365 [debug] [MainThread]: Partial parsing: updated file: data_takehome://models/staging/patients.sql
[0m01:27:29.344101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b23f47c-09ab-482e-b714-4c07fe242a36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e09760>]}
[0m01:27:29.382861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b23f47c-09ab-482e-b714-4c07fe242a36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e096d0>]}
[0m01:27:29.383148 [info ] [MainThread]: Found 4 seeds, 2 models, 421 macros
[0m01:27:29.383317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b23f47c-09ab-482e-b714-4c07fe242a36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049f0c50>]}
[0m01:27:29.384064 [info ] [MainThread]: 
[0m01:27:29.384347 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:27:29.386483 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_data_takehome'
[0m01:27:29.417801 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome"
[0m01:27:29.418033 [debug] [ThreadPool]: On list_data_takehome: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m01:27:29.418175 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:27:29.433961 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m01:27:29.435253 [debug] [ThreadPool]: On list_data_takehome: Close
[0m01:27:29.436259 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data_takehome, now create_data_takehome_main)
[0m01:27:29.436482 [debug] [ThreadPool]: Creating schema "database: "data_takehome"
schema: "main"
"
[0m01:27:29.439698 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m01:27:29.439858 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
        select type from duckdb_databases()
        where database_name='data_takehome'
        and type='sqlite'
    
  
[0m01:27:29.439984 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:27:29.442697 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m01:27:29.443346 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m01:27:29.443484 [debug] [ThreadPool]: On create_data_takehome_main: BEGIN
[0m01:27:29.443627 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:27:29.443744 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m01:27:29.443864 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
    
        create schema if not exists "data_takehome"."main"
    
[0m01:27:29.444122 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:27:29.444505 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m01:27:29.444625 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m01:27:29.444735 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m01:27:29.444868 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:27:29.444991 [debug] [ThreadPool]: On create_data_takehome_main: Close
[0m01:27:29.445945 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_data_takehome_main, now list_data_takehome_main)
[0m01:27:29.449213 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m01:27:29.449367 [debug] [ThreadPool]: On list_data_takehome_main: BEGIN
[0m01:27:29.449485 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:27:29.452195 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m01:27:29.452370 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m01:27:29.452517 [debug] [ThreadPool]: On list_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome_main"} */
select
      'data_takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'data_takehome'
  
[0m01:27:29.465300 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m01:27:29.468057 [debug] [ThreadPool]: On list_data_takehome_main: ROLLBACK
[0m01:27:29.469008 [debug] [ThreadPool]: Failed to rollback 'list_data_takehome_main'
[0m01:27:29.469156 [debug] [ThreadPool]: On list_data_takehome_main: Close
[0m01:27:29.470239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b23f47c-09ab-482e-b714-4c07fe242a36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10334ed20>]}
[0m01:27:29.470475 [debug] [MainThread]: Using duckdb connection "master"
[0m01:27:29.470616 [debug] [MainThread]: On master: BEGIN
[0m01:27:29.470735 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:27:29.472900 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m01:27:29.473061 [debug] [MainThread]: On master: COMMIT
[0m01:27:29.473190 [debug] [MainThread]: Using duckdb connection "master"
[0m01:27:29.473307 [debug] [MainThread]: On master: COMMIT
[0m01:27:29.473444 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:27:29.473571 [debug] [MainThread]: On master: Close
[0m01:27:29.474034 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m01:27:29.474232 [info ] [MainThread]: 
[0m01:27:29.476085 [debug] [Thread-1 (]: Began running node model.data_takehome.activities
[0m01:27:29.476273 [debug] [Thread-2 (]: Began running node model.data_takehome.patients
[0m01:27:29.476514 [info ] [Thread-1 (]: 1 of 2 START sql view model main.activities .................................... [RUN]
[0m01:27:29.476763 [info ] [Thread-2 (]: 2 of 2 START sql view model main.patients ...................................... [RUN]
[0m01:27:29.476999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_takehome_main, now model.data_takehome.activities)
[0m01:27:29.477237 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.data_takehome.patients'
[0m01:27:29.477404 [debug] [Thread-1 (]: Began compiling node model.data_takehome.activities
[0m01:27:29.477557 [debug] [Thread-2 (]: Began compiling node model.data_takehome.patients
[0m01:27:29.480787 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_takehome.activities"
[0m01:27:29.481907 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_takehome.patients"
[0m01:27:29.482348 [debug] [Thread-2 (]: Began executing node model.data_takehome.patients
[0m01:27:29.482500 [debug] [Thread-1 (]: Began executing node model.data_takehome.activities
[0m01:27:29.497415 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_takehome.patients"
[0m01:27:29.499044 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_takehome.activities"
[0m01:27:29.499971 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients"
[0m01:27:29.500140 [debug] [Thread-2 (]: On model.data_takehome.patients: BEGIN
[0m01:27:29.500304 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities"
[0m01:27:29.500434 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:27:29.500571 [debug] [Thread-1 (]: On model.data_takehome.activities: BEGIN
[0m01:27:29.503110 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m01:27:29.503343 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:27:29.503499 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients"
[0m01:27:29.503722 [debug] [Thread-2 (]: On model.data_takehome.patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients"} */

  
  create view "data_takehome"."main"."patients__dbt_tmp" as (
    WITH patients AS (
  SELECT 
    json_extract_string(data, '$.patient_id') AS patient_id,
    json_extract_string(data, '$.practice_id') AS practice_id,
    json_extract_string(data, '$.age') AS age,
    json_extract_string(data, '$.gender') AS gender,
    json_extract_string(data, '$.registration_date') AS registration_date,
    json_extract_string(data, '$.conditions') AS conditions,
    json_extract_string(data, '$.contact.email') AS email,
    json_extract_string(data, '$.contact.phone') AS phone
  FROM {ref }
  --WHERE data IS NOT NULL
)

-- Create the final normalized table
SELECT 
  patient_id,
  practice_id,
  age,
  gender,
  registration_date,
  conditions,
  email,
  phone
FROM patients
--WHERE patient_id IS NOT NULL;
  );

[0m01:27:29.503930 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:27:29.504107 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities"
[0m01:27:29.504261 [debug] [Thread-1 (]: On model.data_takehome.activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities"} */

  
  create view "data_takehome"."main"."activities__dbt_tmp" as (
    with activities as (
select * from ref  )

select * from activities
  );

[0m01:27:29.506364 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients"} */

  
  create view "data_takehome"."main"."patients__dbt_tmp" as (
    WITH patients AS (
  SELECT 
    json_extract_string(data, '$.patient_id') AS patient_id,
    json_extract_string(data, '$.practice_id') AS practice_id,
    json_extract_string(data, '$.age') AS age,
    json_extract_string(data, '$.gender') AS gender,
    json_extract_string(data, '$.registration_date') AS registration_date,
    json_extract_string(data, '$.conditions') AS conditions,
    json_extract_string(data, '$.contact.email') AS email,
    json_extract_string(data, '$.contact.phone') AS phone
  FROM {ref }
  --WHERE data IS NOT NULL
)

-- Create the final normalized table
SELECT 
  patient_id,
  practice_id,
  age,
  gender,
  registration_date,
  conditions,
  email,
  phone
FROM patients
--WHERE patient_id IS NOT NULL;
  );

[0m01:27:29.506590 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m01:27:29.506814 [debug] [Thread-2 (]: On model.data_takehome.patients: ROLLBACK
[0m01:27:29.511118 [debug] [Thread-2 (]: Failed to rollback 'model.data_takehome.patients'
[0m01:27:29.511315 [debug] [Thread-2 (]: On model.data_takehome.patients: Close
[0m01:27:29.512489 [debug] [Thread-2 (]: Runtime Error in model patients (models/staging/patients.sql)
  Parser Error: syntax error at or near "{"
[0m01:27:29.513203 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b23f47c-09ab-482e-b714-4c07fe242a36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e04aa0>]}
[0m01:27:29.513503 [error] [Thread-2 (]: 2 of 2 ERROR creating sql view model main.patients ............................. [[31mERROR[0m in 0.04s]
[0m01:27:29.513820 [debug] [Thread-2 (]: Finished running node model.data_takehome.patients
[0m01:27:29.516361 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities"} */

  
  create view "data_takehome"."main"."activities__dbt_tmp" as (
    with activities as (
select * from ref  )

select * from activities
  );

[0m01:27:29.516743 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:27:29.516958 [debug] [Thread-1 (]: On model.data_takehome.activities: ROLLBACK
[0m01:27:29.518397 [debug] [Thread-1 (]: Failed to rollback 'model.data_takehome.activities'
[0m01:27:29.518566 [debug] [Thread-1 (]: On model.data_takehome.activities: Close
[0m01:27:29.520792 [debug] [Thread-1 (]: Runtime Error in model activities (models/staging/activities.sql)
  Catalog Error: Table with name ref does not exist!
  Did you mean "pg_attrdef"?
  LINE 6: select * from ref  )
                        ^
[0m01:27:29.521022 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b23f47c-09ab-482e-b714-4c07fe242a36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10526df70>]}
[0m01:27:29.521304 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model main.activities ........................... [[31mERROR[0m in 0.04s]
[0m01:27:29.521558 [debug] [Thread-1 (]: Finished running node model.data_takehome.activities
[0m01:27:29.522398 [debug] [MainThread]: Using duckdb connection "master"
[0m01:27:29.522546 [debug] [MainThread]: On master: BEGIN
[0m01:27:29.522664 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:27:29.525030 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m01:27:29.525196 [debug] [MainThread]: On master: COMMIT
[0m01:27:29.525398 [debug] [MainThread]: Using duckdb connection "master"
[0m01:27:29.525546 [debug] [MainThread]: On master: COMMIT
[0m01:27:29.525893 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:27:29.526022 [debug] [MainThread]: On master: Close
[0m01:27:29.526483 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:27:29.526645 [debug] [MainThread]: Connection 'model.data_takehome.activities' was properly closed.
[0m01:27:29.526769 [debug] [MainThread]: Connection 'model.data_takehome.patients' was properly closed.
[0m01:27:29.527007 [info ] [MainThread]: 
[0m01:27:29.527169 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m01:27:29.527584 [debug] [MainThread]: Command end result
[0m01:27:29.541941 [info ] [MainThread]: 
[0m01:27:29.542202 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m01:27:29.542355 [info ] [MainThread]: 
[0m01:27:29.542537 [error] [MainThread]:   Runtime Error in model patients (models/staging/patients.sql)
  Parser Error: syntax error at or near "{"
[0m01:27:29.542671 [info ] [MainThread]: 
[0m01:27:29.542825 [error] [MainThread]:   Runtime Error in model activities (models/staging/activities.sql)
  Catalog Error: Table with name ref does not exist!
  Did you mean "pg_attrdef"?
  LINE 6: select * from ref  )
                        ^
[0m01:27:29.542958 [info ] [MainThread]: 
[0m01:27:29.543106 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m01:27:29.545301 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6400225, "process_user_time": 1.008464, "process_kernel_time": 0.179447, "process_mem_max_rss": "131710976", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:27:29.545617 [debug] [MainThread]: Command `dbt run` failed at 01:27:29.545573 after 0.64 seconds
[0m01:27:29.545817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104861610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042a7bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e04290>]}
[0m01:27:29.545990 [debug] [MainThread]: Flushing usage events
[0m01:28:01.881412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cbc5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e81880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e814c0>]}


============================== 01:28:01.884003 | 846ceb81-eefa-4c67-869f-0d4398695a29 ==============================
[0m01:28:01.884003 [info ] [MainThread]: Running with dbt=1.8.1
[0m01:28:01.884322 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:28:02.035498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '846ceb81-eefa-4c67-869f-0d4398695a29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11111d670>]}
[0m01:28:02.079130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '846ceb81-eefa-4c67-869f-0d4398695a29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111149970>]}
[0m01:28:02.080027 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m01:28:02.135956 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m01:28:02.188022 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:28:02.188359 [debug] [MainThread]: Partial parsing: updated file: data_takehome://models/staging/patients.sql
[0m01:28:02.284301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '846ceb81-eefa-4c67-869f-0d4398695a29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116e9820>]}
[0m01:28:02.324192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '846ceb81-eefa-4c67-869f-0d4398695a29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111231880>]}
[0m01:28:02.324481 [info ] [MainThread]: Found 4 seeds, 2 models, 421 macros
[0m01:28:02.324647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '846ceb81-eefa-4c67-869f-0d4398695a29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116b5e20>]}
[0m01:28:02.325380 [info ] [MainThread]: 
[0m01:28:02.325656 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:28:02.327822 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_data_takehome'
[0m01:28:02.361738 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome"
[0m01:28:02.361996 [debug] [ThreadPool]: On list_data_takehome: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m01:28:02.362146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:28:02.367725 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m01:28:02.368510 [debug] [ThreadPool]: On list_data_takehome: Close
[0m01:28:02.369300 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data_takehome, now create_data_takehome_main)
[0m01:28:02.369547 [debug] [ThreadPool]: Creating schema "database: "data_takehome"
schema: "main"
"
[0m01:28:02.372869 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m01:28:02.373037 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
        select type from duckdb_databases()
        where database_name='data_takehome'
        and type='sqlite'
    
  
[0m01:28:02.373165 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:28:02.375708 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m01:28:02.376360 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m01:28:02.376498 [debug] [ThreadPool]: On create_data_takehome_main: BEGIN
[0m01:28:02.376641 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:28:02.376751 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m01:28:02.376862 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
    
        create schema if not exists "data_takehome"."main"
    
[0m01:28:02.377490 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:28:02.377868 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m01:28:02.377992 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m01:28:02.378101 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m01:28:02.378237 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:28:02.378357 [debug] [ThreadPool]: On create_data_takehome_main: Close
[0m01:28:02.379395 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_data_takehome_main, now list_data_takehome_main)
[0m01:28:02.382967 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m01:28:02.383166 [debug] [ThreadPool]: On list_data_takehome_main: BEGIN
[0m01:28:02.383292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:28:02.385921 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m01:28:02.386113 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m01:28:02.386253 [debug] [ThreadPool]: On list_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome_main"} */
select
      'data_takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'data_takehome'
  
[0m01:28:02.396729 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m01:28:02.399125 [debug] [ThreadPool]: On list_data_takehome_main: ROLLBACK
[0m01:28:02.400527 [debug] [ThreadPool]: Failed to rollback 'list_data_takehome_main'
[0m01:28:02.400668 [debug] [ThreadPool]: On list_data_takehome_main: Close
[0m01:28:02.401789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '846ceb81-eefa-4c67-869f-0d4398695a29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11161a810>]}
[0m01:28:02.402028 [debug] [MainThread]: Using duckdb connection "master"
[0m01:28:02.402171 [debug] [MainThread]: On master: BEGIN
[0m01:28:02.402295 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:28:02.404652 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m01:28:02.404822 [debug] [MainThread]: On master: COMMIT
[0m01:28:02.404954 [debug] [MainThread]: Using duckdb connection "master"
[0m01:28:02.405078 [debug] [MainThread]: On master: COMMIT
[0m01:28:02.405217 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:28:02.405335 [debug] [MainThread]: On master: Close
[0m01:28:02.405790 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m01:28:02.405944 [info ] [MainThread]: 
[0m01:28:02.408024 [debug] [Thread-1 (]: Began running node model.data_takehome.activities
[0m01:28:02.408218 [debug] [Thread-2 (]: Began running node model.data_takehome.patients
[0m01:28:02.408457 [info ] [Thread-1 (]: 1 of 2 START sql view model main.activities .................................... [RUN]
[0m01:28:02.408712 [info ] [Thread-2 (]: 2 of 2 START sql view model main.patients ...................................... [RUN]
[0m01:28:02.408947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_takehome_main, now model.data_takehome.activities)
[0m01:28:02.409177 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.data_takehome.patients'
[0m01:28:02.409344 [debug] [Thread-1 (]: Began compiling node model.data_takehome.activities
[0m01:28:02.409495 [debug] [Thread-2 (]: Began compiling node model.data_takehome.patients
[0m01:28:02.412902 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_takehome.activities"
[0m01:28:02.414147 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_takehome.patients"
[0m01:28:02.414721 [debug] [Thread-2 (]: Began executing node model.data_takehome.patients
[0m01:28:02.414894 [debug] [Thread-1 (]: Began executing node model.data_takehome.activities
[0m01:28:02.431557 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_takehome.activities"
[0m01:28:02.432437 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_takehome.patients"
[0m01:28:02.432936 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients"
[0m01:28:02.433104 [debug] [Thread-2 (]: On model.data_takehome.patients: BEGIN
[0m01:28:02.433252 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:28:02.435647 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities"
[0m01:28:02.435832 [debug] [Thread-1 (]: On model.data_takehome.activities: BEGIN
[0m01:28:02.436004 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m01:28:02.436154 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:28:02.436312 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients"
[0m01:28:02.436548 [debug] [Thread-2 (]: On model.data_takehome.patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients"} */

  
  create view "data_takehome"."main"."patients__dbt_tmp" as (
    WITH patients AS (
  SELECT 
    json_extract_string(data, '$.patient_id') AS patient_id,
    json_extract_string(data, '$.practice_id') AS practice_id,
    json_extract_string(data, '$.age') AS age,
    json_extract_string(data, '$.gender') AS gender,
    json_extract_string(data, '$.registration_date') AS registration_date,
    json_extract_string(data, '$.conditions') AS conditions,
    json_extract_string(data, '$.contact.email') AS email,
    json_extract_string(data, '$.contact.phone') AS phone
  FROM ref 
  --WHERE data IS NOT NULL
)

-- Create the final normalized table
SELECT 
  patient_id,
  practice_id,
  age,
  gender,
  registration_date,
  conditions,
  email,
  phone
FROM patients
--WHERE patient_id IS NOT NULL;
  );

[0m01:28:02.436746 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:28:02.436996 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities"
[0m01:28:02.437202 [debug] [Thread-1 (]: On model.data_takehome.activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities"} */

  
  create view "data_takehome"."main"."activities__dbt_tmp" as (
    with activities as (
select * from ref  )

select * from activities
  );

[0m01:28:02.445447 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients"} */

  
  create view "data_takehome"."main"."patients__dbt_tmp" as (
    WITH patients AS (
  SELECT 
    json_extract_string(data, '$.patient_id') AS patient_id,
    json_extract_string(data, '$.practice_id') AS practice_id,
    json_extract_string(data, '$.age') AS age,
    json_extract_string(data, '$.gender') AS gender,
    json_extract_string(data, '$.registration_date') AS registration_date,
    json_extract_string(data, '$.conditions') AS conditions,
    json_extract_string(data, '$.contact.email') AS email,
    json_extract_string(data, '$.contact.phone') AS phone
  FROM ref 
  --WHERE data IS NOT NULL
)

-- Create the final normalized table
SELECT 
  patient_id,
  practice_id,
  age,
  gender,
  registration_date,
  conditions,
  email,
  phone
FROM patients
--WHERE patient_id IS NOT NULL;
  );

[0m01:28:02.445649 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m01:28:02.445861 [debug] [Thread-2 (]: On model.data_takehome.patients: ROLLBACK
[0m01:28:02.446761 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities"} */

  
  create view "data_takehome"."main"."activities__dbt_tmp" as (
    with activities as (
select * from ref  )

select * from activities
  );

[0m01:28:02.446941 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:28:02.447127 [debug] [Thread-1 (]: On model.data_takehome.activities: ROLLBACK
[0m01:28:02.452013 [debug] [Thread-1 (]: Failed to rollback 'model.data_takehome.activities'
[0m01:28:02.452184 [debug] [Thread-1 (]: On model.data_takehome.activities: Close
[0m01:28:02.452803 [debug] [Thread-2 (]: Failed to rollback 'model.data_takehome.patients'
[0m01:28:02.453569 [debug] [Thread-2 (]: On model.data_takehome.patients: Close
[0m01:28:02.454160 [debug] [Thread-1 (]: Runtime Error in model activities (models/staging/activities.sql)
  Catalog Error: Table with name ref does not exist!
  Did you mean "pg_attrdef"?
  LINE 6: select * from ref  )
                        ^
[0m01:28:02.456109 [debug] [Thread-2 (]: Runtime Error in model patients (models/staging/patients.sql)
  Catalog Error: Table with name ref does not exist!
  Did you mean "pg_attrdef"?
  LINE 15:   FROM ref 
                  ^
[0m01:28:02.456747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '846ceb81-eefa-4c67-869f-0d4398695a29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c47fb0>]}
[0m01:28:02.457127 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '846ceb81-eefa-4c67-869f-0d4398695a29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110320920>]}
[0m01:28:02.457433 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model main.activities ........................... [[31mERROR[0m in 0.05s]
[0m01:28:02.457663 [error] [Thread-2 (]: 2 of 2 ERROR creating sql view model main.patients ............................. [[31mERROR[0m in 0.05s]
[0m01:28:02.458004 [debug] [Thread-1 (]: Finished running node model.data_takehome.activities
[0m01:28:02.458254 [debug] [Thread-2 (]: Finished running node model.data_takehome.patients
[0m01:28:02.459156 [debug] [MainThread]: Using duckdb connection "master"
[0m01:28:02.459301 [debug] [MainThread]: On master: BEGIN
[0m01:28:02.459418 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:28:02.461775 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m01:28:02.461938 [debug] [MainThread]: On master: COMMIT
[0m01:28:02.462114 [debug] [MainThread]: Using duckdb connection "master"
[0m01:28:02.462230 [debug] [MainThread]: On master: COMMIT
[0m01:28:02.462361 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:28:02.462481 [debug] [MainThread]: On master: Close
[0m01:28:02.462944 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:28:02.463110 [debug] [MainThread]: Connection 'model.data_takehome.activities' was properly closed.
[0m01:28:02.463233 [debug] [MainThread]: Connection 'model.data_takehome.patients' was properly closed.
[0m01:28:02.463398 [info ] [MainThread]: 
[0m01:28:02.463553 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.14 seconds (0.14s).
[0m01:28:02.463905 [debug] [MainThread]: Command end result
[0m01:28:02.477688 [info ] [MainThread]: 
[0m01:28:02.477958 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m01:28:02.478111 [info ] [MainThread]: 
[0m01:28:02.478301 [error] [MainThread]:   Runtime Error in model activities (models/staging/activities.sql)
  Catalog Error: Table with name ref does not exist!
  Did you mean "pg_attrdef"?
  LINE 6: select * from ref  )
                        ^
[0m01:28:02.478442 [info ] [MainThread]: 
[0m01:28:02.478594 [error] [MainThread]:   Runtime Error in model patients (models/staging/patients.sql)
  Catalog Error: Table with name ref does not exist!
  Did you mean "pg_attrdef"?
  LINE 15:   FROM ref 
                  ^
[0m01:28:02.478729 [info ] [MainThread]: 
[0m01:28:02.478877 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m01:28:02.480735 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.63048506, "process_user_time": 1.014465, "process_kernel_time": 0.173887, "process_mem_max_rss": "132907008", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:28:02.481171 [debug] [MainThread]: Command `dbt run` failed at 01:28:02.481115 after 0.63 seconds
[0m01:28:02.481387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e81880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f4cfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107c7b60>]}
[0m01:28:02.481594 [debug] [MainThread]: Flushing usage events
[0m01:30:50.548894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c8ac90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086958e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086954f0>]}


============================== 01:30:50.551149 | 7a632f3d-36b5-4972-aad0-9d0c603b8a9d ==============================
[0m01:30:50.551149 [info ] [MainThread]: Running with dbt=1.8.1
[0m01:30:50.551459 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m01:30:50.639899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7a632f3d-36b5-4972-aad0-9d0c603b8a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108367cb0>]}
[0m01:30:50.682448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7a632f3d-36b5-4972-aad0-9d0c603b8a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10896a870>]}
[0m01:30:50.683025 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m01:30:50.732288 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m01:30:50.773406 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:30:50.773623 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:30:50.788884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7a632f3d-36b5-4972-aad0-9d0c603b8a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10856d880>]}
[0m01:30:50.824189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7a632f3d-36b5-4972-aad0-9d0c603b8a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10873e990>]}
[0m01:30:50.824461 [info ] [MainThread]: Found 4 seeds, 2 models, 421 macros
[0m01:30:50.824625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a632f3d-36b5-4972-aad0-9d0c603b8a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108da2ff0>]}
[0m01:30:50.825374 [info ] [MainThread]: 
[0m01:30:50.825670 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:30:50.828143 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_data_takehome'
[0m01:30:50.855601 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome"
[0m01:30:50.855836 [debug] [ThreadPool]: On list_data_takehome: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m01:30:50.855976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:30:50.859180 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m01:30:50.859836 [debug] [ThreadPool]: On list_data_takehome: Close
[0m01:30:50.860542 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data_takehome, now create_data_takehome_main)
[0m01:30:50.860748 [debug] [ThreadPool]: Creating schema "database: "data_takehome"
schema: "main"
"
[0m01:30:50.863913 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m01:30:50.864069 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
        select type from duckdb_databases()
        where database_name='data_takehome'
        and type='sqlite'
    
  
[0m01:30:50.864192 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:30:50.866484 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m01:30:50.867101 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m01:30:50.867234 [debug] [ThreadPool]: On create_data_takehome_main: BEGIN
[0m01:30:50.867377 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:30:50.867487 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m01:30:50.867596 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
    
        create schema if not exists "data_takehome"."main"
    
[0m01:30:50.867748 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:30:50.868104 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m01:30:50.868222 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m01:30:50.868328 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m01:30:50.868462 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:30:50.868575 [debug] [ThreadPool]: On create_data_takehome_main: Close
[0m01:30:50.869526 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_data_takehome_main, now list_data_takehome_main)
[0m01:30:50.872094 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m01:30:50.872263 [debug] [ThreadPool]: On list_data_takehome_main: BEGIN
[0m01:30:50.872392 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:30:50.874910 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m01:30:50.875102 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m01:30:50.875257 [debug] [ThreadPool]: On list_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome_main"} */
select
      'data_takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'data_takehome'
  
[0m01:30:50.884544 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m01:30:50.886736 [debug] [ThreadPool]: On list_data_takehome_main: ROLLBACK
[0m01:30:50.887841 [debug] [ThreadPool]: Failed to rollback 'list_data_takehome_main'
[0m01:30:50.887981 [debug] [ThreadPool]: On list_data_takehome_main: Close
[0m01:30:50.889014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7a632f3d-36b5-4972-aad0-9d0c603b8a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108da0500>]}
[0m01:30:50.889222 [debug] [MainThread]: Using duckdb connection "master"
[0m01:30:50.889343 [debug] [MainThread]: On master: BEGIN
[0m01:30:50.889457 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:30:50.891671 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m01:30:50.891832 [debug] [MainThread]: On master: COMMIT
[0m01:30:50.891958 [debug] [MainThread]: Using duckdb connection "master"
[0m01:30:50.892074 [debug] [MainThread]: On master: COMMIT
[0m01:30:50.892210 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:30:50.892330 [debug] [MainThread]: On master: Close
[0m01:30:50.892794 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m01:30:50.892942 [info ] [MainThread]: 
[0m01:30:50.894873 [debug] [Thread-1 (]: Began running node model.data_takehome.activities
[0m01:30:50.895066 [debug] [Thread-2 (]: Began running node model.data_takehome.patients
[0m01:30:50.895310 [info ] [Thread-1 (]: 1 of 2 START sql view model main.activities .................................... [RUN]
[0m01:30:50.895531 [info ] [Thread-2 (]: 2 of 2 START sql view model main.patients ...................................... [RUN]
[0m01:30:50.895765 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_takehome_main, now model.data_takehome.activities)
[0m01:30:50.895994 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.data_takehome.patients'
[0m01:30:50.896157 [debug] [Thread-1 (]: Began compiling node model.data_takehome.activities
[0m01:30:50.896300 [debug] [Thread-2 (]: Began compiling node model.data_takehome.patients
[0m01:30:50.899619 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_takehome.activities"
[0m01:30:50.900746 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_takehome.patients"
[0m01:30:50.901254 [debug] [Thread-1 (]: Began executing node model.data_takehome.activities
[0m01:30:50.901438 [debug] [Thread-2 (]: Began executing node model.data_takehome.patients
[0m01:30:50.922101 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_takehome.activities"
[0m01:30:50.922383 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_takehome.patients"
[0m01:30:50.922837 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities"
[0m01:30:50.922981 [debug] [Thread-1 (]: On model.data_takehome.activities: BEGIN
[0m01:30:50.923112 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:30:50.925482 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:30:50.925683 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients"
[0m01:30:50.925874 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities"
[0m01:30:50.926053 [debug] [Thread-2 (]: On model.data_takehome.patients: BEGIN
[0m01:30:50.926221 [debug] [Thread-1 (]: On model.data_takehome.activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities"} */

  
  create view "data_takehome"."main"."activities__dbt_tmp" as (
    with activities as (
select * from ref  )

select * from activities
  );

[0m01:30:50.926375 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:30:50.926610 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m01:30:50.926747 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients"
[0m01:30:50.926904 [debug] [Thread-2 (]: On model.data_takehome.patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients"} */

  
  create view "data_takehome"."main"."patients__dbt_tmp" as (
    WITH patients AS (
  SELECT 
    json_extract_string(data, '$.patient_id') AS patient_id,
    json_extract_string(data, '$.practice_id') AS practice_id,
    json_extract_string(data, '$.age') AS age,
    json_extract_string(data, '$.gender') AS gender,
    json_extract_string(data, '$.registration_date') AS registration_date,
    json_extract_string(data, '$.conditions') AS conditions,
    json_extract_string(data, '$.contact.email') AS email,
    json_extract_string(data, '$.contact.phone') AS phone
  FROM ref 
  --WHERE data IS NOT NULL
)

-- Create the final normalized table
SELECT 
  patient_id,
  practice_id,
  age,
  gender,
  registration_date,
  conditions,
  email,
  phone
FROM patients
--WHERE patient_id IS NOT NULL;
  );

[0m01:30:50.934716 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities"} */

  
  create view "data_takehome"."main"."activities__dbt_tmp" as (
    with activities as (
select * from ref  )

select * from activities
  );

[0m01:30:50.934900 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:30:50.935109 [debug] [Thread-1 (]: On model.data_takehome.activities: ROLLBACK
[0m01:30:50.936051 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients"} */

  
  create view "data_takehome"."main"."patients__dbt_tmp" as (
    WITH patients AS (
  SELECT 
    json_extract_string(data, '$.patient_id') AS patient_id,
    json_extract_string(data, '$.practice_id') AS practice_id,
    json_extract_string(data, '$.age') AS age,
    json_extract_string(data, '$.gender') AS gender,
    json_extract_string(data, '$.registration_date') AS registration_date,
    json_extract_string(data, '$.conditions') AS conditions,
    json_extract_string(data, '$.contact.email') AS email,
    json_extract_string(data, '$.contact.phone') AS phone
  FROM ref 
  --WHERE data IS NOT NULL
)

-- Create the final normalized table
SELECT 
  patient_id,
  practice_id,
  age,
  gender,
  registration_date,
  conditions,
  email,
  phone
FROM patients
--WHERE patient_id IS NOT NULL;
  );

[0m01:30:50.936241 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m01:30:50.936422 [debug] [Thread-2 (]: On model.data_takehome.patients: ROLLBACK
[0m01:30:50.939001 [debug] [Thread-1 (]: Failed to rollback 'model.data_takehome.activities'
[0m01:30:50.939173 [debug] [Thread-1 (]: On model.data_takehome.activities: Close
[0m01:30:50.940362 [debug] [Thread-1 (]: Runtime Error in model activities (models/staging/activities.sql)
  Catalog Error: Table with name ref does not exist!
  Did you mean "pg_attrdef"?
  LINE 6: select * from ref  )
                        ^
[0m01:30:50.941050 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a632f3d-36b5-4972-aad0-9d0c603b8a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109188b60>]}
[0m01:30:50.941346 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model main.activities ........................... [[31mERROR[0m in 0.04s]
[0m01:30:50.941616 [debug] [Thread-1 (]: Finished running node model.data_takehome.activities
[0m01:30:50.942354 [debug] [Thread-2 (]: Failed to rollback 'model.data_takehome.patients'
[0m01:30:50.942514 [debug] [Thread-2 (]: On model.data_takehome.patients: Close
[0m01:30:50.944158 [debug] [Thread-2 (]: Runtime Error in model patients (models/staging/patients.sql)
  Catalog Error: Table with name ref does not exist!
  Did you mean "pg_attrdef"?
  LINE 15:   FROM ref 
                  ^
[0m01:30:50.944343 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7a632f3d-36b5-4972-aad0-9d0c603b8a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109112600>]}
[0m01:30:50.944580 [error] [Thread-2 (]: 2 of 2 ERROR creating sql view model main.patients ............................. [[31mERROR[0m in 0.05s]
[0m01:30:50.944819 [debug] [Thread-2 (]: Finished running node model.data_takehome.patients
[0m01:30:50.945765 [debug] [MainThread]: Using duckdb connection "master"
[0m01:30:50.945895 [debug] [MainThread]: On master: BEGIN
[0m01:30:50.946006 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:30:50.948334 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m01:30:50.948498 [debug] [MainThread]: On master: COMMIT
[0m01:30:50.948621 [debug] [MainThread]: Using duckdb connection "master"
[0m01:30:50.948738 [debug] [MainThread]: On master: COMMIT
[0m01:30:50.948877 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:30:50.948994 [debug] [MainThread]: On master: Close
[0m01:30:50.949504 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:30:50.949639 [debug] [MainThread]: Connection 'model.data_takehome.activities' was properly closed.
[0m01:30:50.949747 [debug] [MainThread]: Connection 'model.data_takehome.patients' was properly closed.
[0m01:30:50.949910 [info ] [MainThread]: 
[0m01:30:50.950057 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m01:30:50.950536 [debug] [MainThread]: Command end result
[0m01:30:50.962817 [info ] [MainThread]: 
[0m01:30:50.963060 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m01:30:50.963206 [info ] [MainThread]: 
[0m01:30:50.963385 [error] [MainThread]:   Runtime Error in model activities (models/staging/activities.sql)
  Catalog Error: Table with name ref does not exist!
  Did you mean "pg_attrdef"?
  LINE 6: select * from ref  )
                        ^
[0m01:30:50.963519 [info ] [MainThread]: 
[0m01:30:50.963671 [error] [MainThread]:   Runtime Error in model patients (models/staging/patients.sql)
  Catalog Error: Table with name ref does not exist!
  Did you mean "pg_attrdef"?
  LINE 15:   FROM ref 
                  ^
[0m01:30:50.963797 [info ] [MainThread]: 
[0m01:30:50.963937 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m01:30:50.965478 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.44622043, "process_user_time": 0.921385, "process_kernel_time": 0.146076, "process_mem_max_rss": "129056768", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:30:50.965710 [debug] [MainThread]: Command `dbt run` failed at 01:30:50.965670 after 0.45 seconds
[0m01:30:50.965884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108650c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108200fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086f2c90>]}
[0m01:30:50.966037 [debug] [MainThread]: Flushing usage events
[0m01:33:06.278749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041e8080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c45820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c45430>]}


============================== 01:33:06.281786 | d04e9bd1-4e55-4978-8509-dda5ca34db53 ==============================
[0m01:33:06.281786 [info ] [MainThread]: Running with dbt=1.8.1
[0m01:33:06.282135 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m01:33:06.443703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd04e9bd1-4e55-4978-8509-dda5ca34db53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c47f20>]}
[0m01:33:06.486276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd04e9bd1-4e55-4978-8509-dda5ca34db53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dd1730>]}
[0m01:33:06.487092 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m01:33:06.541731 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m01:33:06.595167 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:33:06.595389 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:33:06.610614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd04e9bd1-4e55-4978-8509-dda5ca34db53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dd33e0>]}
[0m01:33:06.652382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd04e9bd1-4e55-4978-8509-dda5ca34db53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dd0e30>]}
[0m01:33:06.652658 [info ] [MainThread]: Found 4 seeds, 2 models, 421 macros
[0m01:33:06.652822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd04e9bd1-4e55-4978-8509-dda5ca34db53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050a2a80>]}
[0m01:33:06.653615 [info ] [MainThread]: 
[0m01:33:06.653893 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:33:06.656178 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_data_takehome'
[0m01:33:06.699654 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome"
[0m01:33:06.699895 [debug] [ThreadPool]: On list_data_takehome: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m01:33:06.700037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:33:06.716177 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m01:33:06.717327 [debug] [ThreadPool]: On list_data_takehome: Close
[0m01:33:06.718268 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data_takehome, now create_data_takehome_main)
[0m01:33:06.718483 [debug] [ThreadPool]: Creating schema "database: "data_takehome"
schema: "main"
"
[0m01:33:06.721810 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m01:33:06.721971 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
        select type from duckdb_databases()
        where database_name='data_takehome'
        and type='sqlite'
    
  
[0m01:33:06.722097 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:33:06.724853 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m01:33:06.725513 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m01:33:06.725650 [debug] [ThreadPool]: On create_data_takehome_main: BEGIN
[0m01:33:06.725790 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:33:06.725903 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m01:33:06.726019 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
    
        create schema if not exists "data_takehome"."main"
    
[0m01:33:06.726706 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:33:06.727102 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m01:33:06.727225 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m01:33:06.727336 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m01:33:06.727476 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:33:06.727598 [debug] [ThreadPool]: On create_data_takehome_main: Close
[0m01:33:06.728587 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_data_takehome_main, now list_data_takehome_main)
[0m01:33:06.731298 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m01:33:06.731462 [debug] [ThreadPool]: On list_data_takehome_main: BEGIN
[0m01:33:06.731601 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:33:06.733932 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m01:33:06.734093 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m01:33:06.734234 [debug] [ThreadPool]: On list_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome_main"} */
select
      'data_takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'data_takehome'
  
[0m01:33:06.747912 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m01:33:06.750951 [debug] [ThreadPool]: On list_data_takehome_main: ROLLBACK
[0m01:33:06.751973 [debug] [ThreadPool]: Failed to rollback 'list_data_takehome_main'
[0m01:33:06.752115 [debug] [ThreadPool]: On list_data_takehome_main: Close
[0m01:33:06.753195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd04e9bd1-4e55-4978-8509-dda5ca34db53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c06a80>]}
[0m01:33:06.753406 [debug] [MainThread]: Using duckdb connection "master"
[0m01:33:06.753527 [debug] [MainThread]: On master: BEGIN
[0m01:33:06.753642 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:33:06.755860 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m01:33:06.756018 [debug] [MainThread]: On master: COMMIT
[0m01:33:06.756143 [debug] [MainThread]: Using duckdb connection "master"
[0m01:33:06.756258 [debug] [MainThread]: On master: COMMIT
[0m01:33:06.756396 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:33:06.756516 [debug] [MainThread]: On master: Close
[0m01:33:06.756970 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m01:33:06.757147 [info ] [MainThread]: 
[0m01:33:06.759259 [debug] [Thread-1 (]: Began running node seed.data_takehome.raw_activities
[0m01:33:06.759447 [debug] [Thread-2 (]: Began running node seed.data_takehome.raw_patients
[0m01:33:06.759816 [debug] [Thread-3 (]: Began running node seed.data_takehome.raw_pcns
[0m01:33:06.759968 [debug] [Thread-4 (]: Began running node seed.data_takehome.raw_practices
[0m01:33:06.759682 [info ] [Thread-1 (]: 1 of 4 START seed file main.raw_activities ..................................... [RUN]
[0m01:33:06.760198 [info ] [Thread-2 (]: 2 of 4 START seed file main.raw_patients ....................................... [RUN]
[0m01:33:06.760401 [info ] [Thread-3 (]: 3 of 4 START seed file main.raw_pcns ........................................... [RUN]
[0m01:33:06.760588 [info ] [Thread-4 (]: 4 of 4 START seed file main.raw_practices ...................................... [RUN]
[0m01:33:06.760831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_takehome_main, now seed.data_takehome.raw_activities)
[0m01:33:06.761093 [debug] [Thread-2 (]: Acquiring new duckdb connection 'seed.data_takehome.raw_patients'
[0m01:33:06.761303 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.data_takehome.raw_pcns'
[0m01:33:06.761489 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.data_takehome.raw_practices'
[0m01:33:06.761635 [debug] [Thread-1 (]: Began compiling node seed.data_takehome.raw_activities
[0m01:33:06.761774 [debug] [Thread-2 (]: Began compiling node seed.data_takehome.raw_patients
[0m01:33:06.761905 [debug] [Thread-3 (]: Began compiling node seed.data_takehome.raw_pcns
[0m01:33:06.762035 [debug] [Thread-4 (]: Began compiling node seed.data_takehome.raw_practices
[0m01:33:06.762172 [debug] [Thread-1 (]: Began executing node seed.data_takehome.raw_activities
[0m01:33:06.762309 [debug] [Thread-2 (]: Began executing node seed.data_takehome.raw_patients
[0m01:33:06.762441 [debug] [Thread-3 (]: Began executing node seed.data_takehome.raw_pcns
[0m01:33:06.762573 [debug] [Thread-4 (]: Began executing node seed.data_takehome.raw_practices
[0m01:33:06.798552 [debug] [Thread-4 (]: Using duckdb connection "seed.data_takehome.raw_practices"
[0m01:33:06.798761 [debug] [Thread-4 (]: On seed.data_takehome.raw_practices: BEGIN
[0m01:33:06.798966 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m01:33:06.814888 [debug] [Thread-1 (]: Using duckdb connection "seed.data_takehome.raw_activities"
[0m01:33:06.816499 [debug] [Thread-2 (]: Using duckdb connection "seed.data_takehome.raw_patients"
[0m01:33:06.816656 [debug] [Thread-1 (]: On seed.data_takehome.raw_activities: BEGIN
[0m01:33:06.817640 [debug] [Thread-3 (]: Using duckdb connection "seed.data_takehome.raw_pcns"
[0m01:33:06.817799 [debug] [Thread-2 (]: On seed.data_takehome.raw_patients: BEGIN
[0m01:33:06.817960 [debug] [Thread-4 (]: SQL status: OK in 0.019 seconds
[0m01:33:06.818105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:06.818243 [debug] [Thread-3 (]: On seed.data_takehome.raw_pcns: BEGIN
[0m01:33:06.818373 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:33:06.818505 [debug] [Thread-4 (]: Using duckdb connection "seed.data_takehome.raw_practices"
[0m01:33:06.818698 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m01:33:06.818865 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:33:06.819091 [debug] [Thread-4 (]: On seed.data_takehome.raw_practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "seed.data_takehome.raw_practices"} */
truncate table "data_takehome"."main"."raw_practices"
[0m01:33:06.819277 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m01:33:06.819477 [debug] [Thread-1 (]: Using duckdb connection "seed.data_takehome.raw_activities"
[0m01:33:06.819620 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m01:33:06.819785 [debug] [Thread-2 (]: Using duckdb connection "seed.data_takehome.raw_patients"
[0m01:33:06.819928 [debug] [Thread-1 (]: On seed.data_takehome.raw_activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "seed.data_takehome.raw_activities"} */
truncate table "data_takehome"."main"."raw_activities"
[0m01:33:06.820098 [debug] [Thread-3 (]: Using duckdb connection "seed.data_takehome.raw_pcns"
[0m01:33:06.820253 [debug] [Thread-2 (]: On seed.data_takehome.raw_patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "seed.data_takehome.raw_patients"} */
truncate table "data_takehome"."main"."raw_patients"
[0m01:33:06.820427 [debug] [Thread-3 (]: On seed.data_takehome.raw_pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "seed.data_takehome.raw_pcns"} */
truncate table "data_takehome"."main"."raw_pcns"
[0m01:33:06.821931 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m01:33:06.827463 [debug] [Thread-4 (]: Using duckdb connection "seed.data_takehome.raw_practices"
[0m01:33:06.827664 [debug] [Thread-4 (]: On seed.data_takehome.raw_practices: 
          COPY "data_takehome"."main"."raw_practices" FROM '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/seeds/raw_practices.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m01:33:06.827851 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m01:33:06.828440 [debug] [Thread-3 (]: Using duckdb connection "seed.data_takehome.raw_pcns"
[0m01:33:06.828591 [debug] [Thread-3 (]: On seed.data_takehome.raw_pcns: 
          COPY "data_takehome"."main"."raw_pcns" FROM '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/seeds/raw_pcns.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m01:33:06.828746 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m01:33:06.829337 [debug] [Thread-2 (]: Using duckdb connection "seed.data_takehome.raw_patients"
[0m01:33:06.829496 [debug] [Thread-2 (]: On seed.data_takehome.raw_patients: 
          COPY "data_takehome"."main"."raw_patients" FROM '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/seeds/raw_patients.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m01:33:06.829675 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m01:33:06.830388 [debug] [Thread-1 (]: Using duckdb connection "seed.data_takehome.raw_activities"
[0m01:33:06.830590 [debug] [Thread-1 (]: On seed.data_takehome.raw_activities: 
          COPY "data_takehome"."main"."raw_activities" FROM '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/seeds/raw_activities.csv' (FORMAT CSV, HEADER TRUE, DELIMITER ',')
        ...
[0m01:33:06.833525 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m01:33:06.833721 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m01:33:06.833889 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m01:33:06.836686 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.data_takehome.raw_patients"
[0m01:33:06.837005 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.data_takehome.raw_pcns"
[0m01:33:06.837292 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.data_takehome.raw_practices"
[0m01:33:06.845982 [debug] [Thread-4 (]: On seed.data_takehome.raw_practices: COMMIT
[0m01:33:06.846168 [debug] [Thread-4 (]: Using duckdb connection "seed.data_takehome.raw_practices"
[0m01:33:06.847038 [debug] [Thread-3 (]: On seed.data_takehome.raw_pcns: COMMIT
[0m01:33:06.847717 [debug] [Thread-2 (]: On seed.data_takehome.raw_patients: COMMIT
[0m01:33:06.847871 [debug] [Thread-4 (]: On seed.data_takehome.raw_practices: COMMIT
[0m01:33:06.848028 [debug] [Thread-3 (]: Using duckdb connection "seed.data_takehome.raw_pcns"
[0m01:33:06.848191 [debug] [Thread-2 (]: Using duckdb connection "seed.data_takehome.raw_patients"
[0m01:33:06.848360 [debug] [Thread-3 (]: On seed.data_takehome.raw_pcns: COMMIT
[0m01:33:06.848508 [debug] [Thread-2 (]: On seed.data_takehome.raw_patients: COMMIT
[0m01:33:06.849490 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m01:33:06.849655 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m01:33:06.850544 [debug] [Thread-4 (]: On seed.data_takehome.raw_practices: Close
[0m01:33:06.850882 [debug] [Thread-3 (]: On seed.data_takehome.raw_pcns: Close
[0m01:33:06.851037 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m01:33:06.852109 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd04e9bd1-4e55-4978-8509-dda5ca34db53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035fb860>]}
[0m01:33:06.852473 [debug] [Thread-2 (]: On seed.data_takehome.raw_patients: Close
[0m01:33:06.852858 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd04e9bd1-4e55-4978-8509-dda5ca34db53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041e8860>]}
[0m01:33:06.853108 [info ] [Thread-4 (]: 4 of 4 OK loaded seed file main.raw_practices .................................. [[32mINSERT 5[0m in 0.09s]
[0m01:33:06.853337 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd04e9bd1-4e55-4978-8509-dda5ca34db53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055a47a0>]}
[0m01:33:06.853561 [info ] [Thread-3 (]: 3 of 4 OK loaded seed file main.raw_pcns ....................................... [[32mINSERT 2[0m in 0.09s]
[0m01:33:06.853932 [debug] [Thread-4 (]: Finished running node seed.data_takehome.raw_practices
[0m01:33:06.854405 [debug] [Thread-3 (]: Finished running node seed.data_takehome.raw_pcns
[0m01:33:06.854176 [info ] [Thread-2 (]: 2 of 4 OK loaded seed file main.raw_patients ................................... [[32mINSERT 255[0m in 0.09s]
[0m01:33:06.854782 [debug] [Thread-2 (]: Finished running node seed.data_takehome.raw_patients
[0m01:33:06.904020 [debug] [Thread-1 (]: SQL status: OK in 0.073 seconds
[0m01:33:06.904396 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.data_takehome.raw_activities"
[0m01:33:06.906088 [debug] [Thread-1 (]: On seed.data_takehome.raw_activities: COMMIT
[0m01:33:06.906243 [debug] [Thread-1 (]: Using duckdb connection "seed.data_takehome.raw_activities"
[0m01:33:06.906378 [debug] [Thread-1 (]: On seed.data_takehome.raw_activities: COMMIT
[0m01:33:06.907874 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:33:06.908177 [debug] [Thread-1 (]: On seed.data_takehome.raw_activities: Close
[0m01:33:06.913249 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd04e9bd1-4e55-4978-8509-dda5ca34db53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f227e0>]}
[0m01:33:06.913506 [info ] [Thread-1 (]: 1 of 4 OK loaded seed file main.raw_activities ................................. [[32mINSERT 2007[0m in 0.15s]
[0m01:33:06.913754 [debug] [Thread-1 (]: Finished running node seed.data_takehome.raw_activities
[0m01:33:06.914662 [debug] [MainThread]: Using duckdb connection "master"
[0m01:33:06.914827 [debug] [MainThread]: On master: BEGIN
[0m01:33:06.914951 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:33:06.917316 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m01:33:06.917474 [debug] [MainThread]: On master: COMMIT
[0m01:33:06.917600 [debug] [MainThread]: Using duckdb connection "master"
[0m01:33:06.917712 [debug] [MainThread]: On master: COMMIT
[0m01:33:06.917851 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:33:06.917974 [debug] [MainThread]: On master: Close
[0m01:33:06.918426 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:33:06.918569 [debug] [MainThread]: Connection 'seed.data_takehome.raw_activities' was properly closed.
[0m01:33:06.918682 [debug] [MainThread]: Connection 'seed.data_takehome.raw_patients' was properly closed.
[0m01:33:06.918785 [debug] [MainThread]: Connection 'seed.data_takehome.raw_pcns' was properly closed.
[0m01:33:06.918881 [debug] [MainThread]: Connection 'seed.data_takehome.raw_practices' was properly closed.
[0m01:33:06.919013 [info ] [MainThread]: 
[0m01:33:06.919163 [info ] [MainThread]: Finished running 4 seeds in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m01:33:06.919624 [debug] [MainThread]: Command end result
[0m01:33:06.932621 [info ] [MainThread]: 
[0m01:33:06.932890 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:33:06.933034 [info ] [MainThread]: 
[0m01:33:06.933182 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m01:33:06.935141 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.6918429, "process_user_time": 1.033235, "process_kernel_time": 0.204601, "process_mem_max_rss": "141197312", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:33:06.935388 [debug] [MainThread]: Command `dbt seed` succeeded at 01:33:06.935347 after 0.69 seconds
[0m01:33:06.935559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10468f8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10555edb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10555fe60>]}
[0m01:33:06.935716 [debug] [MainThread]: Flushing usage events
[0m01:33:11.676217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a32b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111481820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111481430>]}


============================== 01:33:11.678427 | a5bc679f-c50e-4b6b-8b14-7165f4affcb3 ==============================
[0m01:33:11.678427 [info ] [MainThread]: Running with dbt=1.8.1
[0m01:33:11.678732 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m01:33:11.768125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5bc679f-c50e-4b6b-8b14-7165f4affcb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111505d60>]}
[0m01:33:11.810726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5bc679f-c50e-4b6b-8b14-7165f4affcb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111505370>]}
[0m01:33:11.811246 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m01:33:11.863389 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m01:33:11.908248 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m01:33:11.908468 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m01:33:11.923758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5bc679f-c50e-4b6b-8b14-7165f4affcb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111455d00>]}
[0m01:33:11.959743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5bc679f-c50e-4b6b-8b14-7165f4affcb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111833bc0>]}
[0m01:33:11.960009 [info ] [MainThread]: Found 4 seeds, 2 models, 421 macros
[0m01:33:11.960180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5bc679f-c50e-4b6b-8b14-7165f4affcb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111967320>]}
[0m01:33:11.960913 [info ] [MainThread]: 
[0m01:33:11.961195 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:33:11.963313 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_data_takehome'
[0m01:33:11.993979 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome"
[0m01:33:12.006436 [debug] [ThreadPool]: On list_data_takehome: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m01:33:12.006596 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:33:12.010133 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m01:33:12.010862 [debug] [ThreadPool]: On list_data_takehome: Close
[0m01:33:12.011618 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data_takehome, now create_data_takehome_main)
[0m01:33:12.011860 [debug] [ThreadPool]: Creating schema "database: "data_takehome"
schema: "main"
"
[0m01:33:12.015356 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m01:33:12.016357 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
        select type from duckdb_databases()
        where database_name='data_takehome'
        and type='sqlite'
    
  
[0m01:33:12.016516 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:33:12.022670 [debug] [ThreadPool]: SQL status: OK in 0.006 seconds
[0m01:33:12.023521 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m01:33:12.024255 [debug] [ThreadPool]: On create_data_takehome_main: BEGIN
[0m01:33:12.025716 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:33:12.027371 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m01:33:12.029361 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
    
        create schema if not exists "data_takehome"."main"
    
[0m01:33:12.029817 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:33:12.030342 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m01:33:12.030699 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m01:33:12.030848 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m01:33:12.031036 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:33:12.037563 [debug] [ThreadPool]: On create_data_takehome_main: Close
[0m01:33:12.039885 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_data_takehome_main, now list_data_takehome_main)
[0m01:33:12.043300 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m01:33:12.043493 [debug] [ThreadPool]: On list_data_takehome_main: BEGIN
[0m01:33:12.043637 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:33:12.046514 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m01:33:12.046710 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m01:33:12.046882 [debug] [ThreadPool]: On list_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome_main"} */
select
      'data_takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'data_takehome'
  
[0m01:33:12.057698 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m01:33:12.060141 [debug] [ThreadPool]: On list_data_takehome_main: ROLLBACK
[0m01:33:12.060843 [debug] [ThreadPool]: Failed to rollback 'list_data_takehome_main'
[0m01:33:12.060990 [debug] [ThreadPool]: On list_data_takehome_main: Close
[0m01:33:12.062035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5bc679f-c50e-4b6b-8b14-7165f4affcb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11181faa0>]}
[0m01:33:12.062271 [debug] [MainThread]: Using duckdb connection "master"
[0m01:33:12.062412 [debug] [MainThread]: On master: BEGIN
[0m01:33:12.062539 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:33:12.064909 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m01:33:12.065229 [debug] [MainThread]: On master: COMMIT
[0m01:33:12.065376 [debug] [MainThread]: Using duckdb connection "master"
[0m01:33:12.066438 [debug] [MainThread]: On master: COMMIT
[0m01:33:12.066602 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:33:12.066764 [debug] [MainThread]: On master: Close
[0m01:33:12.067267 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m01:33:12.067422 [info ] [MainThread]: 
[0m01:33:12.069169 [debug] [Thread-1 (]: Began running node model.data_takehome.activities
[0m01:33:12.069365 [debug] [Thread-2 (]: Began running node model.data_takehome.patients
[0m01:33:12.069609 [info ] [Thread-1 (]: 1 of 2 START sql view model main.activities .................................... [RUN]
[0m01:33:12.069803 [info ] [Thread-2 (]: 2 of 2 START sql view model main.patients ...................................... [RUN]
[0m01:33:12.070064 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_takehome_main, now model.data_takehome.activities)
[0m01:33:12.070290 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.data_takehome.patients'
[0m01:33:12.070454 [debug] [Thread-1 (]: Began compiling node model.data_takehome.activities
[0m01:33:12.070602 [debug] [Thread-2 (]: Began compiling node model.data_takehome.patients
[0m01:33:12.074142 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_takehome.activities"
[0m01:33:12.075355 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_takehome.patients"
[0m01:33:12.076083 [debug] [Thread-2 (]: Began executing node model.data_takehome.patients
[0m01:33:12.076260 [debug] [Thread-1 (]: Began executing node model.data_takehome.activities
[0m01:33:12.096678 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_takehome.patients"
[0m01:33:12.097372 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_takehome.activities"
[0m01:33:12.097906 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities"
[0m01:33:12.098066 [debug] [Thread-1 (]: On model.data_takehome.activities: BEGIN
[0m01:33:12.098207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:33:12.100588 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:33:12.100755 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities"
[0m01:33:12.100902 [debug] [Thread-1 (]: On model.data_takehome.activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities"} */

  
  create view "data_takehome"."main"."activities__dbt_tmp" as (
    with activities as (
select * from ref  )

select * from activities
  );

[0m01:33:12.101091 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients"
[0m01:33:12.101254 [debug] [Thread-2 (]: On model.data_takehome.patients: BEGIN
[0m01:33:12.101390 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:33:12.101818 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m01:33:12.101960 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients"
[0m01:33:12.102121 [debug] [Thread-2 (]: On model.data_takehome.patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients"} */

  
  create view "data_takehome"."main"."patients__dbt_tmp" as (
    WITH patients AS (
  SELECT 
    json_extract_string(data, '$.patient_id') AS patient_id,
    json_extract_string(data, '$.practice_id') AS practice_id,
    json_extract_string(data, '$.age') AS age,
    json_extract_string(data, '$.gender') AS gender,
    json_extract_string(data, '$.registration_date') AS registration_date,
    json_extract_string(data, '$.conditions') AS conditions,
    json_extract_string(data, '$.contact.email') AS email,
    json_extract_string(data, '$.contact.phone') AS phone
  FROM ref 
  --WHERE data IS NOT NULL
)

-- Create the final normalized table
SELECT 
  patient_id,
  practice_id,
  age,
  gender,
  registration_date,
  conditions,
  email,
  phone
FROM patients
--WHERE patient_id IS NOT NULL;
  );

[0m01:33:12.112862 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients"} */

  
  create view "data_takehome"."main"."patients__dbt_tmp" as (
    WITH patients AS (
  SELECT 
    json_extract_string(data, '$.patient_id') AS patient_id,
    json_extract_string(data, '$.practice_id') AS practice_id,
    json_extract_string(data, '$.age') AS age,
    json_extract_string(data, '$.gender') AS gender,
    json_extract_string(data, '$.registration_date') AS registration_date,
    json_extract_string(data, '$.conditions') AS conditions,
    json_extract_string(data, '$.contact.email') AS email,
    json_extract_string(data, '$.contact.phone') AS phone
  FROM ref 
  --WHERE data IS NOT NULL
)

-- Create the final normalized table
SELECT 
  patient_id,
  practice_id,
  age,
  gender,
  registration_date,
  conditions,
  email,
  phone
FROM patients
--WHERE patient_id IS NOT NULL;
  );

[0m01:33:12.113183 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities"} */

  
  create view "data_takehome"."main"."activities__dbt_tmp" as (
    with activities as (
select * from ref  )

select * from activities
  );

[0m01:33:12.113357 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m01:33:12.113590 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:33:12.113833 [debug] [Thread-2 (]: On model.data_takehome.patients: ROLLBACK
[0m01:33:12.114046 [debug] [Thread-1 (]: On model.data_takehome.activities: ROLLBACK
[0m01:33:12.120353 [debug] [Thread-1 (]: Failed to rollback 'model.data_takehome.activities'
[0m01:33:12.120544 [debug] [Thread-1 (]: On model.data_takehome.activities: Close
[0m01:33:12.121212 [debug] [Thread-2 (]: Failed to rollback 'model.data_takehome.patients'
[0m01:33:12.121990 [debug] [Thread-2 (]: On model.data_takehome.patients: Close
[0m01:33:12.123726 [debug] [Thread-1 (]: Runtime Error in model activities (models/staging/activities.sql)
  Catalog Error: Table with name ref does not exist!
  Did you mean "pg_attrdef"?
  LINE 6: select * from ref  )
                        ^
[0m01:33:12.124454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5bc679f-c50e-4b6b-8b14-7165f4affcb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121c8650>]}
[0m01:33:12.124768 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model main.activities ........................... [[31mERROR[0m in 0.05s]
[0m01:33:12.125474 [debug] [Thread-2 (]: Runtime Error in model patients (models/staging/patients.sql)
  Catalog Error: Table with name ref does not exist!
  Did you mean "pg_attrdef"?
  LINE 15:   FROM ref 
                  ^
[0m01:33:12.125729 [debug] [Thread-1 (]: Finished running node model.data_takehome.activities
[0m01:33:12.125914 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5bc679f-c50e-4b6b-8b14-7165f4affcb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112113650>]}
[0m01:33:12.126271 [error] [Thread-2 (]: 2 of 2 ERROR creating sql view model main.patients ............................. [[31mERROR[0m in 0.06s]
[0m01:33:12.126520 [debug] [Thread-2 (]: Finished running node model.data_takehome.patients
[0m01:33:12.127410 [debug] [MainThread]: Using duckdb connection "master"
[0m01:33:12.127557 [debug] [MainThread]: On master: BEGIN
[0m01:33:12.127677 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:33:12.129976 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m01:33:12.130130 [debug] [MainThread]: On master: COMMIT
[0m01:33:12.130249 [debug] [MainThread]: Using duckdb connection "master"
[0m01:33:12.130367 [debug] [MainThread]: On master: COMMIT
[0m01:33:12.130496 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:33:12.130612 [debug] [MainThread]: On master: Close
[0m01:33:12.131048 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:33:12.131176 [debug] [MainThread]: Connection 'model.data_takehome.activities' was properly closed.
[0m01:33:12.131288 [debug] [MainThread]: Connection 'model.data_takehome.patients' was properly closed.
[0m01:33:12.131450 [info ] [MainThread]: 
[0m01:33:12.131587 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m01:33:12.131924 [debug] [MainThread]: Command end result
[0m01:33:12.144053 [info ] [MainThread]: 
[0m01:33:12.144265 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m01:33:12.144408 [info ] [MainThread]: 
[0m01:33:12.144576 [error] [MainThread]:   Runtime Error in model activities (models/staging/activities.sql)
  Catalog Error: Table with name ref does not exist!
  Did you mean "pg_attrdef"?
  LINE 6: select * from ref  )
                        ^
[0m01:33:12.144702 [info ] [MainThread]: 
[0m01:33:12.144850 [error] [MainThread]:   Runtime Error in model patients (models/staging/patients.sql)
  Catalog Error: Table with name ref does not exist!
  Did you mean "pg_attrdef"?
  LINE 15:   FROM ref 
                  ^
[0m01:33:12.144977 [info ] [MainThread]: 
[0m01:33:12.145116 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m01:33:12.146606 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.49929637, "process_user_time": 0.932315, "process_kernel_time": 0.164217, "process_mem_max_rss": "129105920", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:33:12.146836 [debug] [MainThread]: Command `dbt run` failed at 01:33:12.146797 after 0.50 seconds
[0m01:33:12.147004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111438da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a32b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121e3fb0>]}
[0m01:33:12.147151 [debug] [MainThread]: Flushing usage events
[0m01:35:15.886078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086187d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087457c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108745400>]}


============================== 01:35:15.889355 | d7ec75c2-6b8b-45c4-9d6c-67e8d3087e61 ==============================
[0m01:35:15.889355 [info ] [MainThread]: Running with dbt=1.8.1
[0m01:35:15.889729 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:35:16.037142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7ec75c2-6b8b-45c4-9d6c-67e8d3087e61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10881e300>]}
[0m01:35:16.080755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7ec75c2-6b8b-45c4-9d6c-67e8d3087e61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088d0470>]}
[0m01:35:16.081482 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m01:35:16.139946 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m01:35:16.193385 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m01:35:16.193707 [debug] [MainThread]: Partial parsing: updated file: data_takehome://models/staging/activities.sql
[0m01:35:16.193898 [debug] [MainThread]: Partial parsing: updated file: data_takehome://models/staging/patients.sql
[0m01:35:16.290066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7ec75c2-6b8b-45c4-9d6c-67e8d3087e61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bb7da0>]}
[0m01:35:16.330503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7ec75c2-6b8b-45c4-9d6c-67e8d3087e61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108caeea0>]}
[0m01:35:16.330773 [info ] [MainThread]: Found 4 seeds, 2 models, 421 macros
[0m01:35:16.330935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7ec75c2-6b8b-45c4-9d6c-67e8d3087e61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cb74d0>]}
[0m01:35:16.331664 [info ] [MainThread]: 
[0m01:35:16.331930 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:35:16.334076 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_data_takehome'
[0m01:35:16.367648 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome"
[0m01:35:16.367891 [debug] [ThreadPool]: On list_data_takehome: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m01:35:16.368031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:35:16.385828 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m01:35:16.386660 [debug] [ThreadPool]: On list_data_takehome: Close
[0m01:35:16.387675 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data_takehome, now create_data_takehome_main)
[0m01:35:16.387923 [debug] [ThreadPool]: Creating schema "database: "data_takehome"
schema: "main"
"
[0m01:35:16.391253 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m01:35:16.391423 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
        select type from duckdb_databases()
        where database_name='data_takehome'
        and type='sqlite'
    
  
[0m01:35:16.391564 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:35:16.394258 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m01:35:16.394958 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m01:35:16.395100 [debug] [ThreadPool]: On create_data_takehome_main: BEGIN
[0m01:35:16.395246 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:35:16.395370 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m01:35:16.395490 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
    
        create schema if not exists "data_takehome"."main"
    
[0m01:35:16.396098 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:35:16.396501 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m01:35:16.396622 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m01:35:16.396734 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m01:35:16.396893 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:35:16.397016 [debug] [ThreadPool]: On create_data_takehome_main: Close
[0m01:35:16.398041 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_data_takehome_main, now list_data_takehome_main)
[0m01:35:16.400922 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m01:35:16.401091 [debug] [ThreadPool]: On list_data_takehome_main: BEGIN
[0m01:35:16.401223 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:35:16.403630 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m01:35:16.403798 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m01:35:16.403942 [debug] [ThreadPool]: On list_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome_main"} */
select
      'data_takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'data_takehome'
  
[0m01:35:16.417218 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m01:35:16.420435 [debug] [ThreadPool]: On list_data_takehome_main: ROLLBACK
[0m01:35:16.421892 [debug] [ThreadPool]: Failed to rollback 'list_data_takehome_main'
[0m01:35:16.422041 [debug] [ThreadPool]: On list_data_takehome_main: Close
[0m01:35:16.423141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7ec75c2-6b8b-45c4-9d6c-67e8d3087e61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b92030>]}
[0m01:35:16.423382 [debug] [MainThread]: Using duckdb connection "master"
[0m01:35:16.423520 [debug] [MainThread]: On master: BEGIN
[0m01:35:16.423635 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:35:16.425881 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m01:35:16.426037 [debug] [MainThread]: On master: COMMIT
[0m01:35:16.426165 [debug] [MainThread]: Using duckdb connection "master"
[0m01:35:16.426283 [debug] [MainThread]: On master: COMMIT
[0m01:35:16.426424 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:35:16.426547 [debug] [MainThread]: On master: Close
[0m01:35:16.426976 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m01:35:16.427180 [info ] [MainThread]: 
[0m01:35:16.430546 [debug] [Thread-1 (]: Began running node model.data_takehome.activities
[0m01:35:16.430774 [debug] [Thread-2 (]: Began running node model.data_takehome.patients
[0m01:35:16.431021 [info ] [Thread-1 (]: 1 of 2 START sql view model main.activities .................................... [RUN]
[0m01:35:16.431232 [info ] [Thread-2 (]: 2 of 2 START sql view model main.patients ...................................... [RUN]
[0m01:35:16.431543 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_takehome_main, now model.data_takehome.activities)
[0m01:35:16.431771 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.data_takehome.patients'
[0m01:35:16.431937 [debug] [Thread-1 (]: Began compiling node model.data_takehome.activities
[0m01:35:16.432087 [debug] [Thread-2 (]: Began compiling node model.data_takehome.patients
[0m01:35:16.435355 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_takehome.activities"
[0m01:35:16.436526 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_takehome.patients"
[0m01:35:16.437342 [debug] [Thread-2 (]: Began executing node model.data_takehome.patients
[0m01:35:16.437501 [debug] [Thread-1 (]: Began executing node model.data_takehome.activities
[0m01:35:16.453302 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_takehome.activities"
[0m01:35:16.453699 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_takehome.patients"
[0m01:35:16.454353 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities"
[0m01:35:16.454522 [debug] [Thread-1 (]: On model.data_takehome.activities: BEGIN
[0m01:35:16.454695 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:35:16.454938 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients"
[0m01:35:16.457455 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:35:16.457654 [debug] [Thread-2 (]: On model.data_takehome.patients: BEGIN
[0m01:35:16.457828 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities"
[0m01:35:16.457990 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:35:16.458142 [debug] [Thread-1 (]: On model.data_takehome.activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities"} */

  
  create view "data_takehome"."main"."activities__dbt_tmp" as (
    with activities as (
select * from ref raw_activities )

select * from activities
  );

[0m01:35:16.458361 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m01:35:16.458724 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients"
[0m01:35:16.458884 [debug] [Thread-2 (]: On model.data_takehome.patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients"} */

  
  create view "data_takehome"."main"."patients__dbt_tmp" as (
    WITH patients AS (
  SELECT 
    json_extract_string(data, '$.patient_id') AS patient_id,
    json_extract_string(data, '$.practice_id') AS practice_id,
    json_extract_string(data, '$.age') AS age,
    json_extract_string(data, '$.gender') AS gender,
    json_extract_string(data, '$.registration_date') AS registration_date,
    json_extract_string(data, '$.conditions') AS conditions,
    json_extract_string(data, '$.contact.email') AS email,
    json_extract_string(data, '$.contact.phone') AS phone
  FROM ref raw_patients
  --WHERE data IS NOT NULL
)

-- Create the final normalized table
SELECT 
  patient_id,
  practice_id,
  age,
  gender,
  registration_date,
  conditions,
  email,
  phone
FROM patients
--WHERE patient_id IS NOT NULL;
  );

[0m01:35:16.468387 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients"} */

  
  create view "data_takehome"."main"."patients__dbt_tmp" as (
    WITH patients AS (
  SELECT 
    json_extract_string(data, '$.patient_id') AS patient_id,
    json_extract_string(data, '$.practice_id') AS practice_id,
    json_extract_string(data, '$.age') AS age,
    json_extract_string(data, '$.gender') AS gender,
    json_extract_string(data, '$.registration_date') AS registration_date,
    json_extract_string(data, '$.conditions') AS conditions,
    json_extract_string(data, '$.contact.email') AS email,
    json_extract_string(data, '$.contact.phone') AS phone
  FROM ref raw_patients
  --WHERE data IS NOT NULL
)

-- Create the final normalized table
SELECT 
  patient_id,
  practice_id,
  age,
  gender,
  registration_date,
  conditions,
  email,
  phone
FROM patients
--WHERE patient_id IS NOT NULL;
  );

[0m01:35:16.468574 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m01:35:16.468773 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities"} */

  
  create view "data_takehome"."main"."activities__dbt_tmp" as (
    with activities as (
select * from ref raw_activities )

select * from activities
  );

[0m01:35:16.469011 [debug] [Thread-2 (]: On model.data_takehome.patients: ROLLBACK
[0m01:35:16.469195 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m01:35:16.469465 [debug] [Thread-1 (]: On model.data_takehome.activities: ROLLBACK
[0m01:35:16.475099 [debug] [Thread-2 (]: Failed to rollback 'model.data_takehome.patients'
[0m01:35:16.475282 [debug] [Thread-2 (]: On model.data_takehome.patients: Close
[0m01:35:16.476475 [debug] [Thread-1 (]: Failed to rollback 'model.data_takehome.activities'
[0m01:35:16.476648 [debug] [Thread-1 (]: On model.data_takehome.activities: Close
[0m01:35:16.478279 [debug] [Thread-2 (]: Runtime Error in model patients (models/staging/patients.sql)
  Catalog Error: Table with name ref does not exist!
  Did you mean "pg_attrdef"?
  LINE 15:   FROM ref raw_patients
                  ^
[0m01:35:16.479023 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7ec75c2-6b8b-45c4-9d6c-67e8d3087e61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10902bc50>]}
[0m01:35:16.479331 [error] [Thread-2 (]: 2 of 2 ERROR creating sql view model main.patients ............................. [[31mERROR[0m in 0.05s]
[0m01:35:16.479613 [debug] [Thread-2 (]: Finished running node model.data_takehome.patients
[0m01:35:16.480376 [debug] [Thread-1 (]: Runtime Error in model activities (models/staging/activities.sql)
  Catalog Error: Table with name ref does not exist!
  Did you mean "pg_attrdef"?
  LINE 6: select * from ref raw_activities )
                        ^
[0m01:35:16.480573 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7ec75c2-6b8b-45c4-9d6c-67e8d3087e61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b927e0>]}
[0m01:35:16.480846 [error] [Thread-1 (]: 1 of 2 ERROR creating sql view model main.activities ........................... [[31mERROR[0m in 0.05s]
[0m01:35:16.481105 [debug] [Thread-1 (]: Finished running node model.data_takehome.activities
[0m01:35:16.481950 [debug] [MainThread]: Using duckdb connection "master"
[0m01:35:16.482096 [debug] [MainThread]: On master: BEGIN
[0m01:35:16.482213 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:35:16.484532 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m01:35:16.484695 [debug] [MainThread]: On master: COMMIT
[0m01:35:16.484826 [debug] [MainThread]: Using duckdb connection "master"
[0m01:35:16.484947 [debug] [MainThread]: On master: COMMIT
[0m01:35:16.485084 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:35:16.485205 [debug] [MainThread]: On master: Close
[0m01:35:16.485634 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:35:16.485756 [debug] [MainThread]: Connection 'model.data_takehome.activities' was properly closed.
[0m01:35:16.485865 [debug] [MainThread]: Connection 'model.data_takehome.patients' was properly closed.
[0m01:35:16.486023 [info ] [MainThread]: 
[0m01:35:16.486166 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m01:35:16.486512 [debug] [MainThread]: Command end result
[0m01:35:16.499329 [info ] [MainThread]: 
[0m01:35:16.499545 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m01:35:16.499694 [info ] [MainThread]: 
[0m01:35:16.499871 [error] [MainThread]:   Runtime Error in model patients (models/staging/patients.sql)
  Catalog Error: Table with name ref does not exist!
  Did you mean "pg_attrdef"?
  LINE 15:   FROM ref raw_patients
                  ^
[0m01:35:16.500001 [info ] [MainThread]: 
[0m01:35:16.500154 [error] [MainThread]:   Runtime Error in model activities (models/staging/activities.sql)
  Catalog Error: Table with name ref does not exist!
  Did you mean "pg_attrdef"?
  LINE 6: select * from ref raw_activities )
                        ^
[0m01:35:16.500282 [info ] [MainThread]: 
[0m01:35:16.500422 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=2 SKIP=0 TOTAL=2
[0m01:35:16.502568 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6509142, "process_user_time": 1.000586, "process_kernel_time": 0.209769, "process_mem_max_rss": "131973120", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:35:16.503017 [debug] [MainThread]: Command `dbt run` failed at 01:35:16.502955 after 0.65 seconds
[0m01:35:16.503285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b936e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108745400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108747950>]}
[0m01:35:16.503459 [debug] [MainThread]: Flushing usage events
[0m01:36:19.581584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e9f8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d7d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d7d430>]}


============================== 01:36:19.584612 | 428cdce5-af5c-4f82-9570-818897692656 ==============================
[0m01:36:19.584612 [info ] [MainThread]: Running with dbt=1.8.1
[0m01:36:19.584939 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m01:36:19.749625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '428cdce5-af5c-4f82-9570-818897692656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104efdd00>]}
[0m01:36:19.792449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '428cdce5-af5c-4f82-9570-818897692656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060d14f0>]}
[0m01:36:19.793215 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m01:36:19.845963 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m01:36:19.898995 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m01:36:19.899352 [debug] [MainThread]: Partial parsing: updated file: data_takehome://models/staging/patients.sql
[0m01:36:19.899539 [debug] [MainThread]: Partial parsing: updated file: data_takehome://models/staging/activities.sql
[0m01:36:19.995253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '428cdce5-af5c-4f82-9570-818897692656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063d6150>]}
[0m01:36:20.036329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '428cdce5-af5c-4f82-9570-818897692656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064a5070>]}
[0m01:36:20.036610 [info ] [MainThread]: Found 4 seeds, 2 models, 421 macros
[0m01:36:20.036826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '428cdce5-af5c-4f82-9570-818897692656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064b34a0>]}
[0m01:36:20.037561 [info ] [MainThread]: 
[0m01:36:20.037833 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:36:20.039941 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_data_takehome'
[0m01:36:20.083436 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome"
[0m01:36:20.084136 [debug] [ThreadPool]: On list_data_takehome: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m01:36:20.084311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:36:20.097387 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m01:36:20.098672 [debug] [ThreadPool]: On list_data_takehome: Close
[0m01:36:20.099740 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data_takehome, now create_data_takehome_main)
[0m01:36:20.099969 [debug] [ThreadPool]: Creating schema "database: "data_takehome"
schema: "main"
"
[0m01:36:20.103278 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m01:36:20.103457 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
        select type from duckdb_databases()
        where database_name='data_takehome'
        and type='sqlite'
    
  
[0m01:36:20.103663 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:36:20.106490 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m01:36:20.107135 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m01:36:20.107271 [debug] [ThreadPool]: On create_data_takehome_main: BEGIN
[0m01:36:20.107418 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:36:20.107535 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m01:36:20.107654 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
    
        create schema if not exists "data_takehome"."main"
    
[0m01:36:20.108224 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:36:20.108608 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m01:36:20.108729 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m01:36:20.108838 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m01:36:20.108973 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:36:20.109094 [debug] [ThreadPool]: On create_data_takehome_main: Close
[0m01:36:20.110079 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_data_takehome_main, now list_data_takehome_main)
[0m01:36:20.112751 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m01:36:20.112902 [debug] [ThreadPool]: On list_data_takehome_main: BEGIN
[0m01:36:20.113028 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:36:20.115329 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m01:36:20.115509 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m01:36:20.115660 [debug] [ThreadPool]: On list_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome_main"} */
select
      'data_takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'data_takehome'
  
[0m01:36:20.128763 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m01:36:20.131514 [debug] [ThreadPool]: On list_data_takehome_main: ROLLBACK
[0m01:36:20.132488 [debug] [ThreadPool]: Failed to rollback 'list_data_takehome_main'
[0m01:36:20.132626 [debug] [ThreadPool]: On list_data_takehome_main: Close
[0m01:36:20.133666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '428cdce5-af5c-4f82-9570-818897692656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c40050>]}
[0m01:36:20.133917 [debug] [MainThread]: Using duckdb connection "master"
[0m01:36:20.134067 [debug] [MainThread]: On master: BEGIN
[0m01:36:20.134198 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:36:20.136591 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m01:36:20.136768 [debug] [MainThread]: On master: COMMIT
[0m01:36:20.136902 [debug] [MainThread]: Using duckdb connection "master"
[0m01:36:20.137021 [debug] [MainThread]: On master: COMMIT
[0m01:36:20.137169 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:36:20.137291 [debug] [MainThread]: On master: Close
[0m01:36:20.137755 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m01:36:20.137918 [info ] [MainThread]: 
[0m01:36:20.140995 [debug] [Thread-1 (]: Began running node model.data_takehome.activities
[0m01:36:20.141250 [debug] [Thread-2 (]: Began running node model.data_takehome.patients
[0m01:36:20.141585 [info ] [Thread-1 (]: 1 of 2 START sql view model main.activities .................................... [RUN]
[0m01:36:20.141882 [info ] [Thread-2 (]: 2 of 2 START sql view model main.patients ...................................... [RUN]
[0m01:36:20.142168 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_takehome_main, now model.data_takehome.activities)
[0m01:36:20.142401 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.data_takehome.patients'
[0m01:36:20.142581 [debug] [Thread-1 (]: Began compiling node model.data_takehome.activities
[0m01:36:20.142732 [debug] [Thread-2 (]: Began compiling node model.data_takehome.patients
[0m01:36:20.146201 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_takehome.activities"
[0m01:36:20.147418 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_takehome.patients"
[0m01:36:20.147919 [debug] [Thread-1 (]: Began executing node model.data_takehome.activities
[0m01:36:20.148084 [debug] [Thread-2 (]: Began executing node model.data_takehome.patients
[0m01:36:20.162846 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_takehome.activities"
[0m01:36:20.164417 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_takehome.patients"
[0m01:36:20.164957 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients"
[0m01:36:20.165125 [debug] [Thread-2 (]: On model.data_takehome.patients: BEGIN
[0m01:36:20.165308 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities"
[0m01:36:20.165462 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:36:20.165608 [debug] [Thread-1 (]: On model.data_takehome.activities: BEGIN
[0m01:36:20.168135 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m01:36:20.168337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:36:20.168515 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients"
[0m01:36:20.168754 [debug] [Thread-2 (]: On model.data_takehome.patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients"} */

  
  create view "data_takehome"."main"."patients__dbt_tmp" as (
    WITH patients AS (
  SELECT 
    json_extract_string(data, '$.patient_id') AS patient_id,
    json_extract_string(data, '$.practice_id') AS practice_id,
    json_extract_string(data, '$.age') AS age,
    json_extract_string(data, '$.gender') AS gender,
    json_extract_string(data, '$.registration_date') AS registration_date,
    json_extract_string(data, '$.conditions') AS conditions,
    json_extract_string(data, '$.contact.email') AS email,
    json_extract_string(data, '$.contact.phone') AS phone
  FROM ref "data_takehome"."main"."raw_patients"
  --WHERE data IS NOT NULL
)

-- Create the final normalized table
SELECT 
  patient_id,
  practice_id,
  age,
  gender,
  registration_date,
  conditions,
  email,
  phone
FROM patients
--WHERE patient_id IS NOT NULL;
  );

[0m01:36:20.168934 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:36:20.169115 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities"
[0m01:36:20.169279 [debug] [Thread-1 (]: On model.data_takehome.activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities"} */

  
  create view "data_takehome"."main"."activities__dbt_tmp" as (
    with activities as (
select * from "data_takehome"."main"."raw_activities" )

select * from activities
  );

[0m01:36:20.169745 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:36:20.173069 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities"
[0m01:36:20.173248 [debug] [Thread-1 (]: On model.data_takehome.activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities"} */
alter view "data_takehome"."main"."activities__dbt_tmp" rename to "activities"
[0m01:36:20.173750 [debug] [Thread-2 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients"} */

  
  create view "data_takehome"."main"."patients__dbt_tmp" as (
    WITH patients AS (
  SELECT 
    json_extract_string(data, '$.patient_id') AS patient_id,
    json_extract_string(data, '$.practice_id') AS practice_id,
    json_extract_string(data, '$.age') AS age,
    json_extract_string(data, '$.gender') AS gender,
    json_extract_string(data, '$.registration_date') AS registration_date,
    json_extract_string(data, '$.conditions') AS conditions,
    json_extract_string(data, '$.contact.email') AS email,
    json_extract_string(data, '$.contact.phone') AS phone
  FROM ref "data_takehome"."main"."raw_patients"
  --WHERE data IS NOT NULL
)

-- Create the final normalized table
SELECT 
  patient_id,
  practice_id,
  age,
  gender,
  registration_date,
  conditions,
  email,
  phone
FROM patients
--WHERE patient_id IS NOT NULL;
  );

[0m01:36:20.173960 [debug] [Thread-2 (]: DuckDB adapter: Rolling back transaction.
[0m01:36:20.174170 [debug] [Thread-2 (]: On model.data_takehome.patients: ROLLBACK
[0m01:36:20.174350 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:36:20.181837 [debug] [Thread-1 (]: On model.data_takehome.activities: COMMIT
[0m01:36:20.182020 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities"
[0m01:36:20.182178 [debug] [Thread-1 (]: On model.data_takehome.activities: COMMIT
[0m01:36:20.182950 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:36:20.185289 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities"
[0m01:36:20.185461 [debug] [Thread-1 (]: On model.data_takehome.activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities"} */
drop view if exists "data_takehome"."main"."activities__dbt_backup" cascade
[0m01:36:20.185691 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:36:20.186824 [debug] [Thread-1 (]: On model.data_takehome.activities: Close
[0m01:36:20.187474 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '428cdce5-af5c-4f82-9570-818897692656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10638ede0>]}
[0m01:36:20.187761 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main.activities ............................... [[32mOK[0m in 0.04s]
[0m01:36:20.188460 [debug] [Thread-1 (]: Finished running node model.data_takehome.activities
[0m01:36:20.191447 [debug] [Thread-2 (]: Failed to rollback 'model.data_takehome.patients'
[0m01:36:20.191648 [debug] [Thread-2 (]: On model.data_takehome.patients: Close
[0m01:36:20.196945 [debug] [Thread-2 (]: Runtime Error in model patients (models/staging/patients.sql)
  Parser Error: syntax error at or near "."
[0m01:36:20.197188 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '428cdce5-af5c-4f82-9570-818897692656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107560e30>]}
[0m01:36:20.197497 [error] [Thread-2 (]: 2 of 2 ERROR creating sql view model main.patients ............................. [[31mERROR[0m in 0.05s]
[0m01:36:20.197767 [debug] [Thread-2 (]: Finished running node model.data_takehome.patients
[0m01:36:20.198659 [debug] [MainThread]: Using duckdb connection "master"
[0m01:36:20.198805 [debug] [MainThread]: On master: BEGIN
[0m01:36:20.198920 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:36:20.201329 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m01:36:20.201541 [debug] [MainThread]: On master: COMMIT
[0m01:36:20.201672 [debug] [MainThread]: Using duckdb connection "master"
[0m01:36:20.201781 [debug] [MainThread]: On master: COMMIT
[0m01:36:20.201914 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:36:20.202031 [debug] [MainThread]: On master: Close
[0m01:36:20.202439 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:36:20.202559 [debug] [MainThread]: Connection 'model.data_takehome.activities' was properly closed.
[0m01:36:20.202667 [debug] [MainThread]: Connection 'model.data_takehome.patients' was properly closed.
[0m01:36:20.202899 [info ] [MainThread]: 
[0m01:36:20.203073 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m01:36:20.203501 [debug] [MainThread]: Command end result
[0m01:36:20.217355 [info ] [MainThread]: 
[0m01:36:20.217608 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m01:36:20.217752 [info ] [MainThread]: 
[0m01:36:20.217924 [error] [MainThread]:   Runtime Error in model patients (models/staging/patients.sql)
  Parser Error: syntax error at or near "."
[0m01:36:20.218056 [info ] [MainThread]: 
[0m01:36:20.218196 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m01:36:20.220349 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.671017, "process_user_time": 0.996929, "process_kernel_time": 0.202636, "process_mem_max_rss": "132497408", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:36:20.220694 [debug] [MainThread]: Command `dbt run` failed at 01:36:20.220641 after 0.67 seconds
[0m01:36:20.220912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e9f8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060a42c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10753d9d0>]}
[0m01:36:20.221100 [debug] [MainThread]: Flushing usage events
[0m01:37:18.836963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ea78c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044859d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044855e0>]}


============================== 01:37:18.839845 | 4747cc49-1709-4915-a465-dbc97b297a73 ==============================
[0m01:37:18.839845 [info ] [MainThread]: Running with dbt=1.8.1
[0m01:37:18.840168 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'version_check': 'True', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m01:37:18.996116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4747cc49-1709-4915-a465-dbc97b297a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104461a00>]}
[0m01:37:19.038778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4747cc49-1709-4915-a465-dbc97b297a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045ac3b0>]}
[0m01:37:19.040018 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m01:37:19.093623 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m01:37:19.146157 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m01:37:19.146493 [debug] [MainThread]: Partial parsing: updated file: data_takehome://models/staging/patients.sql
[0m01:37:19.240752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4747cc49-1709-4915-a465-dbc97b297a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a1f2c0>]}
[0m01:37:19.278947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4747cc49-1709-4915-a465-dbc97b297a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049ef200>]}
[0m01:37:19.279217 [info ] [MainThread]: Found 4 seeds, 2 models, 421 macros
[0m01:37:19.279394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4747cc49-1709-4915-a465-dbc97b297a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049fb4a0>]}
[0m01:37:19.280185 [info ] [MainThread]: 
[0m01:37:19.280474 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m01:37:19.282668 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_data_takehome'
[0m01:37:19.314777 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome"
[0m01:37:19.315022 [debug] [ThreadPool]: On list_data_takehome: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m01:37:19.315230 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m01:37:19.335213 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m01:37:19.336853 [debug] [ThreadPool]: On list_data_takehome: Close
[0m01:37:19.337793 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data_takehome, now create_data_takehome_main)
[0m01:37:19.338015 [debug] [ThreadPool]: Creating schema "database: "data_takehome"
schema: "main"
"
[0m01:37:19.341222 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m01:37:19.341382 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
        select type from duckdb_databases()
        where database_name='data_takehome'
        and type='sqlite'
    
  
[0m01:37:19.341507 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:37:19.343977 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m01:37:19.344635 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m01:37:19.344773 [debug] [ThreadPool]: On create_data_takehome_main: BEGIN
[0m01:37:19.344917 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:37:19.345031 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m01:37:19.345147 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
    
        create schema if not exists "data_takehome"."main"
    
[0m01:37:19.345964 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m01:37:19.346370 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m01:37:19.346503 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m01:37:19.346620 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m01:37:19.346765 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m01:37:19.346891 [debug] [ThreadPool]: On create_data_takehome_main: Close
[0m01:37:19.347825 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_data_takehome_main, now list_data_takehome_main)
[0m01:37:19.350348 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m01:37:19.350491 [debug] [ThreadPool]: On list_data_takehome_main: BEGIN
[0m01:37:19.350606 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m01:37:19.352830 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m01:37:19.352969 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m01:37:19.353101 [debug] [ThreadPool]: On list_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome_main"} */
select
      'data_takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'data_takehome'
  
[0m01:37:19.365887 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m01:37:19.368906 [debug] [ThreadPool]: On list_data_takehome_main: ROLLBACK
[0m01:37:19.369887 [debug] [ThreadPool]: Failed to rollback 'list_data_takehome_main'
[0m01:37:19.370028 [debug] [ThreadPool]: On list_data_takehome_main: Close
[0m01:37:19.371147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4747cc49-1709-4915-a465-dbc97b297a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049fb8f0>]}
[0m01:37:19.371363 [debug] [MainThread]: Using duckdb connection "master"
[0m01:37:19.371492 [debug] [MainThread]: On master: BEGIN
[0m01:37:19.371608 [debug] [MainThread]: Opening a new connection, currently in state init
[0m01:37:19.373822 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m01:37:19.373981 [debug] [MainThread]: On master: COMMIT
[0m01:37:19.374107 [debug] [MainThread]: Using duckdb connection "master"
[0m01:37:19.374226 [debug] [MainThread]: On master: COMMIT
[0m01:37:19.374371 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:37:19.374489 [debug] [MainThread]: On master: Close
[0m01:37:19.374951 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m01:37:19.375147 [info ] [MainThread]: 
[0m01:37:19.377729 [debug] [Thread-1 (]: Began running node model.data_takehome.activities
[0m01:37:19.377932 [debug] [Thread-2 (]: Began running node model.data_takehome.patients
[0m01:37:19.378173 [info ] [Thread-1 (]: 1 of 2 START sql view model main.activities .................................... [RUN]
[0m01:37:19.378377 [info ] [Thread-2 (]: 2 of 2 START sql view model main.patients ...................................... [RUN]
[0m01:37:19.378633 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_takehome_main, now model.data_takehome.activities)
[0m01:37:19.378853 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.data_takehome.patients'
[0m01:37:19.379035 [debug] [Thread-1 (]: Began compiling node model.data_takehome.activities
[0m01:37:19.379177 [debug] [Thread-2 (]: Began compiling node model.data_takehome.patients
[0m01:37:19.382547 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_takehome.activities"
[0m01:37:19.383906 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_takehome.patients"
[0m01:37:19.384469 [debug] [Thread-2 (]: Began executing node model.data_takehome.patients
[0m01:37:19.384635 [debug] [Thread-1 (]: Began executing node model.data_takehome.activities
[0m01:37:19.400824 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_takehome.activities"
[0m01:37:19.401612 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_takehome.patients"
[0m01:37:19.401960 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities"
[0m01:37:19.402107 [debug] [Thread-1 (]: On model.data_takehome.activities: BEGIN
[0m01:37:19.402239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m01:37:19.404858 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m01:37:19.405071 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients"
[0m01:37:19.405215 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities"
[0m01:37:19.405368 [debug] [Thread-2 (]: On model.data_takehome.patients: BEGIN
[0m01:37:19.405516 [debug] [Thread-1 (]: On model.data_takehome.activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities"} */

  
  create view "data_takehome"."main"."activities__dbt_tmp" as (
    with activities as (
select * from "data_takehome"."main"."raw_activities" )

select * from activities
  );

[0m01:37:19.405663 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m01:37:19.405865 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m01:37:19.406000 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients"
[0m01:37:19.406158 [debug] [Thread-2 (]: On model.data_takehome.patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients"} */

  
  create view "data_takehome"."main"."patients__dbt_tmp" as (
    WITH patients AS (
  SELECT 
    json_extract_string(data, '$.patient_id') AS patient_id,
    json_extract_string(data, '$.practice_id') AS practice_id,
    json_extract_string(data, '$.age') AS age,
    json_extract_string(data, '$.gender') AS gender,
    json_extract_string(data, '$.registration_date') AS registration_date,
    json_extract_string(data, '$.conditions') AS conditions,
    json_extract_string(data, '$.contact.email') AS email,
    json_extract_string(data, '$.contact.phone') AS phone
  FROM "data_takehome"."main"."raw_patients"
  --WHERE data IS NOT NULL
)

-- Create the final normalized table
SELECT 
  patient_id,
  practice_id,
  age,
  gender,
  registration_date,
  conditions,
  email,
  phone
FROM patients
--WHERE patient_id IS NOT NULL;
  );

[0m01:37:19.406326 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:37:19.409412 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities"
[0m01:37:19.409592 [debug] [Thread-1 (]: On model.data_takehome.activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities"} */
alter view "data_takehome"."main"."activities" rename to "activities__dbt_backup"
[0m01:37:19.409871 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m01:37:19.411237 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients"
[0m01:37:19.411388 [debug] [Thread-2 (]: On model.data_takehome.patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients"} */
alter view "data_takehome"."main"."patients" rename to "patients__dbt_backup"
[0m01:37:19.411536 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m01:37:19.412844 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities"
[0m01:37:19.412994 [debug] [Thread-1 (]: On model.data_takehome.activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities"} */
alter view "data_takehome"."main"."activities__dbt_tmp" rename to "activities"
[0m01:37:19.413172 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m01:37:19.413316 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m01:37:19.414532 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients"
[0m01:37:19.422220 [debug] [Thread-1 (]: On model.data_takehome.activities: COMMIT
[0m01:37:19.422394 [debug] [Thread-2 (]: On model.data_takehome.patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients"} */
alter view "data_takehome"."main"."patients__dbt_tmp" rename to "patients"
[0m01:37:19.422558 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities"
[0m01:37:19.422722 [debug] [Thread-1 (]: On model.data_takehome.activities: COMMIT
[0m01:37:19.422904 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m01:37:19.423588 [debug] [Thread-2 (]: On model.data_takehome.patients: COMMIT
[0m01:37:19.423737 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients"
[0m01:37:19.423867 [debug] [Thread-2 (]: On model.data_takehome.patients: COMMIT
[0m01:37:19.424024 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:37:19.427023 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities"
[0m01:37:19.427198 [debug] [Thread-1 (]: On model.data_takehome.activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities"} */
drop view if exists "data_takehome"."main"."activities__dbt_backup" cascade
[0m01:37:19.427369 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m01:37:19.428369 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients"
[0m01:37:19.428512 [debug] [Thread-2 (]: On model.data_takehome.patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients"} */
drop view if exists "data_takehome"."main"."patients__dbt_backup" cascade
[0m01:37:19.428759 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m01:37:19.429971 [debug] [Thread-1 (]: On model.data_takehome.activities: Close
[0m01:37:19.430642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4747cc49-1709-4915-a465-dbc97b297a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a289b0>]}
[0m01:37:19.430932 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main.activities ............................... [[32mOK[0m in 0.05s]
[0m01:37:19.431215 [debug] [Thread-1 (]: Finished running node model.data_takehome.activities
[0m01:37:19.431375 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m01:37:19.432046 [debug] [Thread-2 (]: On model.data_takehome.patients: Close
[0m01:37:19.434826 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4747cc49-1709-4915-a465-dbc97b297a73', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e799d0>]}
[0m01:37:19.435093 [info ] [Thread-2 (]: 2 of 2 OK created sql view model main.patients ................................. [[32mOK[0m in 0.06s]
[0m01:37:19.435338 [debug] [Thread-2 (]: Finished running node model.data_takehome.patients
[0m01:37:19.436205 [debug] [MainThread]: Using duckdb connection "master"
[0m01:37:19.436356 [debug] [MainThread]: On master: BEGIN
[0m01:37:19.436470 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m01:37:19.438787 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m01:37:19.438947 [debug] [MainThread]: On master: COMMIT
[0m01:37:19.439071 [debug] [MainThread]: Using duckdb connection "master"
[0m01:37:19.439180 [debug] [MainThread]: On master: COMMIT
[0m01:37:19.439311 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m01:37:19.439426 [debug] [MainThread]: On master: Close
[0m01:37:19.439850 [debug] [MainThread]: Connection 'master' was properly closed.
[0m01:37:19.439995 [debug] [MainThread]: Connection 'model.data_takehome.activities' was properly closed.
[0m01:37:19.440110 [debug] [MainThread]: Connection 'model.data_takehome.patients' was properly closed.
[0m01:37:19.440271 [info ] [MainThread]: 
[0m01:37:19.440418 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m01:37:19.440759 [debug] [MainThread]: Command end result
[0m01:37:19.453024 [info ] [MainThread]: 
[0m01:37:19.453258 [info ] [MainThread]: [32mCompleted successfully[0m
[0m01:37:19.453407 [info ] [MainThread]: 
[0m01:37:19.453556 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m01:37:19.455639 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6500742, "process_user_time": 1.010662, "process_kernel_time": 0.177977, "process_mem_max_rss": "130400256", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m01:37:19.455903 [debug] [MainThread]: Command `dbt run` succeeded at 01:37:19.455861 after 0.65 seconds
[0m01:37:19.456077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a891f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fa6f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037e5670>]}
[0m01:37:19.456239 [debug] [MainThread]: Flushing usage events
[0m12:02:14.747403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cb41d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10606c8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063696d0>]}


============================== 12:02:14.750281 | 79015b7e-f0a8-46af-a4a4-4a748094bb67 ==============================
[0m12:02:14.750281 [info ] [MainThread]: Running with dbt=1.8.1
[0m12:02:14.750612 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:02:14.913836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79015b7e-f0a8-46af-a4a4-4a748094bb67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106417020>]}
[0m12:02:14.956050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79015b7e-f0a8-46af-a4a4-4a748094bb67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054087a0>]}
[0m12:02:14.956901 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m12:02:15.019935 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m12:02:15.073850 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m12:02:15.074167 [debug] [MainThread]: Partial parsing: added file: data_takehome://models/staging/activities_from_seed.sql
[0m12:02:15.074311 [debug] [MainThread]: Partial parsing: deleted file: data_takehome://models/staging/activities.sql
[0m12:02:15.168961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79015b7e-f0a8-46af-a4a4-4a748094bb67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106907020>]}
[0m12:02:15.209619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79015b7e-f0a8-46af-a4a4-4a748094bb67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068d3020>]}
[0m12:02:15.209890 [info ] [MainThread]: Found 4 seeds, 2 models, 421 macros
[0m12:02:15.210062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79015b7e-f0a8-46af-a4a4-4a748094bb67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106900710>]}
[0m12:02:15.210823 [info ] [MainThread]: 
[0m12:02:15.211109 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:02:15.213256 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_data_takehome'
[0m12:02:15.254775 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome"
[0m12:02:15.255005 [debug] [ThreadPool]: On list_data_takehome: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m12:02:15.255147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:02:15.262074 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m12:02:15.262291 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m12:02:15.262674 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:02:15.262806 [debug] [MainThread]: Connection 'list_data_takehome' was properly closed.
[0m12:02:15.262949 [info ] [MainThread]: 
[0m12:02:15.263098 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.05 seconds (0.05s).
[0m12:02:15.263338 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/qamr/Documents/Development/suvera/data-dbt-takehome/data_takehome.duckdb": Conflicting lock is held in /Applications/DBeaver.app/Contents/MacOS/dbeaver (PID 1240) by user qamr. See also https://duckdb.org/docs/connect/concurrency
[0m12:02:15.268449 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5581218, "process_user_time": 0.903417, "process_kernel_time": 0.197313, "process_mem_max_rss": "124960768", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:02:15.268755 [debug] [MainThread]: Command `dbt run` failed at 12:02:15.268708 after 0.56 seconds
[0m12:02:15.268948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106369970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10696d820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b46ba0>]}
[0m12:02:15.269126 [debug] [MainThread]: Flushing usage events
[0m12:02:50.747946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103067fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040b18e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040b14f0>]}


============================== 12:02:50.751627 | fcb82e98-f1c4-4b9e-b255-e1e9af4e88af ==============================
[0m12:02:50.751627 [info ] [MainThread]: Running with dbt=1.8.1
[0m12:02:50.751940 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:02:50.889728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fcb82e98-f1c4-4b9e-b255-e1e9af4e88af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10406fe00>]}
[0m12:02:50.932092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fcb82e98-f1c4-4b9e-b255-e1e9af4e88af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10411cc80>]}
[0m12:02:50.932981 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m12:02:50.987058 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m12:02:51.039480 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:02:51.039710 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:02:51.055300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fcb82e98-f1c4-4b9e-b255-e1e9af4e88af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dc8bf0>]}
[0m12:02:51.094774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fcb82e98-f1c4-4b9e-b255-e1e9af4e88af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104238ce0>]}
[0m12:02:51.095048 [info ] [MainThread]: Found 4 seeds, 2 models, 421 macros
[0m12:02:51.095216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcb82e98-f1c4-4b9e-b255-e1e9af4e88af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104512720>]}
[0m12:02:51.095990 [info ] [MainThread]: 
[0m12:02:51.096284 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:02:51.098442 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_data_takehome'
[0m12:02:51.131480 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome"
[0m12:02:51.131704 [debug] [ThreadPool]: On list_data_takehome: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m12:02:51.131848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:02:51.146106 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m12:02:51.146896 [debug] [ThreadPool]: On list_data_takehome: Close
[0m12:02:51.147887 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data_takehome, now create_data_takehome_main)
[0m12:02:51.148162 [debug] [ThreadPool]: Creating schema "database: "data_takehome"
schema: "main"
"
[0m12:02:51.151907 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m12:02:51.152083 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
        select type from duckdb_databases()
        where database_name='data_takehome'
        and type='sqlite'
    
  
[0m12:02:51.152308 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:02:51.154944 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:02:51.155629 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m12:02:51.155775 [debug] [ThreadPool]: On create_data_takehome_main: BEGIN
[0m12:02:51.155924 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:02:51.156053 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m12:02:51.156172 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
    
        create schema if not exists "data_takehome"."main"
    
[0m12:02:51.156397 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:02:51.156786 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m12:02:51.156911 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m12:02:51.157023 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m12:02:51.157160 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:02:51.157284 [debug] [ThreadPool]: On create_data_takehome_main: Close
[0m12:02:51.158264 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_data_takehome_main, now list_data_takehome_main)
[0m12:02:51.160867 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m12:02:51.161019 [debug] [ThreadPool]: On list_data_takehome_main: BEGIN
[0m12:02:51.161140 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:02:51.163348 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:02:51.163498 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m12:02:51.163631 [debug] [ThreadPool]: On list_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome_main"} */
select
      'data_takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'data_takehome'
  
[0m12:02:51.174707 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m12:02:51.177312 [debug] [ThreadPool]: On list_data_takehome_main: ROLLBACK
[0m12:02:51.178223 [debug] [ThreadPool]: Failed to rollback 'list_data_takehome_main'
[0m12:02:51.178427 [debug] [ThreadPool]: On list_data_takehome_main: Close
[0m12:02:51.179605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcb82e98-f1c4-4b9e-b255-e1e9af4e88af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041ad1c0>]}
[0m12:02:51.179844 [debug] [MainThread]: Using duckdb connection "master"
[0m12:02:51.179980 [debug] [MainThread]: On master: BEGIN
[0m12:02:51.180103 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:02:51.182426 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m12:02:51.182590 [debug] [MainThread]: On master: COMMIT
[0m12:02:51.182727 [debug] [MainThread]: Using duckdb connection "master"
[0m12:02:51.182850 [debug] [MainThread]: On master: COMMIT
[0m12:02:51.183006 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:02:51.183134 [debug] [MainThread]: On master: Close
[0m12:02:51.183592 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m12:02:51.183743 [info ] [MainThread]: 
[0m12:02:51.186078 [debug] [Thread-1 (]: Began running node model.data_takehome.activities_from_seed
[0m12:02:51.186309 [debug] [Thread-2 (]: Began running node model.data_takehome.patients
[0m12:02:51.186562 [info ] [Thread-1 (]: 1 of 2 START sql view model main.activities_from_seed .......................... [RUN]
[0m12:02:51.186843 [info ] [Thread-2 (]: 2 of 2 START sql view model main.patients ...................................... [RUN]
[0m12:02:51.187377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_takehome_main, now model.data_takehome.activities_from_seed)
[0m12:02:51.187718 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.data_takehome.patients'
[0m12:02:51.187956 [debug] [Thread-1 (]: Began compiling node model.data_takehome.activities_from_seed
[0m12:02:51.188124 [debug] [Thread-2 (]: Began compiling node model.data_takehome.patients
[0m12:02:51.191810 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_takehome.activities_from_seed"
[0m12:02:51.193139 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_takehome.patients"
[0m12:02:51.193624 [debug] [Thread-1 (]: Began executing node model.data_takehome.activities_from_seed
[0m12:02:51.193794 [debug] [Thread-2 (]: Began executing node model.data_takehome.patients
[0m12:02:51.211371 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_takehome.patients"
[0m12:02:51.211842 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_takehome.activities_from_seed"
[0m12:02:51.212303 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:02:51.212476 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: BEGIN
[0m12:02:51.212625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:02:51.215120 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:02:51.215340 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:02:51.215521 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities_from_seed"} */

  
  create view "data_takehome"."main"."activities_from_seed__dbt_tmp" as (
    with activities as (
select * from "data_takehome"."main"."raw_activities" )

select * from activities
  );

[0m12:02:51.215698 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients"
[0m12:02:51.215877 [debug] [Thread-2 (]: On model.data_takehome.patients: BEGIN
[0m12:02:51.216023 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:02:51.216175 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:51.219256 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:02:51.219438 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities_from_seed"} */
alter view "data_takehome"."main"."activities_from_seed__dbt_tmp" rename to "activities_from_seed"
[0m12:02:51.219605 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m12:02:51.219748 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients"
[0m12:02:51.219894 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:51.220060 [debug] [Thread-2 (]: On model.data_takehome.patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients"} */

  
  create view "data_takehome"."main"."patients__dbt_tmp" as (
    WITH patients AS (
  SELECT 
    json_extract_string(data, '$.patient_id') AS patient_id,
    json_extract_string(data, '$.practice_id') AS practice_id,
    json_extract_string(data, '$.age') AS age,
    json_extract_string(data, '$.gender') AS gender,
    json_extract_string(data, '$.registration_date') AS registration_date,
    json_extract_string(data, '$.conditions') AS conditions,
    json_extract_string(data, '$.contact.email') AS email,
    json_extract_string(data, '$.contact.phone') AS phone
  FROM "data_takehome"."main"."raw_patients"
  --WHERE data IS NOT NULL
)

-- Create the final normalized table
SELECT 
  patient_id,
  practice_id,
  age,
  gender,
  registration_date,
  conditions,
  email,
  phone
FROM patients
--WHERE patient_id IS NOT NULL;
  );

[0m12:02:51.226978 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: COMMIT
[0m12:02:51.227193 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:02:51.227342 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: COMMIT
[0m12:02:51.227626 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m12:02:51.227795 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:02:51.229193 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients"
[0m12:02:51.231414 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:02:51.231601 [debug] [Thread-2 (]: On model.data_takehome.patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients"} */
alter view "data_takehome"."main"."patients" rename to "patients__dbt_backup"
[0m12:02:51.231772 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities_from_seed"} */
drop view if exists "data_takehome"."main"."activities_from_seed__dbt_backup" cascade
[0m12:02:51.232030 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m12:02:51.233378 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients"
[0m12:02:51.233533 [debug] [Thread-2 (]: On model.data_takehome.patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients"} */
alter view "data_takehome"."main"."patients__dbt_tmp" rename to "patients"
[0m12:02:51.233681 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:02:51.234819 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: Close
[0m12:02:51.235458 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcb82e98-f1c4-4b9e-b255-e1e9af4e88af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a97890>]}
[0m12:02:51.235887 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m12:02:51.235748 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main.activities_from_seed ..................... [[32mOK[0m in 0.05s]
[0m12:02:51.237783 [debug] [Thread-2 (]: On model.data_takehome.patients: COMMIT
[0m12:02:51.238078 [debug] [Thread-1 (]: Finished running node model.data_takehome.activities_from_seed
[0m12:02:51.238246 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients"
[0m12:02:51.238487 [debug] [Thread-2 (]: On model.data_takehome.patients: COMMIT
[0m12:02:51.238843 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m12:02:51.239998 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients"
[0m12:02:51.240149 [debug] [Thread-2 (]: On model.data_takehome.patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients"} */
drop view if exists "data_takehome"."main"."patients__dbt_backup" cascade
[0m12:02:51.240391 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m12:02:51.240996 [debug] [Thread-2 (]: On model.data_takehome.patients: Close
[0m12:02:51.242710 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcb82e98-f1c4-4b9e-b255-e1e9af4e88af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048f9520>]}
[0m12:02:51.242975 [info ] [Thread-2 (]: 2 of 2 OK created sql view model main.patients ................................. [[32mOK[0m in 0.06s]
[0m12:02:51.243221 [debug] [Thread-2 (]: Finished running node model.data_takehome.patients
[0m12:02:51.244178 [debug] [MainThread]: Using duckdb connection "master"
[0m12:02:51.244343 [debug] [MainThread]: On master: BEGIN
[0m12:02:51.244461 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:02:51.246850 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m12:02:51.247010 [debug] [MainThread]: On master: COMMIT
[0m12:02:51.247143 [debug] [MainThread]: Using duckdb connection "master"
[0m12:02:51.247266 [debug] [MainThread]: On master: COMMIT
[0m12:02:51.247420 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:02:51.247543 [debug] [MainThread]: On master: Close
[0m12:02:51.247992 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:02:51.248145 [debug] [MainThread]: Connection 'model.data_takehome.activities_from_seed' was properly closed.
[0m12:02:51.248262 [debug] [MainThread]: Connection 'model.data_takehome.patients' was properly closed.
[0m12:02:51.248432 [info ] [MainThread]: 
[0m12:02:51.248580 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m12:02:51.248930 [debug] [MainThread]: Command end result
[0m12:02:51.262157 [info ] [MainThread]: 
[0m12:02:51.262408 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:02:51.262555 [info ] [MainThread]: 
[0m12:02:51.262712 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:02:51.264698 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5482838, "process_user_time": 0.924887, "process_kernel_time": 0.184758, "process_mem_max_rss": "127959040", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:02:51.264971 [debug] [MainThread]: Command `dbt run` succeeded at 12:02:51.264927 after 0.55 seconds
[0m12:02:51.265153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103df5670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104733320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103067fb0>]}
[0m12:02:51.265317 [debug] [MainThread]: Flushing usage events
[0m12:04:00.548890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c79460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f35940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f35550>]}


============================== 12:04:00.551771 | a4488b78-2ebc-46a9-b274-d41594ec2714 ==============================
[0m12:04:00.551771 [info ] [MainThread]: Running with dbt=1.8.1
[0m12:04:00.552083 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:04:00.700623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a4488b78-2ebc-46a9-b274-d41594ec2714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f0ef60>]}
[0m12:04:00.742871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a4488b78-2ebc-46a9-b274-d41594ec2714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10255cf80>]}
[0m12:04:00.743625 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m12:04:00.796863 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m12:04:00.849513 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m12:04:00.849816 [debug] [MainThread]: Partial parsing: added file: data_takehome://models/staging/patients_from_seed.sql
[0m12:04:00.849956 [debug] [MainThread]: Partial parsing: deleted file: data_takehome://models/staging/patients.sql
[0m12:04:00.945305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4488b78-2ebc-46a9-b274-d41594ec2714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044cb380>]}
[0m12:04:00.983709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4488b78-2ebc-46a9-b274-d41594ec2714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104499190>]}
[0m12:04:00.983983 [info ] [MainThread]: Found 4 seeds, 2 models, 421 macros
[0m12:04:00.984156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4488b78-2ebc-46a9-b274-d41594ec2714', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044a0710>]}
[0m12:04:00.984918 [info ] [MainThread]: 
[0m12:04:00.985217 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:04:00.987386 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_data_takehome'
[0m12:04:01.018762 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome"
[0m12:04:01.018986 [debug] [ThreadPool]: On list_data_takehome: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m12:04:01.019126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:04:01.025751 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m12:04:01.025960 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m12:04:01.026321 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:04:01.026453 [debug] [MainThread]: Connection 'list_data_takehome' was properly closed.
[0m12:04:01.026584 [info ] [MainThread]: 
[0m12:04:01.026735 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m12:04:01.026967 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/qamr/Documents/Development/suvera/data-dbt-takehome/data_takehome.duckdb": Conflicting lock is held in /Applications/DBeaver.app/Contents/MacOS/dbeaver (PID 1510) by user qamr. See also https://duckdb.org/docs/connect/concurrency
[0m12:04:01.029040 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.51113, "process_user_time": 0.89432, "process_kernel_time": 0.175637, "process_mem_max_rss": "123174912", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:04:01.029439 [debug] [MainThread]: Command `dbt run` failed at 12:04:01.029384 after 0.51 seconds
[0m12:04:01.029714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f35910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045370e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044a38f0>]}
[0m12:04:01.029946 [debug] [MainThread]: Flushing usage events
[0m12:04:47.600932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b043b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b044a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106565430>]}


============================== 12:04:47.603765 | fd7e2ced-735b-49af-9d98-c1b1839bbbb1 ==============================
[0m12:04:47.603765 [info ] [MainThread]: Running with dbt=1.8.1
[0m12:04:47.604077 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:04:47.741687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd7e2ced-735b-49af-9d98-c1b1839bbbb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fe5d60>]}
[0m12:04:47.783690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd7e2ced-735b-49af-9d98-c1b1839bbbb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060ad7f0>]}
[0m12:04:47.785135 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m12:04:47.838558 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m12:04:47.891023 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:04:47.891242 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:04:47.906955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd7e2ced-735b-49af-9d98-c1b1839bbbb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062ad4c0>]}
[0m12:04:47.946361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd7e2ced-735b-49af-9d98-c1b1839bbbb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106526960>]}
[0m12:04:47.946649 [info ] [MainThread]: Found 4 seeds, 2 models, 421 macros
[0m12:04:47.946822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd7e2ced-735b-49af-9d98-c1b1839bbbb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106862540>]}
[0m12:04:47.947594 [info ] [MainThread]: 
[0m12:04:47.947913 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:04:47.950076 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_data_takehome'
[0m12:04:47.981688 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome"
[0m12:04:47.981915 [debug] [ThreadPool]: On list_data_takehome: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m12:04:47.982055 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:04:47.992053 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m12:04:47.992822 [debug] [ThreadPool]: On list_data_takehome: Close
[0m12:04:47.993814 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data_takehome, now create_data_takehome_main)
[0m12:04:47.994029 [debug] [ThreadPool]: Creating schema "database: "data_takehome"
schema: "main"
"
[0m12:04:47.997284 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m12:04:47.997449 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
        select type from duckdb_databases()
        where database_name='data_takehome'
        and type='sqlite'
    
  
[0m12:04:47.997582 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:04:48.000150 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:04:48.000807 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m12:04:48.000947 [debug] [ThreadPool]: On create_data_takehome_main: BEGIN
[0m12:04:48.001093 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:04:48.001209 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m12:04:48.001327 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
    
        create schema if not exists "data_takehome"."main"
    
[0m12:04:48.001548 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:04:48.001928 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m12:04:48.002056 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m12:04:48.002166 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m12:04:48.002298 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:04:48.002420 [debug] [ThreadPool]: On create_data_takehome_main: Close
[0m12:04:48.003407 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_data_takehome_main, now list_data_takehome_main)
[0m12:04:48.005950 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m12:04:48.006095 [debug] [ThreadPool]: On list_data_takehome_main: BEGIN
[0m12:04:48.006212 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:04:48.008368 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:04:48.008520 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m12:04:48.008650 [debug] [ThreadPool]: On list_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome_main"} */
select
      'data_takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'data_takehome'
  
[0m12:04:48.019993 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m12:04:48.022532 [debug] [ThreadPool]: On list_data_takehome_main: ROLLBACK
[0m12:04:48.023506 [debug] [ThreadPool]: Failed to rollback 'list_data_takehome_main'
[0m12:04:48.023661 [debug] [ThreadPool]: On list_data_takehome_main: Close
[0m12:04:48.024868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd7e2ced-735b-49af-9d98-c1b1839bbbb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106612bd0>]}
[0m12:04:48.025086 [debug] [MainThread]: Using duckdb connection "master"
[0m12:04:48.025217 [debug] [MainThread]: On master: BEGIN
[0m12:04:48.025333 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:04:48.027535 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m12:04:48.027703 [debug] [MainThread]: On master: COMMIT
[0m12:04:48.027836 [debug] [MainThread]: Using duckdb connection "master"
[0m12:04:48.027953 [debug] [MainThread]: On master: COMMIT
[0m12:04:48.028102 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:04:48.028226 [debug] [MainThread]: On master: Close
[0m12:04:48.028653 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m12:04:48.028822 [info ] [MainThread]: 
[0m12:04:48.030922 [debug] [Thread-1 (]: Began running node model.data_takehome.activities_from_seed
[0m12:04:48.031138 [debug] [Thread-2 (]: Began running node model.data_takehome.patients_from_seed
[0m12:04:48.031405 [info ] [Thread-1 (]: 1 of 2 START sql view model main.activities_from_seed .......................... [RUN]
[0m12:04:48.031604 [info ] [Thread-2 (]: 2 of 2 START sql view model main.patients_from_seed ............................ [RUN]
[0m12:04:48.031932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_takehome_main, now model.data_takehome.activities_from_seed)
[0m12:04:48.032178 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.data_takehome.patients_from_seed'
[0m12:04:48.032350 [debug] [Thread-1 (]: Began compiling node model.data_takehome.activities_from_seed
[0m12:04:48.032501 [debug] [Thread-2 (]: Began compiling node model.data_takehome.patients_from_seed
[0m12:04:48.035980 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_takehome.activities_from_seed"
[0m12:04:48.037235 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_takehome.patients_from_seed"
[0m12:04:48.037728 [debug] [Thread-1 (]: Began executing node model.data_takehome.activities_from_seed
[0m12:04:48.043932 [debug] [Thread-2 (]: Began executing node model.data_takehome.patients_from_seed
[0m12:04:48.058069 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_takehome.activities_from_seed"
[0m12:04:48.058395 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_takehome.patients_from_seed"
[0m12:04:48.058759 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:04:48.058926 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: BEGIN
[0m12:04:48.059071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:04:48.061539 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:04:48.061744 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients_from_seed"
[0m12:04:48.061908 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:04:48.062068 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: BEGIN
[0m12:04:48.062236 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities_from_seed"} */

  
  create view "data_takehome"."main"."activities_from_seed__dbt_tmp" as (
    with activities as (
select * from "data_takehome"."main"."raw_activities" )

select * from activities
  );

[0m12:04:48.062399 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:04:48.062641 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m12:04:48.062790 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients_from_seed"
[0m12:04:48.062957 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients_from_seed"} */

  
  create view "data_takehome"."main"."patients_from_seed__dbt_tmp" as (
    WITH patients AS (
  SELECT 
    json_extract_string(data, '$.patient_id') AS patient_id,
    json_extract_string(data, '$.practice_id') AS practice_id,
    json_extract_string(data, '$.age') AS age,
    json_extract_string(data, '$.gender') AS gender,
    json_extract_string(data, '$.registration_date') AS registration_date,
    json_extract_string(data, '$.conditions') AS conditions,
    json_extract_string(data, '$.contact.email') AS email,
    json_extract_string(data, '$.contact.phone') AS phone
  FROM "data_takehome"."main"."raw_patients"
  --WHERE data IS NOT NULL
)

-- Create the final normalized table
SELECT 
  patient_id,
  practice_id,
  age,
  gender,
  registration_date,
  conditions,
  email,
  phone
FROM patients
--WHERE patient_id IS NOT NULL;
  );

[0m12:04:48.063130 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:04:48.066330 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:04:48.066510 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities_from_seed"} */
alter view "data_takehome"."main"."activities_from_seed" rename to "activities_from_seed__dbt_backup"
[0m12:04:48.066745 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:04:48.066905 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m12:04:48.068165 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:04:48.069474 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients_from_seed"
[0m12:04:48.069647 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities_from_seed"} */
alter view "data_takehome"."main"."activities_from_seed__dbt_tmp" rename to "activities_from_seed"
[0m12:04:48.069812 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients_from_seed"} */
alter view "data_takehome"."main"."patients_from_seed__dbt_tmp" rename to "patients_from_seed"
[0m12:04:48.070020 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:04:48.070173 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m12:04:48.077819 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: COMMIT
[0m12:04:48.078496 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: COMMIT
[0m12:04:48.078668 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:04:48.078819 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients_from_seed"
[0m12:04:48.078961 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: COMMIT
[0m12:04:48.079097 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: COMMIT
[0m12:04:48.079580 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m12:04:48.081805 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients_from_seed"
[0m12:04:48.081979 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients_from_seed"} */
drop view if exists "data_takehome"."main"."patients_from_seed__dbt_backup" cascade
[0m12:04:48.082145 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:04:48.083171 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:04:48.083327 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities_from_seed"} */
drop view if exists "data_takehome"."main"."activities_from_seed__dbt_backup" cascade
[0m12:04:48.083483 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:04:48.084592 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: Close
[0m12:04:48.085250 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd7e2ced-735b-49af-9d98-c1b1839bbbb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f53560>]}
[0m12:04:48.085683 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:04:48.085543 [info ] [Thread-2 (]: 2 of 2 OK created sql view model main.patients_from_seed ....................... [[32mOK[0m in 0.05s]
[0m12:04:48.086345 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: Close
[0m12:04:48.086607 [debug] [Thread-2 (]: Finished running node model.data_takehome.patients_from_seed
[0m12:04:48.088861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd7e2ced-735b-49af-9d98-c1b1839bbbb1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d34e90>]}
[0m12:04:48.089453 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main.activities_from_seed ..................... [[32mOK[0m in 0.06s]
[0m12:04:48.089791 [debug] [Thread-1 (]: Finished running node model.data_takehome.activities_from_seed
[0m12:04:48.090701 [debug] [MainThread]: Using duckdb connection "master"
[0m12:04:48.090854 [debug] [MainThread]: On master: BEGIN
[0m12:04:48.090974 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:04:48.093381 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m12:04:48.093555 [debug] [MainThread]: On master: COMMIT
[0m12:04:48.093684 [debug] [MainThread]: Using duckdb connection "master"
[0m12:04:48.093800 [debug] [MainThread]: On master: COMMIT
[0m12:04:48.093940 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:04:48.094066 [debug] [MainThread]: On master: Close
[0m12:04:48.094521 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:04:48.094638 [debug] [MainThread]: Connection 'model.data_takehome.activities_from_seed' was properly closed.
[0m12:04:48.094745 [debug] [MainThread]: Connection 'model.data_takehome.patients_from_seed' was properly closed.
[0m12:04:48.094905 [info ] [MainThread]: 
[0m12:04:48.095048 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m12:04:48.095398 [debug] [MainThread]: Command end result
[0m12:04:48.108408 [info ] [MainThread]: 
[0m12:04:48.108657 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:04:48.108814 [info ] [MainThread]: 
[0m12:04:48.108971 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:04:48.110954 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5406056, "process_user_time": 0.926601, "process_kernel_time": 0.181921, "process_mem_max_rss": "126222336", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:04:48.111241 [debug] [MainThread]: Command `dbt run` succeeded at 12:04:48.111196 after 0.54 seconds
[0m12:04:48.111436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106283440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068631a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068e0cb0>]}
[0m12:04:48.111598 [debug] [MainThread]: Flushing usage events
[0m12:09:46.621718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1032f8a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063457f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106345400>]}


============================== 12:09:46.627425 | ffc43b26-7ae6-43f7-afa1-6efab4d2a99e ==============================
[0m12:09:46.627425 [info ] [MainThread]: Running with dbt=1.8.1
[0m12:09:46.627761 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:09:46.775579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ffc43b26-7ae6-43f7-afa1-6efab4d2a99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106446540>]}
[0m12:09:46.817845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ffc43b26-7ae6-43f7-afa1-6efab4d2a99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064d14f0>]}
[0m12:09:46.818656 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m12:09:46.873046 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m12:09:46.926750 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:09:46.927080 [debug] [MainThread]: Partial parsing: updated file: data_takehome://models/staging/patients_from_seed.sql
[0m12:09:47.022272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ffc43b26-7ae6-43f7-afa1-6efab4d2a99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106adaf60>]}
[0m12:09:47.062497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ffc43b26-7ae6-43f7-afa1-6efab4d2a99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aa6e70>]}
[0m12:09:47.062775 [info ] [MainThread]: Found 4 seeds, 2 models, 421 macros
[0m12:09:47.062941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffc43b26-7ae6-43f7-afa1-6efab4d2a99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10675c980>]}
[0m12:09:47.063680 [info ] [MainThread]: 
[0m12:09:47.063953 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:09:47.066052 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_data_takehome'
[0m12:09:47.106153 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome"
[0m12:09:47.106397 [debug] [ThreadPool]: On list_data_takehome: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m12:09:47.106543 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:09:47.117721 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m12:09:47.118773 [debug] [ThreadPool]: On list_data_takehome: Close
[0m12:09:47.119812 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data_takehome, now create_data_takehome_main)
[0m12:09:47.120052 [debug] [ThreadPool]: Creating schema "database: "data_takehome"
schema: "main"
"
[0m12:09:47.123328 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m12:09:47.123493 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
        select type from duckdb_databases()
        where database_name='data_takehome'
        and type='sqlite'
    
  
[0m12:09:47.123625 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:09:47.126373 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:09:47.127046 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m12:09:47.127190 [debug] [ThreadPool]: On create_data_takehome_main: BEGIN
[0m12:09:47.127339 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:09:47.127458 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m12:09:47.127579 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
    
        create schema if not exists "data_takehome"."main"
    
[0m12:09:47.128020 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:09:47.128411 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m12:09:47.128530 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m12:09:47.128641 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m12:09:47.128779 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:09:47.128900 [debug] [ThreadPool]: On create_data_takehome_main: Close
[0m12:09:47.129885 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_data_takehome_main, now list_data_takehome_main)
[0m12:09:47.132468 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m12:09:47.132617 [debug] [ThreadPool]: On list_data_takehome_main: BEGIN
[0m12:09:47.132729 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:09:47.134907 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:09:47.135066 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m12:09:47.135203 [debug] [ThreadPool]: On list_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome_main"} */
select
      'data_takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'data_takehome'
  
[0m12:09:47.147264 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m12:09:47.150044 [debug] [ThreadPool]: On list_data_takehome_main: ROLLBACK
[0m12:09:47.150989 [debug] [ThreadPool]: Failed to rollback 'list_data_takehome_main'
[0m12:09:47.151127 [debug] [ThreadPool]: On list_data_takehome_main: Close
[0m12:09:47.152368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ffc43b26-7ae6-43f7-afa1-6efab4d2a99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a1b0e0>]}
[0m12:09:47.152592 [debug] [MainThread]: Using duckdb connection "master"
[0m12:09:47.152723 [debug] [MainThread]: On master: BEGIN
[0m12:09:47.152837 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:09:47.155070 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m12:09:47.155238 [debug] [MainThread]: On master: COMMIT
[0m12:09:47.155369 [debug] [MainThread]: Using duckdb connection "master"
[0m12:09:47.155494 [debug] [MainThread]: On master: COMMIT
[0m12:09:47.155643 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:09:47.155768 [debug] [MainThread]: On master: Close
[0m12:09:47.156213 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m12:09:47.156416 [info ] [MainThread]: 
[0m12:09:47.159513 [debug] [Thread-1 (]: Began running node model.data_takehome.activities_from_seed
[0m12:09:47.159726 [debug] [Thread-2 (]: Began running node model.data_takehome.patients_from_seed
[0m12:09:47.159983 [info ] [Thread-1 (]: 1 of 2 START sql view model main.activities_from_seed .......................... [RUN]
[0m12:09:47.160259 [info ] [Thread-2 (]: 2 of 2 START sql view model main.patients_from_seed ............................ [RUN]
[0m12:09:47.160542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_takehome_main, now model.data_takehome.activities_from_seed)
[0m12:09:47.160794 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.data_takehome.patients_from_seed'
[0m12:09:47.160978 [debug] [Thread-1 (]: Began compiling node model.data_takehome.activities_from_seed
[0m12:09:47.161152 [debug] [Thread-2 (]: Began compiling node model.data_takehome.patients_from_seed
[0m12:09:47.164578 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_takehome.activities_from_seed"
[0m12:09:47.165872 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_takehome.patients_from_seed"
[0m12:09:47.166528 [debug] [Thread-2 (]: Began executing node model.data_takehome.patients_from_seed
[0m12:09:47.166697 [debug] [Thread-1 (]: Began executing node model.data_takehome.activities_from_seed
[0m12:09:47.183205 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_takehome.activities_from_seed"
[0m12:09:47.183560 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_takehome.patients_from_seed"
[0m12:09:47.184284 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients_from_seed"
[0m12:09:47.184448 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: BEGIN
[0m12:09:47.184588 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:09:47.187023 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:09:47.187210 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m12:09:47.187379 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: BEGIN
[0m12:09:47.187536 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients_from_seed"
[0m12:09:47.187681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:09:47.187850 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients_from_seed"} */

  
  create view "data_takehome"."main"."patients_from_seed__dbt_tmp" as (
    WITH patients AS (
  SELECT 
    json_extract_string(data, '$.patient_id') AS patient_id,
    json_extract_string(data, '$.practice_id') AS practice_id,
    json_extract_string(data, '$.age') AS age,
    json_extract_string(data, '$.gender') AS gender,
    json_extract_string(data, '$.registration_date') AS registration_date,
    regexp_replace(json_extract_string(data, '$.registration_date'), '[()]', '', 'g') AS registration_date2,
    json_extract_string(data, '$.conditions') AS conditions,
    json_extract_string(data, '$.contact.email') AS email,
    json_extract_string(data, '$.contact.phone') AS phone
  FROM "data_takehome"."main"."raw_patients"
  --WHERE data IS NOT NULL
)

-- Create the final normalized table
SELECT 
  patient_id,
  practice_id,
  age,
  gender,
  registration_date,
  conditions,
  email,
  phone
FROM patients
--WHERE patient_id IS NOT NULL;
  );

[0m12:09:47.188076 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:09:47.188219 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:09:47.188368 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities_from_seed"} */

  
  create view "data_takehome"."main"."activities_from_seed__dbt_tmp" as (
    with activities as (
select * from "data_takehome"."main"."raw_activities" )

select * from activities
  );

[0m12:09:47.188533 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m12:09:47.191628 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients_from_seed"
[0m12:09:47.191813 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients_from_seed"} */
alter view "data_takehome"."main"."patients_from_seed" rename to "patients_from_seed__dbt_backup"
[0m12:09:47.191979 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:09:47.193320 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:09:47.193477 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities_from_seed"} */
alter view "data_takehome"."main"."activities_from_seed" rename to "activities_from_seed__dbt_backup"
[0m12:09:47.193646 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m12:09:47.194909 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients_from_seed"
[0m12:09:47.195069 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients_from_seed"} */
alter view "data_takehome"."main"."patients_from_seed__dbt_tmp" rename to "patients_from_seed"
[0m12:09:47.195269 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:09:47.196501 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:09:47.196653 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities_from_seed"} */
alter view "data_takehome"."main"."activities_from_seed__dbt_tmp" rename to "activities_from_seed"
[0m12:09:47.196825 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m12:09:47.204655 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: COMMIT
[0m12:09:47.204852 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients_from_seed"
[0m12:09:47.204999 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: COMMIT
[0m12:09:47.205167 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m12:09:47.205868 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: COMMIT
[0m12:09:47.206022 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:09:47.206164 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: COMMIT
[0m12:09:47.206881 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:09:47.210081 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:09:47.210258 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities_from_seed"} */
drop view if exists "data_takehome"."main"."activities_from_seed__dbt_backup" cascade
[0m12:09:47.210430 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m12:09:47.211458 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients_from_seed"
[0m12:09:47.211614 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients_from_seed"} */
drop view if exists "data_takehome"."main"."patients_from_seed__dbt_backup" cascade
[0m12:09:47.211822 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:09:47.212924 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: Close
[0m12:09:47.213577 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffc43b26-7ae6-43f7-afa1-6efab4d2a99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ea3350>]}
[0m12:09:47.213757 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m12:09:47.214635 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: Close
[0m12:09:47.214036 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main.activities_from_seed ..................... [[32mOK[0m in 0.05s]
[0m12:09:47.217879 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ffc43b26-7ae6-43f7-afa1-6efab4d2a99e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107129790>]}
[0m12:09:47.218189 [debug] [Thread-1 (]: Finished running node model.data_takehome.activities_from_seed
[0m12:09:47.218476 [info ] [Thread-2 (]: 2 of 2 OK created sql view model main.patients_from_seed ....................... [[32mOK[0m in 0.06s]
[0m12:09:47.218852 [debug] [Thread-2 (]: Finished running node model.data_takehome.patients_from_seed
[0m12:09:47.219706 [debug] [MainThread]: Using duckdb connection "master"
[0m12:09:47.219856 [debug] [MainThread]: On master: BEGIN
[0m12:09:47.219974 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:09:47.222378 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m12:09:47.222552 [debug] [MainThread]: On master: COMMIT
[0m12:09:47.222678 [debug] [MainThread]: Using duckdb connection "master"
[0m12:09:47.222788 [debug] [MainThread]: On master: COMMIT
[0m12:09:47.222919 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:09:47.223041 [debug] [MainThread]: On master: Close
[0m12:09:47.223504 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:09:47.223650 [debug] [MainThread]: Connection 'model.data_takehome.activities_from_seed' was properly closed.
[0m12:09:47.223764 [debug] [MainThread]: Connection 'model.data_takehome.patients_from_seed' was properly closed.
[0m12:09:47.223928 [info ] [MainThread]: 
[0m12:09:47.224069 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m12:09:47.224417 [debug] [MainThread]: Command end result
[0m12:09:47.237387 [info ] [MainThread]: 
[0m12:09:47.237609 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:09:47.237746 [info ] [MainThread]: 
[0m12:09:47.237894 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:09:47.239859 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6516029, "process_user_time": 0.997003, "process_kernel_time": 0.195184, "process_mem_max_rss": "131284992", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:09:47.240128 [debug] [MainThread]: Command `dbt run` succeeded at 12:09:47.240084 after 0.65 seconds
[0m12:09:47.240311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063452e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10646fcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fdcad0>]}
[0m12:09:47.240477 [debug] [MainThread]: Flushing usage events
[0m12:11:35.778974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e5b860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036e62a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041414f0>]}


============================== 12:11:35.781950 | 048d5451-ff39-411a-af76-5f03f844b8c0 ==============================
[0m12:11:35.781950 [info ] [MainThread]: Running with dbt=1.8.1
[0m12:11:35.782269 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:11:35.934767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '048d5451-ff39-411a-af76-5f03f844b8c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041acfe0>]}
[0m12:11:35.977451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '048d5451-ff39-411a-af76-5f03f844b8c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103551e20>]}
[0m12:11:35.978917 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m12:11:36.033382 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m12:11:36.086985 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:11:36.087316 [debug] [MainThread]: Partial parsing: updated file: data_takehome://models/staging/patients_from_seed.sql
[0m12:11:36.182796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '048d5451-ff39-411a-af76-5f03f844b8c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046dae10>]}
[0m12:11:36.223551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '048d5451-ff39-411a-af76-5f03f844b8c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046aae40>]}
[0m12:11:36.223834 [info ] [MainThread]: Found 4 seeds, 2 models, 421 macros
[0m12:11:36.224001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '048d5451-ff39-411a-af76-5f03f844b8c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046b74d0>]}
[0m12:11:36.224787 [info ] [MainThread]: 
[0m12:11:36.225087 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:11:36.227303 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_data_takehome'
[0m12:11:36.258059 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome"
[0m12:11:36.258280 [debug] [ThreadPool]: On list_data_takehome: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m12:11:36.258419 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:36.265891 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m12:11:36.266087 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m12:11:36.266445 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:11:36.266573 [debug] [MainThread]: Connection 'list_data_takehome' was properly closed.
[0m12:11:36.266704 [info ] [MainThread]: 
[0m12:11:36.266855 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m12:11:36.267070 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/qamr/Documents/Development/suvera/data-dbt-takehome/data_takehome.duckdb": Conflicting lock is held in /opt/homebrew/Cellar/duckdb/1.1.1/bin/duckdb (PID 1634) by user qamr. See also https://duckdb.org/docs/connect/concurrency
[0m12:11:36.269012 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.52181304, "process_user_time": 0.901643, "process_kernel_time": 0.169225, "process_mem_max_rss": "123518976", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:11:36.269294 [debug] [MainThread]: Command `dbt run` failed at 12:11:36.269245 after 0.52 seconds
[0m12:11:36.269473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e89670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046b7fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a714f0>]}
[0m12:11:36.269639 [debug] [MainThread]: Flushing usage events
[0m12:11:44.448728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046d0ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10487d880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10487d490>]}


============================== 12:11:44.451618 | 011fe22c-afc0-407f-9669-6bf95698dddf ==============================
[0m12:11:44.451618 [info ] [MainThread]: Running with dbt=1.8.1
[0m12:11:44.451938 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:11:44.544105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '011fe22c-afc0-407f-9669-6bf95698dddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048ded20>]}
[0m12:11:44.587235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '011fe22c-afc0-407f-9669-6bf95698dddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10231d400>]}
[0m12:11:44.588593 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m12:11:44.641055 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m12:11:44.693377 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:11:44.693641 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:11:44.709574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '011fe22c-afc0-407f-9669-6bf95698dddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10483cbc0>]}
[0m12:11:44.748931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '011fe22c-afc0-407f-9669-6bf95698dddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104958aa0>]}
[0m12:11:44.749209 [info ] [MainThread]: Found 4 seeds, 2 models, 421 macros
[0m12:11:44.749381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '011fe22c-afc0-407f-9669-6bf95698dddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d66270>]}
[0m12:11:44.750158 [info ] [MainThread]: 
[0m12:11:44.750439 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:11:44.752577 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_data_takehome'
[0m12:11:44.783756 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome"
[0m12:11:44.783991 [debug] [ThreadPool]: On list_data_takehome: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m12:11:44.784184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:44.802471 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m12:11:44.803729 [debug] [ThreadPool]: On list_data_takehome: Close
[0m12:11:44.804686 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data_takehome, now create_data_takehome_main)
[0m12:11:44.804930 [debug] [ThreadPool]: Creating schema "database: "data_takehome"
schema: "main"
"
[0m12:11:44.808183 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m12:11:44.808365 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
        select type from duckdb_databases()
        where database_name='data_takehome'
        and type='sqlite'
    
  
[0m12:11:44.808496 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:11:44.811276 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:11:44.811890 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m12:11:44.812029 [debug] [ThreadPool]: On create_data_takehome_main: BEGIN
[0m12:11:44.812180 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:11:44.812298 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m12:11:44.812423 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
    
        create schema if not exists "data_takehome"."main"
    
[0m12:11:44.813291 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:11:44.813670 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m12:11:44.813792 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m12:11:44.813902 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m12:11:44.814042 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:11:44.814166 [debug] [ThreadPool]: On create_data_takehome_main: Close
[0m12:11:44.815133 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_data_takehome_main, now list_data_takehome_main)
[0m12:11:44.817694 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m12:11:44.817843 [debug] [ThreadPool]: On list_data_takehome_main: BEGIN
[0m12:11:44.817958 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:11:44.820219 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:11:44.820376 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m12:11:44.820514 [debug] [ThreadPool]: On list_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome_main"} */
select
      'data_takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'data_takehome'
  
[0m12:11:44.834023 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m12:11:44.837118 [debug] [ThreadPool]: On list_data_takehome_main: ROLLBACK
[0m12:11:44.838546 [debug] [ThreadPool]: Failed to rollback 'list_data_takehome_main'
[0m12:11:44.838717 [debug] [ThreadPool]: On list_data_takehome_main: Close
[0m12:11:44.839990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '011fe22c-afc0-407f-9669-6bf95698dddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046d2bd0>]}
[0m12:11:44.840226 [debug] [MainThread]: Using duckdb connection "master"
[0m12:11:44.840363 [debug] [MainThread]: On master: BEGIN
[0m12:11:44.840481 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:11:44.842744 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m12:11:44.842906 [debug] [MainThread]: On master: COMMIT
[0m12:11:44.843040 [debug] [MainThread]: Using duckdb connection "master"
[0m12:11:44.843162 [debug] [MainThread]: On master: COMMIT
[0m12:11:44.843299 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:11:44.843426 [debug] [MainThread]: On master: Close
[0m12:11:44.843875 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m12:11:44.844046 [info ] [MainThread]: 
[0m12:11:44.846134 [debug] [Thread-1 (]: Began running node model.data_takehome.activities_from_seed
[0m12:11:44.846351 [debug] [Thread-2 (]: Began running node model.data_takehome.patients_from_seed
[0m12:11:44.846648 [info ] [Thread-1 (]: 1 of 2 START sql view model main.activities_from_seed .......................... [RUN]
[0m12:11:44.846910 [info ] [Thread-2 (]: 2 of 2 START sql view model main.patients_from_seed ............................ [RUN]
[0m12:11:44.847137 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_takehome_main, now model.data_takehome.activities_from_seed)
[0m12:11:44.847405 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.data_takehome.patients_from_seed'
[0m12:11:44.847595 [debug] [Thread-1 (]: Began compiling node model.data_takehome.activities_from_seed
[0m12:11:44.847760 [debug] [Thread-2 (]: Began compiling node model.data_takehome.patients_from_seed
[0m12:11:44.851234 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_takehome.activities_from_seed"
[0m12:11:44.852519 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_takehome.patients_from_seed"
[0m12:11:44.853033 [debug] [Thread-2 (]: Began executing node model.data_takehome.patients_from_seed
[0m12:11:44.853200 [debug] [Thread-1 (]: Began executing node model.data_takehome.activities_from_seed
[0m12:11:44.869219 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_takehome.patients_from_seed"
[0m12:11:44.870782 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_takehome.activities_from_seed"
[0m12:11:44.871281 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:11:44.871485 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients_from_seed"
[0m12:11:44.871645 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: BEGIN
[0m12:11:44.871810 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: BEGIN
[0m12:11:44.871971 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:44.872114 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:11:44.874553 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:11:44.874782 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:11:44.874943 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m12:11:44.875097 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities_from_seed"} */

  
  create view "data_takehome"."main"."activities_from_seed__dbt_tmp" as (
    with activities as (
select * from "data_takehome"."main"."raw_activities" )

select * from activities
  );

[0m12:11:44.875252 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients_from_seed"
[0m12:11:44.875434 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients_from_seed"} */

  
  create view "data_takehome"."main"."patients_from_seed__dbt_tmp" as (
    WITH patients AS (
  SELECT 
    json_extract_string(data, '$.patient_id') AS patient_id,
    json_extract_string(data, '$.practice_id') AS practice_id,
    json_extract_string(data, '$.age') AS age,
    json_extract_string(data, '$.gender') AS gender,
    json_extract_string(data, '$.registration_date') AS registration_date,
    json_extract_string(data, '$.conditions') AS conditions,
    regexp_replace(json_extract_string(data, '$.conditions'), '[()]', '', 'g') AS conditions2,
    json_extract_string(data, '$.contact.email') AS email,
    json_extract_string(data, '$.contact.phone') AS phone
  FROM "data_takehome"."main"."raw_patients"
  --WHERE data IS NOT NULL
)

-- Create the final normalized table
SELECT 
  patient_id,
  practice_id,
  age,
  gender,
  registration_date,
  conditions,
  conditions2,
  email,
  phone
FROM patients
--WHERE patient_id IS NOT NULL;
  );

[0m12:11:44.875743 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:11:44.878786 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:11:44.878972 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities_from_seed"} */
alter view "data_takehome"."main"."activities_from_seed" rename to "activities_from_seed__dbt_backup"
[0m12:11:44.879202 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m12:11:44.880830 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients_from_seed"
[0m12:11:44.881006 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients_from_seed"} */
alter view "data_takehome"."main"."patients_from_seed" rename to "patients_from_seed__dbt_backup"
[0m12:11:44.881208 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:11:44.881371 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m12:11:44.882700 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:11:44.883960 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients_from_seed"
[0m12:11:44.884135 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities_from_seed"} */
alter view "data_takehome"."main"."activities_from_seed__dbt_tmp" rename to "activities_from_seed"
[0m12:11:44.884304 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients_from_seed"} */
alter view "data_takehome"."main"."patients_from_seed__dbt_tmp" rename to "patients_from_seed"
[0m12:11:44.884526 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:11:44.884672 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m12:11:44.892549 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: COMMIT
[0m12:11:44.893277 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: COMMIT
[0m12:11:44.893447 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:11:44.893606 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients_from_seed"
[0m12:11:44.893750 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: COMMIT
[0m12:11:44.893884 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: COMMIT
[0m12:11:44.894775 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:11:44.897074 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:11:44.897261 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities_from_seed"} */
drop view if exists "data_takehome"."main"."activities_from_seed__dbt_backup" cascade
[0m12:11:44.897452 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m12:11:44.898470 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients_from_seed"
[0m12:11:44.898632 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients_from_seed"} */
drop view if exists "data_takehome"."main"."patients_from_seed__dbt_backup" cascade
[0m12:11:44.898892 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:11:44.900042 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: Close
[0m12:11:44.900487 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m12:11:44.900825 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '011fe22c-afc0-407f-9669-6bf95698dddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f5b5f0>]}
[0m12:11:44.901425 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: Close
[0m12:11:44.901704 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main.activities_from_seed ..................... [[32mOK[0m in 0.05s]
[0m12:11:44.904945 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '011fe22c-afc0-407f-9669-6bf95698dddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053d5c10>]}
[0m12:11:44.905234 [debug] [Thread-1 (]: Finished running node model.data_takehome.activities_from_seed
[0m12:11:44.905528 [info ] [Thread-2 (]: 2 of 2 OK created sql view model main.patients_from_seed ....................... [[32mOK[0m in 0.06s]
[0m12:11:44.905897 [debug] [Thread-2 (]: Finished running node model.data_takehome.patients_from_seed
[0m12:11:44.906760 [debug] [MainThread]: Using duckdb connection "master"
[0m12:11:44.906912 [debug] [MainThread]: On master: BEGIN
[0m12:11:44.907032 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:11:44.909412 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m12:11:44.909579 [debug] [MainThread]: On master: COMMIT
[0m12:11:44.909708 [debug] [MainThread]: Using duckdb connection "master"
[0m12:11:44.909819 [debug] [MainThread]: On master: COMMIT
[0m12:11:44.909954 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:11:44.910078 [debug] [MainThread]: On master: Close
[0m12:11:44.910555 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:11:44.910715 [debug] [MainThread]: Connection 'model.data_takehome.activities_from_seed' was properly closed.
[0m12:11:44.910835 [debug] [MainThread]: Connection 'model.data_takehome.patients_from_seed' was properly closed.
[0m12:11:44.911005 [info ] [MainThread]: 
[0m12:11:44.911154 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m12:11:44.911515 [debug] [MainThread]: Command end result
[0m12:11:44.924921 [info ] [MainThread]: 
[0m12:11:44.925165 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:11:44.925318 [info ] [MainThread]: 
[0m12:11:44.925472 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:11:44.927006 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5098752, "process_user_time": 0.931763, "process_kernel_time": 0.161543, "process_mem_max_rss": "128368640", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:11:44.927256 [debug] [MainThread]: Command `dbt run` succeeded at 12:11:44.927215 after 0.51 seconds
[0m12:11:44.927428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048a9ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10109fa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105439190>]}
[0m12:11:44.927580 [debug] [MainThread]: Flushing usage events
[0m12:12:59.168684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107401a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e99820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e99460>]}


============================== 12:12:59.171674 | 8c5668a2-11e3-49c6-afc0-9791bdc570d4 ==============================
[0m12:12:59.171674 [info ] [MainThread]: Running with dbt=1.8.1
[0m12:12:59.171988 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:12:59.324681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c5668a2-11e3-49c6-afc0-9791bdc570d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bb7c80>]}
[0m12:12:59.366506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c5668a2-11e3-49c6-afc0-9791bdc570d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108075730>]}
[0m12:12:59.367925 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m12:12:59.426938 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m12:12:59.479902 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:12:59.480228 [debug] [MainThread]: Partial parsing: updated file: data_takehome://models/staging/patients_from_seed.sql
[0m12:12:59.575235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c5668a2-11e3-49c6-afc0-9791bdc570d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108437470>]}
[0m12:12:59.615718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c5668a2-11e3-49c6-afc0-9791bdc570d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108401280>]}
[0m12:12:59.615998 [info ] [MainThread]: Found 4 seeds, 2 models, 421 macros
[0m12:12:59.616168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c5668a2-11e3-49c6-afc0-9791bdc570d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e59dc0>]}
[0m12:12:59.616934 [info ] [MainThread]: 
[0m12:12:59.617216 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:12:59.619417 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_data_takehome'
[0m12:12:59.651520 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome"
[0m12:12:59.651755 [debug] [ThreadPool]: On list_data_takehome: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m12:12:59.651904 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:12:59.665307 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m12:12:59.666553 [debug] [ThreadPool]: On list_data_takehome: Close
[0m12:12:59.667732 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data_takehome, now create_data_takehome_main)
[0m12:12:59.667943 [debug] [ThreadPool]: Creating schema "database: "data_takehome"
schema: "main"
"
[0m12:12:59.671216 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m12:12:59.671389 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
        select type from duckdb_databases()
        where database_name='data_takehome'
        and type='sqlite'
    
  
[0m12:12:59.671517 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:12:59.674226 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:12:59.674914 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m12:12:59.675061 [debug] [ThreadPool]: On create_data_takehome_main: BEGIN
[0m12:12:59.675208 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:12:59.675333 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m12:12:59.675454 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
    
        create schema if not exists "data_takehome"."main"
    
[0m12:12:59.675715 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:12:59.676104 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m12:12:59.676227 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m12:12:59.676338 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m12:12:59.676478 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:12:59.676608 [debug] [ThreadPool]: On create_data_takehome_main: Close
[0m12:12:59.677931 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_data_takehome_main, now list_data_takehome_main)
[0m12:12:59.680585 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m12:12:59.680744 [debug] [ThreadPool]: On list_data_takehome_main: BEGIN
[0m12:12:59.680873 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:12:59.683110 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:12:59.683263 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m12:12:59.683403 [debug] [ThreadPool]: On list_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome_main"} */
select
      'data_takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'data_takehome'
  
[0m12:12:59.696648 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m12:12:59.699542 [debug] [ThreadPool]: On list_data_takehome_main: ROLLBACK
[0m12:12:59.700679 [debug] [ThreadPool]: Failed to rollback 'list_data_takehome_main'
[0m12:12:59.700823 [debug] [ThreadPool]: On list_data_takehome_main: Close
[0m12:12:59.702006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c5668a2-11e3-49c6-afc0-9791bdc570d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f46b40>]}
[0m12:12:59.702262 [debug] [MainThread]: Using duckdb connection "master"
[0m12:12:59.702404 [debug] [MainThread]: On master: BEGIN
[0m12:12:59.702525 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:12:59.704880 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m12:12:59.705046 [debug] [MainThread]: On master: COMMIT
[0m12:12:59.705181 [debug] [MainThread]: Using duckdb connection "master"
[0m12:12:59.705298 [debug] [MainThread]: On master: COMMIT
[0m12:12:59.705435 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:12:59.705562 [debug] [MainThread]: On master: Close
[0m12:12:59.706038 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m12:12:59.706238 [info ] [MainThread]: 
[0m12:12:59.709124 [debug] [Thread-1 (]: Began running node model.data_takehome.activities_from_seed
[0m12:12:59.709333 [debug] [Thread-2 (]: Began running node model.data_takehome.patients_from_seed
[0m12:12:59.709583 [info ] [Thread-1 (]: 1 of 2 START sql view model main.activities_from_seed .......................... [RUN]
[0m12:12:59.710043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_takehome_main, now model.data_takehome.activities_from_seed)
[0m12:12:59.709791 [info ] [Thread-2 (]: 2 of 2 START sql view model main.patients_from_seed ............................ [RUN]
[0m12:12:59.710273 [debug] [Thread-1 (]: Began compiling node model.data_takehome.activities_from_seed
[0m12:12:59.710500 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.data_takehome.patients_from_seed'
[0m12:12:59.713971 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_takehome.activities_from_seed"
[0m12:12:59.714165 [debug] [Thread-2 (]: Began compiling node model.data_takehome.patients_from_seed
[0m12:12:59.715414 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_takehome.patients_from_seed"
[0m12:12:59.715889 [debug] [Thread-1 (]: Began executing node model.data_takehome.activities_from_seed
[0m12:12:59.716050 [debug] [Thread-2 (]: Began executing node model.data_takehome.patients_from_seed
[0m12:12:59.732699 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_takehome.patients_from_seed"
[0m12:12:59.733142 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_takehome.activities_from_seed"
[0m12:12:59.733480 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients_from_seed"
[0m12:12:59.733642 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: BEGIN
[0m12:12:59.733784 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:12:59.736138 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m12:12:59.736311 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients_from_seed"
[0m12:12:59.736489 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients_from_seed"} */

  
  create view "data_takehome"."main"."patients_from_seed__dbt_tmp" as (
    WITH patients AS (
  SELECT 
    json_extract_string(data, '$.patient_id') AS patient_id,
    json_extract_string(data, '$.practice_id') AS practice_id,
    json_extract_string(data, '$.age') AS age,
    json_extract_string(data, '$.gender') AS gender,
    json_extract_string(data, '$.registration_date') AS registration_date,
    json_extract_string(data, '$.conditions') AS conditions,
    regexp_replace(json_extract_string(data, '$.conditions'), '[[]]', '', 'g') AS conditions2,
    json_extract_string(data, '$.contact.email') AS email,
    json_extract_string(data, '$.contact.phone') AS phone
  FROM "data_takehome"."main"."raw_patients"
  --WHERE data IS NOT NULL
)

-- Create the final normalized table
SELECT 
  patient_id,
  practice_id,
  age,
  gender,
  registration_date,
  conditions,
  conditions2,
  email,
  phone
FROM patients
--WHERE patient_id IS NOT NULL;
  );

[0m12:12:59.736682 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:12:59.736858 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: BEGIN
[0m12:12:59.737000 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:12:59.737198 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:12:59.737350 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:12:59.737502 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities_from_seed"} */

  
  create view "data_takehome"."main"."activities_from_seed__dbt_tmp" as (
    with activities as (
select * from "data_takehome"."main"."raw_activities" )

select * from activities
  );

[0m12:12:59.737660 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:12:59.740623 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients_from_seed"
[0m12:12:59.740805 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients_from_seed"} */
alter view "data_takehome"."main"."patients_from_seed" rename to "patients_from_seed__dbt_backup"
[0m12:12:59.741015 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:12:59.741167 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m12:12:59.742510 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:12:59.743787 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients_from_seed"
[0m12:12:59.744008 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities_from_seed"} */
alter view "data_takehome"."main"."activities_from_seed" rename to "activities_from_seed__dbt_backup"
[0m12:12:59.744188 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients_from_seed"} */
alter view "data_takehome"."main"."patients_from_seed__dbt_tmp" rename to "patients_from_seed"
[0m12:12:59.744439 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:12:59.744591 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m12:12:59.745940 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:12:59.752413 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities_from_seed"} */
alter view "data_takehome"."main"."activities_from_seed__dbt_tmp" rename to "activities_from_seed"
[0m12:12:59.753936 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: COMMIT
[0m12:12:59.754109 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients_from_seed"
[0m12:12:59.754259 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: COMMIT
[0m12:12:59.754474 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:12:59.755983 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: COMMIT
[0m12:12:59.756151 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:12:59.756308 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m12:12:59.756457 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: COMMIT
[0m12:12:59.758737 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients_from_seed"
[0m12:12:59.758943 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients_from_seed"} */
drop view if exists "data_takehome"."main"."patients_from_seed__dbt_backup" cascade
[0m12:12:59.759129 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:12:59.760150 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:12:59.760305 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities_from_seed"} */
drop view if exists "data_takehome"."main"."activities_from_seed__dbt_backup" cascade
[0m12:12:59.760505 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:12:59.761640 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: Close
[0m12:12:59.762293 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c5668a2-11e3-49c6-afc0-9791bdc570d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10743c800>]}
[0m12:12:59.762722 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:12:59.762583 [info ] [Thread-2 (]: 2 of 2 OK created sql view model main.patients_from_seed ....................... [[32mOK[0m in 0.05s]
[0m12:12:59.763396 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: Close
[0m12:12:59.763636 [debug] [Thread-2 (]: Finished running node model.data_takehome.patients_from_seed
[0m12:12:59.767313 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c5668a2-11e3-49c6-afc0-9791bdc570d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10982eea0>]}
[0m12:12:59.767684 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main.activities_from_seed ..................... [[32mOK[0m in 0.06s]
[0m12:12:59.767959 [debug] [Thread-1 (]: Finished running node model.data_takehome.activities_from_seed
[0m12:12:59.768811 [debug] [MainThread]: Using duckdb connection "master"
[0m12:12:59.768967 [debug] [MainThread]: On master: BEGIN
[0m12:12:59.769097 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:12:59.771846 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:12:59.772069 [debug] [MainThread]: On master: COMMIT
[0m12:12:59.772204 [debug] [MainThread]: Using duckdb connection "master"
[0m12:12:59.772325 [debug] [MainThread]: On master: COMMIT
[0m12:12:59.772469 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:12:59.772597 [debug] [MainThread]: On master: Close
[0m12:12:59.773118 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:12:59.773256 [debug] [MainThread]: Connection 'model.data_takehome.activities_from_seed' was properly closed.
[0m12:12:59.773368 [debug] [MainThread]: Connection 'model.data_takehome.patients_from_seed' was properly closed.
[0m12:12:59.773537 [info ] [MainThread]: 
[0m12:12:59.773683 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m12:12:59.774044 [debug] [MainThread]: Command end result
[0m12:12:59.786128 [info ] [MainThread]: 
[0m12:12:59.786359 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:12:59.786509 [info ] [MainThread]: 
[0m12:12:59.786661 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:12:59.788612 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6512515, "process_user_time": 1.011343, "process_kernel_time": 0.177772, "process_mem_max_rss": "131022848", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:12:59.788865 [debug] [MainThread]: Command `dbt run` succeeded at 12:12:59.788824 after 0.65 seconds
[0m12:12:59.789046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10981b860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107401a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fb37d0>]}
[0m12:12:59.789208 [debug] [MainThread]: Flushing usage events
[0m12:15:54.278395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062a0b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106585970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106585580>]}


============================== 12:15:54.281342 | e832caf6-db4b-4997-86ae-e457bb4b3f04 ==============================
[0m12:15:54.281342 [info ] [MainThread]: Running with dbt=1.8.1
[0m12:15:54.281687 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'version_check': 'True', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:15:54.436549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e832caf6-db4b-4997-86ae-e457bb4b3f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10668a540>]}
[0m12:15:54.479161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e832caf6-db4b-4997-86ae-e457bb4b3f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fdfc80>]}
[0m12:15:54.480664 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m12:15:54.536000 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m12:15:54.588785 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:15:54.589122 [debug] [MainThread]: Partial parsing: updated file: data_takehome://models/staging/patients_from_seed.sql
[0m12:15:54.685184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e832caf6-db4b-4997-86ae-e457bb4b3f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b22f00>]}
[0m12:15:54.724423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e832caf6-db4b-4997-86ae-e457bb4b3f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aeaff0>]}
[0m12:15:54.724701 [info ] [MainThread]: Found 4 seeds, 2 models, 421 macros
[0m12:15:54.724866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e832caf6-db4b-4997-86ae-e457bb4b3f04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106561790>]}
[0m12:15:54.725611 [info ] [MainThread]: 
[0m12:15:54.725887 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:15:54.727994 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_data_takehome'
[0m12:15:54.759605 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome"
[0m12:15:54.759855 [debug] [ThreadPool]: On list_data_takehome: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m12:15:54.759998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:15:54.767553 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m12:15:54.767792 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m12:15:54.768171 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:15:54.768302 [debug] [MainThread]: Connection 'list_data_takehome' was properly closed.
[0m12:15:54.768448 [info ] [MainThread]: 
[0m12:15:54.768606 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m12:15:54.768842 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/qamr/Documents/Development/suvera/data-dbt-takehome/data_takehome.duckdb": Conflicting lock is held in /opt/homebrew/Cellar/duckdb/1.1.1/bin/duckdb (PID 1731) by user qamr. See also https://duckdb.org/docs/connect/concurrency
[0m12:15:54.770772 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5248352, "process_user_time": 0.904553, "process_kernel_time": 0.168293, "process_mem_max_rss": "122978304", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:15:54.771033 [debug] [MainThread]: Command `dbt run` failed at 12:15:54.770987 after 0.53 seconds
[0m12:15:54.771201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106585940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10668ba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066dcad0>]}
[0m12:15:54.771359 [debug] [MainThread]: Flushing usage events
[0m12:16:09.329649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10255ade0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104245880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104245460>]}


============================== 12:16:09.332406 | f154b0da-4a4e-4b4d-b950-e94f9228a1b9 ==============================
[0m12:16:09.332406 [info ] [MainThread]: Running with dbt=1.8.1
[0m12:16:09.332754 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:16:09.483588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f154b0da-4a4e-4b4d-b950-e94f9228a1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042ae540>]}
[0m12:16:09.526186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f154b0da-4a4e-4b4d-b950-e94f9228a1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029c4230>]}
[0m12:16:09.527577 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m12:16:09.582126 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m12:16:09.634248 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:16:09.634479 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:16:09.650112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f154b0da-4a4e-4b4d-b950-e94f9228a1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104201bb0>]}
[0m12:16:09.689643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f154b0da-4a4e-4b4d-b950-e94f9228a1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10441e000>]}
[0m12:16:09.689919 [info ] [MainThread]: Found 4 seeds, 2 models, 421 macros
[0m12:16:09.690096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f154b0da-4a4e-4b4d-b950-e94f9228a1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047a6720>]}
[0m12:16:09.690843 [info ] [MainThread]: 
[0m12:16:09.691116 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:16:09.693226 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_data_takehome'
[0m12:16:09.725799 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome"
[0m12:16:09.726021 [debug] [ThreadPool]: On list_data_takehome: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m12:16:09.726164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:16:09.745813 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m12:16:09.747040 [debug] [ThreadPool]: On list_data_takehome: Close
[0m12:16:09.749083 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data_takehome, now create_data_takehome_main)
[0m12:16:09.749411 [debug] [ThreadPool]: Creating schema "database: "data_takehome"
schema: "main"
"
[0m12:16:09.752808 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m12:16:09.752977 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
        select type from duckdb_databases()
        where database_name='data_takehome'
        and type='sqlite'
    
  
[0m12:16:09.753108 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:16:09.756019 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:16:09.756657 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m12:16:09.756793 [debug] [ThreadPool]: On create_data_takehome_main: BEGIN
[0m12:16:09.756940 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:16:09.757057 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m12:16:09.757178 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
    
        create schema if not exists "data_takehome"."main"
    
[0m12:16:09.758022 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:16:09.758404 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m12:16:09.758527 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m12:16:09.758638 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m12:16:09.758781 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:16:09.758907 [debug] [ThreadPool]: On create_data_takehome_main: Close
[0m12:16:09.759887 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_data_takehome_main, now list_data_takehome_main)
[0m12:16:09.762439 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m12:16:09.762599 [debug] [ThreadPool]: On list_data_takehome_main: BEGIN
[0m12:16:09.762721 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:16:09.764921 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:16:09.765079 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m12:16:09.765223 [debug] [ThreadPool]: On list_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome_main"} */
select
      'data_takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'data_takehome'
  
[0m12:16:09.779170 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m12:16:09.782382 [debug] [ThreadPool]: On list_data_takehome_main: ROLLBACK
[0m12:16:09.783360 [debug] [ThreadPool]: Failed to rollback 'list_data_takehome_main'
[0m12:16:09.783502 [debug] [ThreadPool]: On list_data_takehome_main: Close
[0m12:16:09.784724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f154b0da-4a4e-4b4d-b950-e94f9228a1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029c4440>]}
[0m12:16:09.784956 [debug] [MainThread]: Using duckdb connection "master"
[0m12:16:09.785089 [debug] [MainThread]: On master: BEGIN
[0m12:16:09.785213 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:16:09.787426 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m12:16:09.787587 [debug] [MainThread]: On master: COMMIT
[0m12:16:09.787718 [debug] [MainThread]: Using duckdb connection "master"
[0m12:16:09.787839 [debug] [MainThread]: On master: COMMIT
[0m12:16:09.787976 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:16:09.788098 [debug] [MainThread]: On master: Close
[0m12:16:09.788560 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m12:16:09.788736 [info ] [MainThread]: 
[0m12:16:09.790640 [debug] [Thread-1 (]: Began running node model.data_takehome.activities_from_seed
[0m12:16:09.790835 [debug] [Thread-2 (]: Began running node model.data_takehome.patients_from_seed
[0m12:16:09.791081 [info ] [Thread-1 (]: 1 of 2 START sql view model main.activities_from_seed .......................... [RUN]
[0m12:16:09.791309 [info ] [Thread-2 (]: 2 of 2 START sql view model main.patients_from_seed ............................ [RUN]
[0m12:16:09.791557 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_takehome_main, now model.data_takehome.activities_from_seed)
[0m12:16:09.791826 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.data_takehome.patients_from_seed'
[0m12:16:09.791987 [debug] [Thread-1 (]: Began compiling node model.data_takehome.activities_from_seed
[0m12:16:09.792138 [debug] [Thread-2 (]: Began compiling node model.data_takehome.patients_from_seed
[0m12:16:09.795572 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_takehome.activities_from_seed"
[0m12:16:09.796796 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_takehome.patients_from_seed"
[0m12:16:09.797268 [debug] [Thread-2 (]: Began executing node model.data_takehome.patients_from_seed
[0m12:16:09.797426 [debug] [Thread-1 (]: Began executing node model.data_takehome.activities_from_seed
[0m12:16:09.812981 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_takehome.patients_from_seed"
[0m12:16:09.814541 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_takehome.activities_from_seed"
[0m12:16:09.815080 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:16:09.815242 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: BEGIN
[0m12:16:09.815382 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:16:09.817775 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:16:09.817976 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients_from_seed"
[0m12:16:09.818134 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:16:09.818289 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: BEGIN
[0m12:16:09.818443 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities_from_seed"} */

  
  create view "data_takehome"."main"."activities_from_seed__dbt_tmp" as (
    with activities as (
select * from "data_takehome"."main"."raw_activities" )

select * from activities
  );

[0m12:16:09.818592 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:16:09.818851 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m12:16:09.819054 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients_from_seed"
[0m12:16:09.819221 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:16:09.819388 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients_from_seed"} */

  
  create view "data_takehome"."main"."patients_from_seed__dbt_tmp" as (
    WITH patients AS (
  SELECT 
    json_extract_string(data, '$.patient_id') AS patient_id,
    json_extract_string(data, '$.practice_id') AS practice_id,
    json_extract_string(data, '$.age') AS age,
    json_extract_string(data, '$.gender') AS gender,
    json_extract_string(data, '$.registration_date') AS registration_date,
    json_extract_string(data, '$.conditions') AS conditions,
    json_extract_string(data, '$.contact.email') AS email,
    json_extract_string(data, '$.contact.phone') AS phone
  FROM "data_takehome"."main"."raw_patients"
  --WHERE data IS NOT NULL
)

-- Create the final normalized table
SELECT 
  patient_id,
  practice_id,
  age,
  gender,
  registration_date,
  conditions,
  regexp_replace(conditions, '[[]]', '', 'g') AS cleaned_conditions,
  email,
  phone
FROM patients
--WHERE patient_id IS NOT NULL;
  );

[0m12:16:09.822429 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:16:09.822638 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities_from_seed"} */
alter view "data_takehome"."main"."activities_from_seed" rename to "activities_from_seed__dbt_backup"
[0m12:16:09.822872 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:16:09.824198 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:16:09.824408 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities_from_seed"} */
alter view "data_takehome"."main"."activities_from_seed__dbt_tmp" rename to "activities_from_seed"
[0m12:16:09.824594 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m12:16:09.826047 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients_from_seed"
[0m12:16:09.826206 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients_from_seed"} */
alter view "data_takehome"."main"."patients_from_seed" rename to "patients_from_seed__dbt_backup"
[0m12:16:09.826403 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:16:09.826572 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m12:16:09.834288 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: COMMIT
[0m12:16:09.835652 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients_from_seed"
[0m12:16:09.835818 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:16:09.835970 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients_from_seed"} */
alter view "data_takehome"."main"."patients_from_seed__dbt_tmp" rename to "patients_from_seed"
[0m12:16:09.836115 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: COMMIT
[0m12:16:09.836334 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m12:16:09.837015 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: COMMIT
[0m12:16:09.837159 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients_from_seed"
[0m12:16:09.837290 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: COMMIT
[0m12:16:09.837451 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:16:09.839669 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:16:09.839842 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities_from_seed"} */
drop view if exists "data_takehome"."main"."activities_from_seed__dbt_backup" cascade
[0m12:16:09.840006 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m12:16:09.841023 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients_from_seed"
[0m12:16:09.841182 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients_from_seed"} */
drop view if exists "data_takehome"."main"."patients_from_seed__dbt_backup" cascade
[0m12:16:09.841405 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:16:09.842520 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: Close
[0m12:16:09.842985 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m12:16:09.843330 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f154b0da-4a4e-4b4d-b950-e94f9228a1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102927560>]}
[0m12:16:09.843929 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: Close
[0m12:16:09.844200 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main.activities_from_seed ..................... [[32mOK[0m in 0.05s]
[0m12:16:09.847574 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f154b0da-4a4e-4b4d-b950-e94f9228a1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104219fd0>]}
[0m12:16:09.847848 [debug] [Thread-1 (]: Finished running node model.data_takehome.activities_from_seed
[0m12:16:09.848111 [info ] [Thread-2 (]: 2 of 2 OK created sql view model main.patients_from_seed ....................... [[32mOK[0m in 0.06s]
[0m12:16:09.848441 [debug] [Thread-2 (]: Finished running node model.data_takehome.patients_from_seed
[0m12:16:09.849271 [debug] [MainThread]: Using duckdb connection "master"
[0m12:16:09.849417 [debug] [MainThread]: On master: BEGIN
[0m12:16:09.849545 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:16:09.852234 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:16:09.852434 [debug] [MainThread]: On master: COMMIT
[0m12:16:09.852563 [debug] [MainThread]: Using duckdb connection "master"
[0m12:16:09.852683 [debug] [MainThread]: On master: COMMIT
[0m12:16:09.852826 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:16:09.852955 [debug] [MainThread]: On master: Close
[0m12:16:09.853420 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:16:09.853536 [debug] [MainThread]: Connection 'model.data_takehome.activities_from_seed' was properly closed.
[0m12:16:09.853639 [debug] [MainThread]: Connection 'model.data_takehome.patients_from_seed' was properly closed.
[0m12:16:09.853797 [info ] [MainThread]: 
[0m12:16:09.853940 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m12:16:09.854292 [debug] [MainThread]: Command end result
[0m12:16:09.867054 [info ] [MainThread]: 
[0m12:16:09.867299 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:16:09.867446 [info ] [MainThread]: 
[0m12:16:09.867597 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:16:09.869122 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5708921, "process_user_time": 0.929315, "process_kernel_time": 0.163087, "process_mem_max_rss": "128729088", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:16:09.869356 [debug] [MainThread]: Command `dbt run` succeeded at 12:16:09.869314 after 0.57 seconds
[0m12:16:09.869531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10340a240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10441da60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10441e000>]}
[0m12:16:09.869684 [debug] [MainThread]: Flushing usage events
[0m12:18:36.262202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c21f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109241970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092415b0>]}


============================== 12:18:36.265108 | 5264e8bb-f112-4309-a2dc-f92cb465b969 ==============================
[0m12:18:36.265108 [info ] [MainThread]: Running with dbt=1.8.1
[0m12:18:36.265429 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:18:36.422624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5264e8bb-f112-4309-a2dc-f92cb465b969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074677d0>]}
[0m12:18:36.464893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5264e8bb-f112-4309-a2dc-f92cb465b969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094d02f0>]}
[0m12:18:36.466357 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m12:18:36.521032 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m12:18:36.574155 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:18:36.574486 [debug] [MainThread]: Partial parsing: updated file: data_takehome://models/staging/patients_from_seed.sql
[0m12:18:36.669390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5264e8bb-f112-4309-a2dc-f92cb465b969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098df380>]}
[0m12:18:36.708453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5264e8bb-f112-4309-a2dc-f92cb465b969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098aad80>]}
[0m12:18:36.708779 [info ] [MainThread]: Found 4 seeds, 2 models, 421 macros
[0m12:18:36.708951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5264e8bb-f112-4309-a2dc-f92cb465b969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10921e930>]}
[0m12:18:36.709873 [info ] [MainThread]: 
[0m12:18:36.710215 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:18:36.712457 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_data_takehome'
[0m12:18:36.743605 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome"
[0m12:18:36.743851 [debug] [ThreadPool]: On list_data_takehome: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m12:18:36.743997 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:18:36.763343 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m12:18:36.764497 [debug] [ThreadPool]: On list_data_takehome: Close
[0m12:18:36.765928 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data_takehome, now create_data_takehome_main)
[0m12:18:36.766205 [debug] [ThreadPool]: Creating schema "database: "data_takehome"
schema: "main"
"
[0m12:18:36.769749 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m12:18:36.769910 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
        select type from duckdb_databases()
        where database_name='data_takehome'
        and type='sqlite'
    
  
[0m12:18:36.770042 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:18:36.772761 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:18:36.773427 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m12:18:36.773563 [debug] [ThreadPool]: On create_data_takehome_main: BEGIN
[0m12:18:36.773715 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:18:36.773835 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m12:18:36.773955 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
    
        create schema if not exists "data_takehome"."main"
    
[0m12:18:36.774821 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:18:36.775205 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m12:18:36.775330 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m12:18:36.775440 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m12:18:36.775576 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:18:36.775701 [debug] [ThreadPool]: On create_data_takehome_main: Close
[0m12:18:36.776678 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_data_takehome_main, now list_data_takehome_main)
[0m12:18:36.779255 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m12:18:36.779408 [debug] [ThreadPool]: On list_data_takehome_main: BEGIN
[0m12:18:36.779530 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:18:36.781863 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:18:36.782034 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m12:18:36.782175 [debug] [ThreadPool]: On list_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome_main"} */
select
      'data_takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'data_takehome'
  
[0m12:18:36.796142 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m12:18:36.799363 [debug] [ThreadPool]: On list_data_takehome_main: ROLLBACK
[0m12:18:36.800349 [debug] [ThreadPool]: Failed to rollback 'list_data_takehome_main'
[0m12:18:36.800492 [debug] [ThreadPool]: On list_data_takehome_main: Close
[0m12:18:36.801814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5264e8bb-f112-4309-a2dc-f92cb465b969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10941ec00>]}
[0m12:18:36.802074 [debug] [MainThread]: Using duckdb connection "master"
[0m12:18:36.802205 [debug] [MainThread]: On master: BEGIN
[0m12:18:36.802325 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:18:36.804541 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m12:18:36.804699 [debug] [MainThread]: On master: COMMIT
[0m12:18:36.804827 [debug] [MainThread]: Using duckdb connection "master"
[0m12:18:36.804948 [debug] [MainThread]: On master: COMMIT
[0m12:18:36.805100 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:18:36.805223 [debug] [MainThread]: On master: Close
[0m12:18:36.805670 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m12:18:36.805825 [info ] [MainThread]: 
[0m12:18:36.808510 [debug] [Thread-1 (]: Began running node model.data_takehome.activities_from_seed
[0m12:18:36.808713 [debug] [Thread-2 (]: Began running node model.data_takehome.patients_from_seed
[0m12:18:36.808972 [info ] [Thread-1 (]: 1 of 2 START sql view model main.activities_from_seed .......................... [RUN]
[0m12:18:36.809174 [info ] [Thread-2 (]: 2 of 2 START sql view model main.patients_from_seed ............................ [RUN]
[0m12:18:36.809452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_takehome_main, now model.data_takehome.activities_from_seed)
[0m12:18:36.809674 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.data_takehome.patients_from_seed'
[0m12:18:36.809838 [debug] [Thread-1 (]: Began compiling node model.data_takehome.activities_from_seed
[0m12:18:36.809989 [debug] [Thread-2 (]: Began compiling node model.data_takehome.patients_from_seed
[0m12:18:36.813398 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_takehome.activities_from_seed"
[0m12:18:36.814633 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_takehome.patients_from_seed"
[0m12:18:36.815122 [debug] [Thread-2 (]: Began executing node model.data_takehome.patients_from_seed
[0m12:18:36.815281 [debug] [Thread-1 (]: Began executing node model.data_takehome.activities_from_seed
[0m12:18:36.831530 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_takehome.activities_from_seed"
[0m12:18:36.832255 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_takehome.patients_from_seed"
[0m12:18:36.832611 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:18:36.832770 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: BEGIN
[0m12:18:36.832910 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:18:36.835261 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:18:36.835462 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients_from_seed"
[0m12:18:36.835622 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:18:36.835780 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: BEGIN
[0m12:18:36.835936 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities_from_seed"} */

  
  create view "data_takehome"."main"."activities_from_seed__dbt_tmp" as (
    with activities as (
select * from "data_takehome"."main"."raw_activities" )

select * from activities
  );

[0m12:18:36.836087 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:18:36.836300 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m12:18:36.836445 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients_from_seed"
[0m12:18:36.836615 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients_from_seed"} */

  
  create view "data_takehome"."main"."patients_from_seed__dbt_tmp" as (
    WITH patients AS (
  SELECT 
    json_extract_string(data, '$.patient_id') AS patient_id,
    json_extract_string(data, '$.practice_id') AS practice_id,
    json_extract_string(data, '$.age') AS age,
    json_extract_string(data, '$.gender') AS gender,
    json_extract_string(data, '$.registration_date') AS registration_date,
    json_extract_string(data, '$.conditions') AS conditions,
    json_extract_string(data, '$.contact.email') AS email,
    json_extract_string(data, '$.contact.phone') AS phone
  FROM "data_takehome"."main"."raw_patients"
  --WHERE data IS NOT NULL
)

-- Create the final normalized table
SELECT 
  patient_id,
  practice_id,
  age,
  gender,
  registration_date,
  conditions,
   CASE
    WHEN conditions LIKE '[%' AND conditions LIKE '%]'
    THEN substr(conditions, 2, length(conditions)-2)
    ELSE conditions
  END AS cleaned_conditions,
  email,
  phone
FROM patients
--WHERE patient_id IS NOT NULL;
  );

[0m12:18:36.836801 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:18:36.840052 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:18:36.840255 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities_from_seed"} */
alter view "data_takehome"."main"."activities_from_seed" rename to "activities_from_seed__dbt_backup"
[0m12:18:36.840473 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m12:18:36.841937 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients_from_seed"
[0m12:18:36.842113 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:18:36.842854 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients_from_seed"} */
alter view "data_takehome"."main"."patients_from_seed" rename to "patients_from_seed__dbt_backup"
[0m12:18:36.844193 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:18:36.844386 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities_from_seed"} */
alter view "data_takehome"."main"."activities_from_seed__dbt_tmp" rename to "activities_from_seed"
[0m12:18:36.844593 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m12:18:36.844753 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:18:36.846026 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients_from_seed"
[0m12:18:36.854046 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: COMMIT
[0m12:18:36.854219 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients_from_seed"} */
alter view "data_takehome"."main"."patients_from_seed__dbt_tmp" rename to "patients_from_seed"
[0m12:18:36.854386 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:18:36.854557 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: COMMIT
[0m12:18:36.854750 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m12:18:36.855542 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: COMMIT
[0m12:18:36.855688 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients_from_seed"
[0m12:18:36.855829 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: COMMIT
[0m12:18:36.856109 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:18:36.859193 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:18:36.859384 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities_from_seed"} */
drop view if exists "data_takehome"."main"."activities_from_seed__dbt_backup" cascade
[0m12:18:36.859558 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m12:18:36.860602 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients_from_seed"
[0m12:18:36.860756 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients_from_seed"} */
drop view if exists "data_takehome"."main"."patients_from_seed__dbt_backup" cascade
[0m12:18:36.861009 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:18:36.862457 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: Close
[0m12:18:36.862920 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m12:18:36.863567 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: Close
[0m12:18:36.869502 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5264e8bb-f112-4309-a2dc-f92cb465b969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f35e80>]}
[0m12:18:36.869836 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5264e8bb-f112-4309-a2dc-f92cb465b969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c20920>]}
[0m12:18:36.870155 [info ] [Thread-2 (]: 2 of 2 OK created sql view model main.patients_from_seed ....................... [[32mOK[0m in 0.06s]
[0m12:18:36.870386 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main.activities_from_seed ..................... [[32mOK[0m in 0.05s]
[0m12:18:36.870751 [debug] [Thread-2 (]: Finished running node model.data_takehome.patients_from_seed
[0m12:18:36.871001 [debug] [Thread-1 (]: Finished running node model.data_takehome.activities_from_seed
[0m12:18:36.871911 [debug] [MainThread]: Using duckdb connection "master"
[0m12:18:36.872056 [debug] [MainThread]: On master: BEGIN
[0m12:18:36.872177 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:18:36.874567 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m12:18:36.874901 [debug] [MainThread]: On master: COMMIT
[0m12:18:36.875160 [debug] [MainThread]: Using duckdb connection "master"
[0m12:18:36.875278 [debug] [MainThread]: On master: COMMIT
[0m12:18:36.875418 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:18:36.875544 [debug] [MainThread]: On master: Close
[0m12:18:36.876005 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:18:36.876154 [debug] [MainThread]: Connection 'model.data_takehome.activities_from_seed' was properly closed.
[0m12:18:36.876271 [debug] [MainThread]: Connection 'model.data_takehome.patients_from_seed' was properly closed.
[0m12:18:36.876437 [info ] [MainThread]: 
[0m12:18:36.876582 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m12:18:36.876935 [debug] [MainThread]: Command end result
[0m12:18:36.890354 [info ] [MainThread]: 
[0m12:18:36.890642 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:18:36.890801 [info ] [MainThread]: 
[0m12:18:36.890962 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:18:36.893580 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.66206473, "process_user_time": 1.010932, "process_kernel_time": 0.178612, "process_mem_max_rss": "131563520", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:18:36.893881 [debug] [MainThread]: Command `dbt run` succeeded at 12:18:36.893838 after 0.66 seconds
[0m12:18:36.894066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109241970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096665a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10977f4d0>]}
[0m12:18:36.894237 [debug] [MainThread]: Flushing usage events
[0m12:20:39.843520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068d0b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068448f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bb9460>]}


============================== 12:20:39.846513 | 48c948dc-b843-403c-bd5c-d21631107530 ==============================
[0m12:20:39.846513 [info ] [MainThread]: Running with dbt=1.8.1
[0m12:20:39.846826 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:20:40.008253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '48c948dc-b843-403c-bd5c-d21631107530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c63b30>]}
[0m12:20:40.051512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '48c948dc-b843-403c-bd5c-d21631107530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d47140>]}
[0m12:20:40.052958 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m12:20:40.105916 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m12:20:40.159410 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:20:40.159749 [debug] [MainThread]: Partial parsing: updated file: data_takehome://models/staging/patients_from_seed.sql
[0m12:20:40.254062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48c948dc-b843-403c-bd5c-d21631107530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10714f110>]}
[0m12:20:40.292698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '48c948dc-b843-403c-bd5c-d21631107530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10711aed0>]}
[0m12:20:40.292977 [info ] [MainThread]: Found 4 seeds, 2 models, 421 macros
[0m12:20:40.293148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48c948dc-b843-403c-bd5c-d21631107530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071266f0>]}
[0m12:20:40.293892 [info ] [MainThread]: 
[0m12:20:40.294179 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:20:40.296291 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_data_takehome'
[0m12:20:40.326980 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome"
[0m12:20:40.327226 [debug] [ThreadPool]: On list_data_takehome: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m12:20:40.327392 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:20:40.345333 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m12:20:40.346321 [debug] [ThreadPool]: On list_data_takehome: Close
[0m12:20:40.347506 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data_takehome, now create_data_takehome_main)
[0m12:20:40.347718 [debug] [ThreadPool]: Creating schema "database: "data_takehome"
schema: "main"
"
[0m12:20:40.350896 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m12:20:40.351054 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
        select type from duckdb_databases()
        where database_name='data_takehome'
        and type='sqlite'
    
  
[0m12:20:40.351180 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:20:40.353942 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:20:40.354582 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m12:20:40.354718 [debug] [ThreadPool]: On create_data_takehome_main: BEGIN
[0m12:20:40.354864 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:20:40.354987 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m12:20:40.355107 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
    
        create schema if not exists "data_takehome"."main"
    
[0m12:20:40.355901 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:20:40.356291 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m12:20:40.356414 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m12:20:40.356525 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m12:20:40.356662 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:20:40.356786 [debug] [ThreadPool]: On create_data_takehome_main: Close
[0m12:20:40.357792 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_data_takehome_main, now list_data_takehome_main)
[0m12:20:40.360398 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m12:20:40.360556 [debug] [ThreadPool]: On list_data_takehome_main: BEGIN
[0m12:20:40.360680 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:20:40.362990 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:20:40.363153 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m12:20:40.363294 [debug] [ThreadPool]: On list_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome_main"} */
select
      'data_takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'data_takehome'
  
[0m12:20:40.377070 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m12:20:40.380123 [debug] [ThreadPool]: On list_data_takehome_main: ROLLBACK
[0m12:20:40.381236 [debug] [ThreadPool]: Failed to rollback 'list_data_takehome_main'
[0m12:20:40.381385 [debug] [ThreadPool]: On list_data_takehome_main: Close
[0m12:20:40.382626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '48c948dc-b843-403c-bd5c-d21631107530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070024e0>]}
[0m12:20:40.382854 [debug] [MainThread]: Using duckdb connection "master"
[0m12:20:40.382980 [debug] [MainThread]: On master: BEGIN
[0m12:20:40.383092 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:20:40.385289 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m12:20:40.385454 [debug] [MainThread]: On master: COMMIT
[0m12:20:40.385583 [debug] [MainThread]: Using duckdb connection "master"
[0m12:20:40.385697 [debug] [MainThread]: On master: COMMIT
[0m12:20:40.385834 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:20:40.385958 [debug] [MainThread]: On master: Close
[0m12:20:40.386446 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m12:20:40.386649 [info ] [MainThread]: 
[0m12:20:40.389417 [debug] [Thread-1 (]: Began running node model.data_takehome.activities_from_seed
[0m12:20:40.389616 [debug] [Thread-2 (]: Began running node model.data_takehome.patients_from_seed
[0m12:20:40.389872 [info ] [Thread-1 (]: 1 of 2 START sql view model main.activities_from_seed .......................... [RUN]
[0m12:20:40.390067 [info ] [Thread-2 (]: 2 of 2 START sql view model main.patients_from_seed ............................ [RUN]
[0m12:20:40.390341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_takehome_main, now model.data_takehome.activities_from_seed)
[0m12:20:40.390588 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.data_takehome.patients_from_seed'
[0m12:20:40.390770 [debug] [Thread-1 (]: Began compiling node model.data_takehome.activities_from_seed
[0m12:20:40.390932 [debug] [Thread-2 (]: Began compiling node model.data_takehome.patients_from_seed
[0m12:20:40.394436 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_takehome.activities_from_seed"
[0m12:20:40.395693 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_takehome.patients_from_seed"
[0m12:20:40.396214 [debug] [Thread-1 (]: Began executing node model.data_takehome.activities_from_seed
[0m12:20:40.396398 [debug] [Thread-2 (]: Began executing node model.data_takehome.patients_from_seed
[0m12:20:40.413434 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_takehome.patients_from_seed"
[0m12:20:40.413906 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_takehome.activities_from_seed"
[0m12:20:40.414424 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients_from_seed"
[0m12:20:40.414612 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:20:40.414776 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: BEGIN
[0m12:20:40.414931 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: BEGIN
[0m12:20:40.415078 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:20:40.415217 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:20:40.417636 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m12:20:40.417855 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients_from_seed"
[0m12:20:40.418036 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients_from_seed"} */

  
  create view "data_takehome"."main"."patients_from_seed__dbt_tmp" as (
    WITH patients AS (
  SELECT 
    json_extract_string(data, '$.patient_id') AS patient_id,
    json_extract_string(data, '$.practice_id') AS practice_id,
    json_extract_string(data, '$.age') AS age,
    json_extract_string(data, '$.gender') AS gender,
    json_extract_string(data, '$.registration_date') AS registration_date,
    json_extract_string(data, '$.conditions') AS conditions,
    json_extract_string(data, '$.contact.email') AS email,
    json_extract_string(data, '$.contact.phone') AS phone
  FROM "data_takehome"."main"."raw_patients"

)

-- remove square brackets from conditions column
SELECT 
  patient_id,
  practice_id,
  age,
  gender,
  registration_date,
   CASE
    WHEN conditions LIKE '[%' AND conditions LIKE '%]'
    THEN substr(conditions, 2, length(conditions)-2)
    ELSE conditions
  END AS conditions,
  email,
  phone
FROM patients
  );

[0m12:20:40.418212 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:20:40.418376 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:20:40.418528 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities_from_seed"} */

  
  create view "data_takehome"."main"."activities_from_seed__dbt_tmp" as (
    with activities as (
select * from "data_takehome"."main"."raw_activities" )

select * from activities
  );

[0m12:20:40.418777 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:20:40.422059 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:20:40.422247 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities_from_seed"} */
alter view "data_takehome"."main"."activities_from_seed" rename to "activities_from_seed__dbt_backup"
[0m12:20:40.422633 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m12:20:40.424047 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients_from_seed"
[0m12:20:40.424223 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients_from_seed"} */
alter view "data_takehome"."main"."patients_from_seed" rename to "patients_from_seed__dbt_backup"
[0m12:20:40.424395 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:20:40.425733 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:20:40.425896 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities_from_seed"} */
alter view "data_takehome"."main"."activities_from_seed__dbt_tmp" rename to "activities_from_seed"
[0m12:20:40.426089 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m12:20:40.426251 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:20:40.427578 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients_from_seed"
[0m12:20:40.436038 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: COMMIT
[0m12:20:40.436225 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients_from_seed"} */
alter view "data_takehome"."main"."patients_from_seed__dbt_tmp" rename to "patients_from_seed"
[0m12:20:40.436396 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:20:40.436574 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: COMMIT
[0m12:20:40.436756 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m12:20:40.437472 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: COMMIT
[0m12:20:40.437626 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients_from_seed"
[0m12:20:40.437766 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: COMMIT
[0m12:20:40.437907 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:20:40.440209 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.activities_from_seed"
[0m12:20:40.440380 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m12:20:40.440525 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.activities_from_seed"} */
drop view if exists "data_takehome"."main"."activities_from_seed__dbt_backup" cascade
[0m12:20:40.441523 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.patients_from_seed"
[0m12:20:40.441706 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patients_from_seed"} */
drop view if exists "data_takehome"."main"."patients_from_seed__dbt_backup" cascade
[0m12:20:40.441933 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:20:40.443040 [debug] [Thread-1 (]: On model.data_takehome.activities_from_seed: Close
[0m12:20:40.443548 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m12:20:40.443848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48c948dc-b843-403c-bd5c-d21631107530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106158920>]}
[0m12:20:40.444454 [debug] [Thread-2 (]: On model.data_takehome.patients_from_seed: Close
[0m12:20:40.448007 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48c948dc-b843-403c-bd5c-d21631107530', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108900560>]}
[0m12:20:40.444734 [info ] [Thread-1 (]: 1 of 2 OK created sql view model main.activities_from_seed ..................... [[32mOK[0m in 0.05s]
[0m12:20:40.448567 [debug] [Thread-1 (]: Finished running node model.data_takehome.activities_from_seed
[0m12:20:40.448291 [info ] [Thread-2 (]: 2 of 2 OK created sql view model main.patients_from_seed ....................... [[32mOK[0m in 0.06s]
[0m12:20:40.448920 [debug] [Thread-2 (]: Finished running node model.data_takehome.patients_from_seed
[0m12:20:40.449783 [debug] [MainThread]: Using duckdb connection "master"
[0m12:20:40.449946 [debug] [MainThread]: On master: BEGIN
[0m12:20:40.450072 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:20:40.452736 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:20:40.453034 [debug] [MainThread]: On master: COMMIT
[0m12:20:40.453178 [debug] [MainThread]: Using duckdb connection "master"
[0m12:20:40.453301 [debug] [MainThread]: On master: COMMIT
[0m12:20:40.453453 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:20:40.453582 [debug] [MainThread]: On master: Close
[0m12:20:40.454062 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:20:40.454199 [debug] [MainThread]: Connection 'model.data_takehome.activities_from_seed' was properly closed.
[0m12:20:40.454309 [debug] [MainThread]: Connection 'model.data_takehome.patients_from_seed' was properly closed.
[0m12:20:40.454475 [info ] [MainThread]: 
[0m12:20:40.454618 [info ] [MainThread]: Finished running 2 view models in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m12:20:40.454959 [debug] [MainThread]: Command end result
[0m12:20:40.466947 [info ] [MainThread]: 
[0m12:20:40.467168 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:20:40.467320 [info ] [MainThread]: 
[0m12:20:40.467473 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:20:40.469444 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6575258, "process_user_time": 1.010732, "process_kernel_time": 0.178642, "process_mem_max_rss": "132235264", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:20:40.469719 [debug] [MainThread]: Command `dbt run` succeeded at 12:20:40.469674 after 0.66 seconds
[0m12:20:40.469904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b74c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106211220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065ff710>]}
[0m12:20:40.470063 [debug] [MainThread]: Flushing usage events
[0m12:38:02.895047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102211f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10409d9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10409d610>]}


============================== 12:38:02.904244 | f66c3f21-bf1b-4578-b6b2-23b76d710fdb ==============================
[0m12:38:02.904244 [info ] [MainThread]: Running with dbt=1.8.1
[0m12:38:02.904586 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m12:38:03.055765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f66c3f21-bf1b-4578-b6b2-23b76d710fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104206cf0>]}
[0m12:38:03.098905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f66c3f21-bf1b-4578-b6b2-23b76d710fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cffb00>]}
[0m12:38:03.099730 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m12:38:03.153788 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m12:38:03.210655 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 5 files added, 0 files changed.
[0m12:38:03.210954 [debug] [MainThread]: Partial parsing: added file: data_takehome://models/staging/stg__pcns.sql
[0m12:38:03.211114 [debug] [MainThread]: Partial parsing: added file: data_takehome://models/staging/stg__patients.sql
[0m12:38:03.211253 [debug] [MainThread]: Partial parsing: added file: data_takehome://models/intermediate/int__patients.sql
[0m12:38:03.211384 [debug] [MainThread]: Partial parsing: added file: data_takehome://models/staging/stg__activities.sql
[0m12:38:03.211511 [debug] [MainThread]: Partial parsing: added file: data_takehome://models/staging/stg__practices.sql
[0m12:38:03.211628 [debug] [MainThread]: Partial parsing: deleted file: data_takehome://models/staging/patients_from_seed.sql
[0m12:38:03.211745 [debug] [MainThread]: Partial parsing: deleted file: data_takehome://models/staging/activities_from_seed.sql
[0m12:38:03.312137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f66c3f21-bf1b-4578-b6b2-23b76d710fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104232a20>]}
[0m12:38:03.354684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f66c3f21-bf1b-4578-b6b2-23b76d710fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043bca10>]}
[0m12:38:03.354965 [info ] [MainThread]: Found 4 seeds, 5 models, 421 macros
[0m12:38:03.355132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f66c3f21-bf1b-4578-b6b2-23b76d710fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104535640>]}
[0m12:38:03.355940 [info ] [MainThread]: 
[0m12:38:03.356215 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:38:03.358451 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_data_takehome'
[0m12:38:03.400139 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome"
[0m12:38:03.400370 [debug] [ThreadPool]: On list_data_takehome: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m12:38:03.400513 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:38:03.417095 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m12:38:03.418113 [debug] [ThreadPool]: On list_data_takehome: Close
[0m12:38:03.419345 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data_takehome, now create_data_takehome_main)
[0m12:38:03.419615 [debug] [ThreadPool]: Creating schema "database: "data_takehome"
schema: "main"
"
[0m12:38:03.423696 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m12:38:03.423864 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
        select type from duckdb_databases()
        where database_name='data_takehome'
        and type='sqlite'
    
  
[0m12:38:03.423994 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:38:03.426644 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:38:03.427309 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m12:38:03.427453 [debug] [ThreadPool]: On create_data_takehome_main: BEGIN
[0m12:38:03.427606 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:38:03.427726 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m12:38:03.427844 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
    
        create schema if not exists "data_takehome"."main"
    
[0m12:38:03.428575 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m12:38:03.428982 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m12:38:03.429117 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m12:38:03.429239 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m12:38:03.429389 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:38:03.429517 [debug] [ThreadPool]: On create_data_takehome_main: Close
[0m12:38:03.430576 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_data_takehome_main, now list_data_takehome_main)
[0m12:38:03.433115 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m12:38:03.433264 [debug] [ThreadPool]: On list_data_takehome_main: BEGIN
[0m12:38:03.433385 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:38:03.435603 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:38:03.435772 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m12:38:03.435914 [debug] [ThreadPool]: On list_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome_main"} */
select
      'data_takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'data_takehome'
  
[0m12:38:03.448163 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m12:38:03.451391 [debug] [ThreadPool]: On list_data_takehome_main: ROLLBACK
[0m12:38:03.452348 [debug] [ThreadPool]: Failed to rollback 'list_data_takehome_main'
[0m12:38:03.452491 [debug] [ThreadPool]: On list_data_takehome_main: Close
[0m12:38:03.453782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f66c3f21-bf1b-4578-b6b2-23b76d710fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10414eae0>]}
[0m12:38:03.454001 [debug] [MainThread]: Using duckdb connection "master"
[0m12:38:03.454130 [debug] [MainThread]: On master: BEGIN
[0m12:38:03.454243 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:38:03.456425 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m12:38:03.456581 [debug] [MainThread]: On master: COMMIT
[0m12:38:03.456706 [debug] [MainThread]: Using duckdb connection "master"
[0m12:38:03.456818 [debug] [MainThread]: On master: COMMIT
[0m12:38:03.456948 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:38:03.457067 [debug] [MainThread]: On master: Close
[0m12:38:03.457546 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m12:38:03.457697 [info ] [MainThread]: 
[0m12:38:03.459889 [debug] [Thread-1 (]: Began running node model.data_takehome.stg__activities
[0m12:38:03.460107 [debug] [Thread-2 (]: Began running node model.data_takehome.stg__patients
[0m12:38:03.460509 [debug] [Thread-3 (]: Began running node model.data_takehome.stg__pcns
[0m12:38:03.460367 [info ] [Thread-1 (]: 1 of 5 START sql view model main.stg__activities ............................... [RUN]
[0m12:38:03.460708 [debug] [Thread-4 (]: Began running node model.data_takehome.stg__practices
[0m12:38:03.460925 [info ] [Thread-2 (]: 2 of 5 START sql view model main.stg__patients ................................. [RUN]
[0m12:38:03.461338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_takehome_main, now model.data_takehome.stg__activities)
[0m12:38:03.461111 [info ] [Thread-3 (]: 3 of 5 START sql view model main.stg__pcns ..................................... [RUN]
[0m12:38:03.461571 [info ] [Thread-4 (]: 4 of 5 START sql view model main.stg__practices ................................ [RUN]
[0m12:38:03.461796 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.data_takehome.stg__patients'
[0m12:38:03.461950 [debug] [Thread-1 (]: Began compiling node model.data_takehome.stg__activities
[0m12:38:03.462135 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.data_takehome.stg__pcns'
[0m12:38:03.462318 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.data_takehome.stg__practices'
[0m12:38:03.462463 [debug] [Thread-2 (]: Began compiling node model.data_takehome.stg__patients
[0m12:38:03.466060 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_takehome.stg__activities"
[0m12:38:03.466285 [debug] [Thread-3 (]: Began compiling node model.data_takehome.stg__pcns
[0m12:38:03.466462 [debug] [Thread-4 (]: Began compiling node model.data_takehome.stg__practices
[0m12:38:03.467817 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_takehome.stg__patients"
[0m12:38:03.469012 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_takehome.stg__pcns"
[0m12:38:03.470210 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_takehome.stg__practices"
[0m12:38:03.470499 [debug] [Thread-1 (]: Began executing node model.data_takehome.stg__activities
[0m12:38:03.470821 [debug] [Thread-2 (]: Began executing node model.data_takehome.stg__patients
[0m12:38:03.476789 [debug] [Thread-3 (]: Began executing node model.data_takehome.stg__pcns
[0m12:38:03.476976 [debug] [Thread-4 (]: Began executing node model.data_takehome.stg__practices
[0m12:38:03.485841 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_takehome.stg__activities"
[0m12:38:03.487445 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_takehome.stg__patients"
[0m12:38:03.489413 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_takehome.stg__pcns"
[0m12:38:03.490762 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_takehome.stg__practices"
[0m12:38:03.491232 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m12:38:03.491429 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m12:38:03.491586 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m12:38:03.491753 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: BEGIN
[0m12:38:03.491928 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m12:38:03.492068 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: BEGIN
[0m12:38:03.492213 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: BEGIN
[0m12:38:03.492429 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:38:03.492574 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: BEGIN
[0m12:38:03.492715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:38:03.492854 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:38:03.495353 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m12:38:03.495522 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:38:03.495728 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:38:03.495886 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m12:38:03.496037 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m12:38:03.496201 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m12:38:03.496354 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:38:03.496504 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */

  
  create view "data_takehome"."main"."stg__patients__dbt_tmp" as (
    with patients as (
select * from "data_takehome"."main"."raw_patients" )

select * from patients
  );

[0m12:38:03.496661 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m12:38:03.496806 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */

  
  create view "data_takehome"."main"."stg__activities__dbt_tmp" as (
    with activities as (
select * from "data_takehome"."main"."raw_activities" )

select * from activities
  );

[0m12:38:03.496949 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m12:38:03.497112 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */

  
  create view "data_takehome"."main"."stg__pcns__dbt_tmp" as (
    with pcns as (
select * from "data_takehome"."main"."raw_pcns" )

select * from pcns
  );

[0m12:38:03.497290 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */

  
  create view "data_takehome"."main"."stg__practices__dbt_tmp" as (
    with practices as (
select * from "data_takehome"."main"."raw_practices" )

select * from practices
  );

[0m12:38:03.497582 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m12:38:03.497766 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:38:03.500781 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m12:38:03.500944 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m12:38:03.501084 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m12:38:03.502397 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m12:38:03.502560 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */
alter view "data_takehome"."main"."stg__patients__dbt_tmp" rename to "stg__patients"
[0m12:38:03.503865 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m12:38:03.505105 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m12:38:03.505266 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */
alter view "data_takehome"."main"."stg__activities__dbt_tmp" rename to "stg__activities"
[0m12:38:03.505443 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */
alter view "data_takehome"."main"."stg__practices__dbt_tmp" rename to "stg__practices"
[0m12:38:03.505601 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */
alter view "data_takehome"."main"."stg__pcns__dbt_tmp" rename to "stg__pcns"
[0m12:38:03.505836 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m12:38:03.512804 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: COMMIT
[0m12:38:03.512991 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m12:38:03.513160 [debug] [Thread-1 (]: SQL status: OK in 0.007 seconds
[0m12:38:03.513312 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m12:38:03.513470 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: COMMIT
[0m12:38:03.513639 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m12:38:03.514266 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: COMMIT
[0m12:38:03.514871 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: COMMIT
[0m12:38:03.515551 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: COMMIT
[0m12:38:03.515716 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m12:38:03.515862 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:38:03.516006 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m12:38:03.516145 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m12:38:03.516285 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: COMMIT
[0m12:38:03.518554 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m12:38:03.518732 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: COMMIT
[0m12:38:03.518884 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: COMMIT
[0m12:38:03.519056 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */
drop view if exists "data_takehome"."main"."stg__patients__dbt_backup" cascade
[0m12:38:03.519210 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:38:03.519459 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m12:38:03.520449 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m12:38:03.520602 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:38:03.521560 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m12:38:03.521721 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */
drop view if exists "data_takehome"."main"."stg__activities__dbt_backup" cascade
[0m12:38:03.522666 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m12:38:03.522800 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m12:38:03.522948 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */
drop view if exists "data_takehome"."main"."stg__practices__dbt_backup" cascade
[0m12:38:03.523124 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */
drop view if exists "data_takehome"."main"."stg__pcns__dbt_backup" cascade
[0m12:38:03.524310 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: Close
[0m12:38:03.524480 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:38:03.525565 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: Close
[0m12:38:03.526049 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:38:03.526625 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: Close
[0m12:38:03.527081 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m12:38:03.527364 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66c3f21-bf1b-4578-b6b2-23b76d710fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045cb560>]}
[0m12:38:03.527632 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66c3f21-bf1b-4578-b6b2-23b76d710fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a65d90>]}
[0m12:38:03.527895 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66c3f21-bf1b-4578-b6b2-23b76d710fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045c94f0>]}
[0m12:38:03.528452 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: Close
[0m12:38:03.528725 [info ] [Thread-1 (]: 1 of 5 OK created sql view model main.stg__activities .......................... [[32mOK[0m in 0.06s]
[0m12:38:03.529018 [info ] [Thread-4 (]: 4 of 5 OK created sql view model main.stg__practices ........................... [[32mOK[0m in 0.06s]
[0m12:38:03.533968 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66c3f21-bf1b-4578-b6b2-23b76d710fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a9ca40>]}
[0m12:38:03.529232 [info ] [Thread-2 (]: 2 of 5 OK created sql view model main.stg__patients ............................ [[32mOK[0m in 0.06s]
[0m12:38:03.534360 [debug] [Thread-1 (]: Finished running node model.data_takehome.stg__activities
[0m12:38:03.534618 [debug] [Thread-4 (]: Finished running node model.data_takehome.stg__practices
[0m12:38:03.535150 [debug] [Thread-2 (]: Finished running node model.data_takehome.stg__patients
[0m12:38:03.534903 [info ] [Thread-3 (]: 3 of 5 OK created sql view model main.stg__pcns ................................ [[32mOK[0m in 0.07s]
[0m12:38:03.535717 [debug] [Thread-3 (]: Finished running node model.data_takehome.stg__pcns
[0m12:38:03.535959 [debug] [Thread-6 (]: Began running node model.data_takehome.int__patients
[0m12:38:03.536184 [info ] [Thread-6 (]: 5 of 5 START sql table model main.int__patients ................................ [RUN]
[0m12:38:03.536427 [debug] [Thread-6 (]: Acquiring new duckdb connection 'model.data_takehome.int__patients'
[0m12:38:03.536581 [debug] [Thread-6 (]: Began compiling node model.data_takehome.int__patients
[0m12:38:03.537910 [debug] [Thread-6 (]: Writing injected SQL for node "model.data_takehome.int__patients"
[0m12:38:03.538520 [debug] [Thread-6 (]: Began executing node model.data_takehome.int__patients
[0m12:38:03.548613 [debug] [Thread-6 (]: Writing runtime sql for node "model.data_takehome.int__patients"
[0m12:38:03.549077 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m12:38:03.549238 [debug] [Thread-6 (]: On model.data_takehome.int__patients: BEGIN
[0m12:38:03.549377 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m12:38:03.551834 [debug] [Thread-6 (]: SQL status: OK in 0.002 seconds
[0m12:38:03.552015 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m12:38:03.552177 [debug] [Thread-6 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */

  
    
    

    create  table
      "data_takehome"."main"."int__patients__dbt_tmp"
  
    as (
      WITH patients AS (
  SELECT 
    json_extract_string(data, '$.patient_id') AS patient_id,
    json_extract_string(data, '$.practice_id') AS practice_id,
    json_extract_string(data, '$.age') AS age,
    json_extract_string(data, '$.gender') AS gender,
    json_extract_string(data, '$.registration_date') AS registration_date,
    json_extract_string(data, '$.conditions') AS conditions,
    json_extract_string(data, '$.contact.email') AS email,
    json_extract_string(data, '$.contact.phone') AS phone
  FROM "data_takehome"."main"."stg__patients"

)

-- remove square brackets from conditions column
SELECT 
  patient_id,
  practice_id,
  age,
  gender,
  registration_date,
   CASE
    WHEN conditions LIKE '[%' AND conditions LIKE '%]'
    THEN substr(conditions, 2, length(conditions)-2)
    ELSE conditions
  END AS conditions,
  email,
  phone
FROM patients
    );
  
  
[0m12:38:03.556262 [debug] [Thread-6 (]: SQL status: OK in 0.004 seconds
[0m12:38:03.557907 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m12:38:03.558094 [debug] [Thread-6 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */
alter table "data_takehome"."main"."int__patients__dbt_tmp" rename to "int__patients"
[0m12:38:03.558396 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m12:38:03.560900 [debug] [Thread-6 (]: On model.data_takehome.int__patients: COMMIT
[0m12:38:03.561066 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m12:38:03.561205 [debug] [Thread-6 (]: On model.data_takehome.int__patients: COMMIT
[0m12:38:03.561832 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m12:38:03.562867 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m12:38:03.563012 [debug] [Thread-6 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */
drop table if exists "data_takehome"."main"."int__patients__dbt_backup" cascade
[0m12:38:03.563203 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m12:38:03.563796 [debug] [Thread-6 (]: On model.data_takehome.int__patients: Close
[0m12:38:03.570294 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66c3f21-bf1b-4578-b6b2-23b76d710fdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b39e20>]}
[0m12:38:03.570610 [info ] [Thread-6 (]: 5 of 5 OK created sql table model main.int__patients ........................... [[32mOK[0m in 0.03s]
[0m12:38:03.570863 [debug] [Thread-6 (]: Finished running node model.data_takehome.int__patients
[0m12:38:03.571876 [debug] [MainThread]: Using duckdb connection "master"
[0m12:38:03.572015 [debug] [MainThread]: On master: BEGIN
[0m12:38:03.572129 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:38:03.574573 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m12:38:03.574738 [debug] [MainThread]: On master: COMMIT
[0m12:38:03.574863 [debug] [MainThread]: Using duckdb connection "master"
[0m12:38:03.574974 [debug] [MainThread]: On master: COMMIT
[0m12:38:03.575109 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:38:03.575232 [debug] [MainThread]: On master: Close
[0m12:38:03.575746 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:38:03.575859 [debug] [MainThread]: Connection 'model.data_takehome.stg__activities' was properly closed.
[0m12:38:03.575959 [debug] [MainThread]: Connection 'model.data_takehome.stg__patients' was properly closed.
[0m12:38:03.576060 [debug] [MainThread]: Connection 'model.data_takehome.stg__pcns' was properly closed.
[0m12:38:03.576157 [debug] [MainThread]: Connection 'model.data_takehome.stg__practices' was properly closed.
[0m12:38:03.576249 [debug] [MainThread]: Connection 'model.data_takehome.int__patients' was properly closed.
[0m12:38:03.576414 [info ] [MainThread]: 
[0m12:38:03.576559 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m12:38:03.577058 [debug] [MainThread]: Command end result
[0m12:38:03.590790 [info ] [MainThread]: 
[0m12:38:03.591033 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:38:03.591182 [info ] [MainThread]: 
[0m12:38:03.591337 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:38:03.593245 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7341762, "process_user_time": 1.050785, "process_kernel_time": 0.21459, "process_mem_max_rss": "139952128", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:38:03.593526 [debug] [MainThread]: Command `dbt run` succeeded at 12:38:03.593481 after 0.73 seconds
[0m12:38:03.593721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104060c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103da74a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030d4950>]}
[0m12:38:03.593890 [debug] [MainThread]: Flushing usage events
[0m12:55:35.245073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033ac170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e099d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e095b0>]}


============================== 12:55:35.256051 | 38ddd7f2-40dc-465f-9173-03ca13b24139 ==============================
[0m12:55:35.256051 [info ] [MainThread]: Running with dbt=1.8.1
[0m12:55:35.256397 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:55:35.426550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38ddd7f2-40dc-465f-9173-03ca13b24139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039fb170>]}
[0m12:55:35.469677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38ddd7f2-40dc-465f-9173-03ca13b24139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102863da0>]}
[0m12:55:35.470501 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m12:55:35.528844 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m12:55:35.584568 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:55:35.584901 [debug] [MainThread]: Partial parsing: updated file: data_takehome://models/intermediate/int__patients.sql
[0m12:55:35.679755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38ddd7f2-40dc-465f-9173-03ca13b24139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043a7dd0>]}
[0m12:55:35.721030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38ddd7f2-40dc-465f-9173-03ca13b24139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fe7920>]}
[0m12:55:35.721304 [info ] [MainThread]: Found 4 seeds, 5 models, 421 macros
[0m12:55:35.721471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38ddd7f2-40dc-465f-9173-03ca13b24139', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043869f0>]}
[0m12:55:35.722275 [info ] [MainThread]: 
[0m12:55:35.722556 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:55:35.724803 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_data_takehome'
[0m12:55:35.769217 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome"
[0m12:55:35.769450 [debug] [ThreadPool]: On list_data_takehome: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m12:55:35.769590 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:55:35.777443 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m12:55:35.777643 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m12:55:35.778012 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:55:35.778138 [debug] [MainThread]: Connection 'list_data_takehome' was properly closed.
[0m12:55:35.778275 [info ] [MainThread]: 
[0m12:55:35.778421 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.06 seconds (0.06s).
[0m12:55:35.778649 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/qamr/Documents/Development/suvera/data-dbt-takehome/data_takehome.duckdb": Conflicting lock is held in /Applications/DBeaver.app/Contents/MacOS/dbeaver (PID 2132) by user qamr. See also https://duckdb.org/docs/connect/concurrency
[0m12:55:35.780573 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.57066715, "process_user_time": 0.893447, "process_kernel_time": 0.198704, "process_mem_max_rss": "121978880", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:55:35.780838 [debug] [MainThread]: Command `dbt run` failed at 12:55:35.780790 after 0.57 seconds
[0m12:55:35.781011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dc4ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042a07d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045457f0>]}
[0m12:55:35.781170 [debug] [MainThread]: Flushing usage events
[0m12:55:50.644277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10401a8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10494c8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a755e0>]}


============================== 12:55:50.646710 | 8f755226-4af6-4679-b9d9-945b92bb9790 ==============================
[0m12:55:50.646710 [info ] [MainThread]: Running with dbt=1.8.1
[0m12:55:50.647022 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:55:50.735621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f755226-4af6-4679-b9d9-945b92bb9790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bd1760>]}
[0m12:55:50.777769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f755226-4af6-4679-b9d9-945b92bb9790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ae09e0>]}
[0m12:55:50.778328 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m12:55:50.827202 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m12:55:50.869181 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:55:50.869391 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:55:50.885098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f755226-4af6-4679-b9d9-945b92bb9790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a08fe0>]}
[0m12:55:50.920630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f755226-4af6-4679-b9d9-945b92bb9790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ecd880>]}
[0m12:55:50.920891 [info ] [MainThread]: Found 4 seeds, 5 models, 421 macros
[0m12:55:50.921054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f755226-4af6-4679-b9d9-945b92bb9790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a321e0>]}
[0m12:55:50.921844 [info ] [MainThread]: 
[0m12:55:50.922124 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m12:55:50.924289 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_data_takehome'
[0m12:55:50.952949 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome"
[0m12:55:50.955471 [debug] [ThreadPool]: On list_data_takehome: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m12:55:50.955663 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:55:50.975877 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m12:55:50.976848 [debug] [ThreadPool]: On list_data_takehome: Close
[0m12:55:50.977801 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data_takehome, now create_data_takehome_main)
[0m12:55:50.978024 [debug] [ThreadPool]: Creating schema "database: "data_takehome"
schema: "main"
"
[0m12:55:50.981254 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m12:55:50.981425 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
        select type from duckdb_databases()
        where database_name='data_takehome'
        and type='sqlite'
    
  
[0m12:55:50.981557 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:55:50.984438 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m12:55:50.985112 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m12:55:50.985256 [debug] [ThreadPool]: On create_data_takehome_main: BEGIN
[0m12:55:50.985402 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:55:50.985522 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m12:55:50.985643 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
    
        create schema if not exists "data_takehome"."main"
    
[0m12:55:50.986263 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:55:50.986656 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m12:55:50.986780 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m12:55:50.986890 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m12:55:50.987024 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m12:55:50.987149 [debug] [ThreadPool]: On create_data_takehome_main: Close
[0m12:55:50.988189 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_data_takehome_main, now list_data_takehome_main)
[0m12:55:50.990764 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m12:55:50.990923 [debug] [ThreadPool]: On list_data_takehome_main: BEGIN
[0m12:55:50.991056 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:55:50.993282 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m12:55:50.993493 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m12:55:50.993673 [debug] [ThreadPool]: On list_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome_main"} */
select
      'data_takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'data_takehome'
  
[0m12:55:51.007753 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m12:55:51.011423 [debug] [ThreadPool]: On list_data_takehome_main: ROLLBACK
[0m12:55:51.012380 [debug] [ThreadPool]: Failed to rollback 'list_data_takehome_main'
[0m12:55:51.012539 [debug] [ThreadPool]: On list_data_takehome_main: Close
[0m12:55:51.013948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f755226-4af6-4679-b9d9-945b92bb9790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b22ba0>]}
[0m12:55:51.014172 [debug] [MainThread]: Using duckdb connection "master"
[0m12:55:51.014310 [debug] [MainThread]: On master: BEGIN
[0m12:55:51.014430 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:55:51.016739 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m12:55:51.016908 [debug] [MainThread]: On master: COMMIT
[0m12:55:51.017044 [debug] [MainThread]: Using duckdb connection "master"
[0m12:55:51.017174 [debug] [MainThread]: On master: COMMIT
[0m12:55:51.017313 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:55:51.017437 [debug] [MainThread]: On master: Close
[0m12:55:51.017887 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m12:55:51.018049 [info ] [MainThread]: 
[0m12:55:51.020113 [debug] [Thread-1 (]: Began running node model.data_takehome.stg__activities
[0m12:55:51.020303 [debug] [Thread-2 (]: Began running node model.data_takehome.stg__patients
[0m12:55:51.020688 [debug] [Thread-3 (]: Began running node model.data_takehome.stg__pcns
[0m12:55:51.020845 [debug] [Thread-4 (]: Began running node model.data_takehome.stg__practices
[0m12:55:51.020550 [info ] [Thread-1 (]: 1 of 5 START sql view model main.stg__activities ............................... [RUN]
[0m12:55:51.021080 [info ] [Thread-2 (]: 2 of 5 START sql view model main.stg__patients ................................. [RUN]
[0m12:55:51.021321 [info ] [Thread-3 (]: 3 of 5 START sql view model main.stg__pcns ..................................... [RUN]
[0m12:55:51.021557 [info ] [Thread-4 (]: 4 of 5 START sql view model main.stg__practices ................................ [RUN]
[0m12:55:51.021779 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_takehome_main, now model.data_takehome.stg__activities)
[0m12:55:51.022002 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.data_takehome.stg__patients'
[0m12:55:51.022195 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.data_takehome.stg__pcns'
[0m12:55:51.022379 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.data_takehome.stg__practices'
[0m12:55:51.022528 [debug] [Thread-1 (]: Began compiling node model.data_takehome.stg__activities
[0m12:55:51.022671 [debug] [Thread-2 (]: Began compiling node model.data_takehome.stg__patients
[0m12:55:51.022808 [debug] [Thread-3 (]: Began compiling node model.data_takehome.stg__pcns
[0m12:55:51.022941 [debug] [Thread-4 (]: Began compiling node model.data_takehome.stg__practices
[0m12:55:51.026445 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_takehome.stg__activities"
[0m12:55:51.027655 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_takehome.stg__patients"
[0m12:55:51.029391 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_takehome.stg__pcns"
[0m12:55:51.030567 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_takehome.stg__practices"
[0m12:55:51.031386 [debug] [Thread-1 (]: Began executing node model.data_takehome.stg__activities
[0m12:55:51.036977 [debug] [Thread-4 (]: Began executing node model.data_takehome.stg__practices
[0m12:55:51.037146 [debug] [Thread-2 (]: Began executing node model.data_takehome.stg__patients
[0m12:55:51.046734 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_takehome.stg__activities"
[0m12:55:51.046939 [debug] [Thread-3 (]: Began executing node model.data_takehome.stg__pcns
[0m12:55:51.048495 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_takehome.stg__practices"
[0m12:55:51.049977 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_takehome.stg__patients"
[0m12:55:51.051601 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_takehome.stg__pcns"
[0m12:55:51.052004 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m12:55:51.052260 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: BEGIN
[0m12:55:51.052428 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:55:51.054967 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m12:55:51.055174 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m12:55:51.055341 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m12:55:51.055515 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m12:55:51.055702 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m12:55:51.055849 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: BEGIN
[0m12:55:51.056009 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */

  
  create view "data_takehome"."main"."stg__activities__dbt_tmp" as (
    with activities as (
select * from "data_takehome"."main"."raw_activities" )

select * from activities
  );

[0m12:55:51.056171 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: BEGIN
[0m12:55:51.056310 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: BEGIN
[0m12:55:51.056452 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:55:51.056613 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m12:55:51.056765 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:55:51.056980 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:55:51.057153 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:55:51.060253 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m12:55:51.060421 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m12:55:51.060577 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m12:55:51.060719 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m12:55:51.060875 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */
alter view "data_takehome"."main"."stg__activities" rename to "stg__activities__dbt_backup"
[0m12:55:51.061019 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m12:55:51.061153 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m12:55:51.061319 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */

  
  create view "data_takehome"."main"."stg__patients__dbt_tmp" as (
    with patients as (
select * from "data_takehome"."main"."raw_patients" )

select * from patients
  );

[0m12:55:51.061521 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */

  
  create view "data_takehome"."main"."stg__practices__dbt_tmp" as (
    with practices as (
select * from "data_takehome"."main"."raw_practices" )

select * from practices
  );

[0m12:55:51.061682 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */

  
  create view "data_takehome"."main"."stg__pcns__dbt_tmp" as (
    with pcns as (
select * from "data_takehome"."main"."raw_pcns" )

select * from pcns
  );

[0m12:55:51.061840 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:55:51.063258 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m12:55:51.063427 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */
alter view "data_takehome"."main"."stg__activities__dbt_tmp" rename to "stg__activities"
[0m12:55:51.063601 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m12:55:51.063764 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m12:55:51.065128 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m12:55:51.065278 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m12:55:51.065426 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m12:55:51.067181 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m12:55:51.067345 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */
alter view "data_takehome"."main"."stg__patients" rename to "stg__patients__dbt_backup"
[0m12:55:51.068730 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m12:55:51.075186 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */
alter view "data_takehome"."main"."stg__pcns" rename to "stg__pcns__dbt_backup"
[0m12:55:51.076731 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: COMMIT
[0m12:55:51.076959 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */
alter view "data_takehome"."main"."stg__practices" rename to "stg__practices__dbt_backup"
[0m12:55:51.077181 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m12:55:51.077367 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m12:55:51.077512 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m12:55:51.078903 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m12:55:51.079073 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:55:51.079230 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: COMMIT
[0m12:55:51.080401 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m12:55:51.080557 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */
alter view "data_takehome"."main"."stg__patients__dbt_tmp" rename to "stg__patients"
[0m12:55:51.081778 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m12:55:51.081963 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */
alter view "data_takehome"."main"."stg__pcns__dbt_tmp" rename to "stg__pcns"
[0m12:55:51.082175 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */
alter view "data_takehome"."main"."stg__practices__dbt_tmp" rename to "stg__practices"
[0m12:55:51.082403 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m12:55:51.082647 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m12:55:51.082779 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m12:55:51.083430 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: COMMIT
[0m12:55:51.083634 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:55:51.085926 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m12:55:51.086659 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: COMMIT
[0m12:55:51.086821 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m12:55:51.087542 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: COMMIT
[0m12:55:51.087709 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */
drop view if exists "data_takehome"."main"."stg__activities__dbt_backup" cascade
[0m12:55:51.087870 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m12:55:51.088018 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: COMMIT
[0m12:55:51.088158 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m12:55:51.088317 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: COMMIT
[0m12:55:51.088502 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: COMMIT
[0m12:55:51.088667 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m12:55:51.088817 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m12:55:51.089986 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: Close
[0m12:55:51.090153 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:55:51.091228 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m12:55:51.091707 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m12:55:51.092099 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f755226-4af6-4679-b9d9-945b92bb9790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105380bc0>]}
[0m12:55:51.093092 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m12:55:51.093252 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */
drop view if exists "data_takehome"."main"."stg__patients__dbt_backup" cascade
[0m12:55:51.094264 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m12:55:51.094538 [info ] [Thread-1 (]: 1 of 5 OK created sql view model main.stg__activities .......................... [[32mOK[0m in 0.07s]
[0m12:55:51.094720 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */
drop view if exists "data_takehome"."main"."stg__pcns__dbt_backup" cascade
[0m12:55:51.094914 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */
drop view if exists "data_takehome"."main"."stg__practices__dbt_backup" cascade
[0m12:55:51.095172 [debug] [Thread-1 (]: Finished running node model.data_takehome.stg__activities
[0m12:55:51.095408 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m12:55:51.096028 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: Close
[0m12:55:51.096230 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f755226-4af6-4679-b9d9-945b92bb9790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c7e90>]}
[0m12:55:51.096675 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m12:55:51.096827 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m12:55:51.096533 [info ] [Thread-2 (]: 2 of 5 OK created sql view model main.stg__patients ............................ [[32mOK[0m in 0.07s]
[0m12:55:51.097405 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: Close
[0m12:55:51.097949 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: Close
[0m12:55:51.098165 [debug] [Thread-2 (]: Finished running node model.data_takehome.stg__patients
[0m12:55:51.098369 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f755226-4af6-4679-b9d9-945b92bb9790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052581a0>]}
[0m12:55:51.100639 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f755226-4af6-4679-b9d9-945b92bb9790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105374740>]}
[0m12:55:51.101151 [debug] [Thread-6 (]: Began running node model.data_takehome.int__patients
[0m12:55:51.100998 [info ] [Thread-4 (]: 4 of 5 OK created sql view model main.stg__practices ........................... [[32mOK[0m in 0.08s]
[0m12:55:51.101447 [info ] [Thread-3 (]: 3 of 5 OK created sql view model main.stg__pcns ................................ [[32mOK[0m in 0.08s]
[0m12:55:51.101677 [info ] [Thread-6 (]: 5 of 5 START sql table model main.int__patients ................................ [RUN]
[0m12:55:51.101924 [debug] [Thread-4 (]: Finished running node model.data_takehome.stg__practices
[0m12:55:51.102145 [debug] [Thread-3 (]: Finished running node model.data_takehome.stg__pcns
[0m12:55:51.102350 [debug] [Thread-6 (]: Acquiring new duckdb connection 'model.data_takehome.int__patients'
[0m12:55:51.102573 [debug] [Thread-6 (]: Began compiling node model.data_takehome.int__patients
[0m12:55:51.103854 [debug] [Thread-6 (]: Writing injected SQL for node "model.data_takehome.int__patients"
[0m12:55:51.104368 [debug] [Thread-6 (]: Began executing node model.data_takehome.int__patients
[0m12:55:51.113983 [debug] [Thread-6 (]: Writing runtime sql for node "model.data_takehome.int__patients"
[0m12:55:51.114631 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m12:55:51.114810 [debug] [Thread-6 (]: On model.data_takehome.int__patients: BEGIN
[0m12:55:51.114955 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m12:55:51.117349 [debug] [Thread-6 (]: SQL status: OK in 0.002 seconds
[0m12:55:51.117527 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m12:55:51.117710 [debug] [Thread-6 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */

  
    
    

    create  table
      "data_takehome"."main"."int__patients__dbt_tmp"
  
    as (
      WITH patients AS (
  SELECT 
    json_extract_string(data, '$.patient_id') AS patient_id,
    json_extract_string(data, '$.practice_id') AS practice_id,
    json_extract_string(data, '$.age') AS age,
    json_extract_string(data, '$.gender') AS gender,
    json_extract_string(data, '$.registration_date') AS registration_date,
    json_extract_string(data, '$.conditions') AS conditions,
    json_extract_string(data, '$.contact.email') AS email,
    json_extract_string(data, '$.contact.phone') AS phone
  FROM "data_takehome"."main"."stg__patients"

)

-- remove square brackets from conditions column
SELECT 
  patient_id,
  practice_id,
  age,
  gender,
  registration_date,
   CASE
    WHEN (conditions LIKE '[%' AND conditions LIKE '%]')
    or
    (conditions LIKE '"%' AND conditions LIKE '%"')
    THEN substr(conditions, 2, length(conditions)-2)
    ELSE conditions
  END AS conditions,
  email,
  phone
FROM patients
    );
  
  
[0m12:55:51.121452 [debug] [Thread-6 (]: SQL status: OK in 0.004 seconds
[0m12:55:51.123711 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m12:55:51.123874 [debug] [Thread-6 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */
alter table "data_takehome"."main"."int__patients" rename to "int__patients__dbt_backup"
[0m12:55:51.124174 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m12:55:51.125409 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m12:55:51.125554 [debug] [Thread-6 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */
alter table "data_takehome"."main"."int__patients__dbt_tmp" rename to "int__patients"
[0m12:55:51.125751 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m12:55:51.128190 [debug] [Thread-6 (]: On model.data_takehome.int__patients: COMMIT
[0m12:55:51.128361 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m12:55:51.128507 [debug] [Thread-6 (]: On model.data_takehome.int__patients: COMMIT
[0m12:55:51.129158 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m12:55:51.130183 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m12:55:51.130330 [debug] [Thread-6 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */
drop table if exists "data_takehome"."main"."int__patients__dbt_backup" cascade
[0m12:55:51.130593 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m12:55:51.131173 [debug] [Thread-6 (]: On model.data_takehome.int__patients: Close
[0m12:55:51.135982 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f755226-4af6-4679-b9d9-945b92bb9790', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10542abd0>]}
[0m12:55:51.136286 [info ] [Thread-6 (]: 5 of 5 OK created sql table model main.int__patients ........................... [[32mOK[0m in 0.03s]
[0m12:55:51.136540 [debug] [Thread-6 (]: Finished running node model.data_takehome.int__patients
[0m12:55:51.137437 [debug] [MainThread]: Using duckdb connection "master"
[0m12:55:51.137618 [debug] [MainThread]: On master: BEGIN
[0m12:55:51.137751 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:55:51.140289 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m12:55:51.140470 [debug] [MainThread]: On master: COMMIT
[0m12:55:51.140613 [debug] [MainThread]: Using duckdb connection "master"
[0m12:55:51.140736 [debug] [MainThread]: On master: COMMIT
[0m12:55:51.140877 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m12:55:51.141007 [debug] [MainThread]: On master: Close
[0m12:55:51.141483 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:55:51.141623 [debug] [MainThread]: Connection 'model.data_takehome.stg__activities' was properly closed.
[0m12:55:51.141734 [debug] [MainThread]: Connection 'model.data_takehome.stg__patients' was properly closed.
[0m12:55:51.141835 [debug] [MainThread]: Connection 'model.data_takehome.stg__pcns' was properly closed.
[0m12:55:51.141933 [debug] [MainThread]: Connection 'model.data_takehome.stg__practices' was properly closed.
[0m12:55:51.142030 [debug] [MainThread]: Connection 'model.data_takehome.int__patients' was properly closed.
[0m12:55:51.142197 [info ] [MainThread]: 
[0m12:55:51.142344 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m12:55:51.142856 [debug] [MainThread]: Command end result
[0m12:55:51.155583 [info ] [MainThread]: 
[0m12:55:51.155802 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:55:51.155950 [info ] [MainThread]: 
[0m12:55:51.156097 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:55:51.157366 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5418573, "process_user_time": 0.983061, "process_kernel_time": 0.151787, "process_mem_max_rss": "138035200", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m12:55:51.157595 [debug] [MainThread]: Command `dbt run` succeeded at 12:55:51.157554 after 0.54 seconds
[0m12:55:51.157765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a754f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aa1730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044bef90>]}
[0m12:55:51.157921 [debug] [MainThread]: Flushing usage events
[0m13:00:13.044044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f840e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069e5940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069e5550>]}


============================== 13:00:13.051190 | f2daefcb-77e2-459f-a4d4-ae8db787dd8f ==============================
[0m13:00:13.051190 [info ] [MainThread]: Running with dbt=1.8.1
[0m13:00:13.051525 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:00:13.221644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2daefcb-77e2-459f-a4d4-ae8db787dd8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a698e0>]}
[0m13:00:13.264621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2daefcb-77e2-459f-a4d4-ae8db787dd8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f4edb0>]}
[0m13:00:13.265451 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m13:00:13.321409 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m13:00:13.377045 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:00:13.377359 [debug] [MainThread]: Partial parsing: updated file: data_takehome://models/intermediate/int__patients.sql
[0m13:00:13.473332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2daefcb-77e2-459f-a4d4-ae8db787dd8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f84410>]}
[0m13:00:13.514010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2daefcb-77e2-459f-a4d4-ae8db787dd8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f59250>]}
[0m13:00:13.514292 [info ] [MainThread]: Found 4 seeds, 5 models, 421 macros
[0m13:00:13.514463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2daefcb-77e2-459f-a4d4-ae8db787dd8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f5e6f0>]}
[0m13:00:13.515281 [info ] [MainThread]: 
[0m13:00:13.515565 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:00:13.517785 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_data_takehome'
[0m13:00:13.560210 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome"
[0m13:00:13.560453 [debug] [ThreadPool]: On list_data_takehome: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m13:00:13.560597 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:13.579213 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m13:00:13.580477 [debug] [ThreadPool]: On list_data_takehome: Close
[0m13:00:13.581559 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data_takehome, now create_data_takehome_main)
[0m13:00:13.581814 [debug] [ThreadPool]: Creating schema "database: "data_takehome"
schema: "main"
"
[0m13:00:13.585145 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m13:00:13.585313 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
        select type from duckdb_databases()
        where database_name='data_takehome'
        and type='sqlite'
    
  
[0m13:00:13.585445 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:00:13.588304 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:00:13.588940 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m13:00:13.589078 [debug] [ThreadPool]: On create_data_takehome_main: BEGIN
[0m13:00:13.589226 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:00:13.589345 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m13:00:13.589464 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
    
        create schema if not exists "data_takehome"."main"
    
[0m13:00:13.590087 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:00:13.590467 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m13:00:13.590592 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m13:00:13.590704 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m13:00:13.590844 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:00:13.590966 [debug] [ThreadPool]: On create_data_takehome_main: Close
[0m13:00:13.592017 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_data_takehome_main, now list_data_takehome_main)
[0m13:00:13.595304 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m13:00:13.595467 [debug] [ThreadPool]: On list_data_takehome_main: BEGIN
[0m13:00:13.595587 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:00:13.597916 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m13:00:13.598077 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m13:00:13.598218 [debug] [ThreadPool]: On list_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome_main"} */
select
      'data_takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'data_takehome'
  
[0m13:00:13.611876 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m13:00:13.614980 [debug] [ThreadPool]: On list_data_takehome_main: ROLLBACK
[0m13:00:13.616045 [debug] [ThreadPool]: Failed to rollback 'list_data_takehome_main'
[0m13:00:13.616194 [debug] [ThreadPool]: On list_data_takehome_main: Close
[0m13:00:13.617752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2daefcb-77e2-459f-a4d4-ae8db787dd8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071bfe00>]}
[0m13:00:13.617990 [debug] [MainThread]: Using duckdb connection "master"
[0m13:00:13.618126 [debug] [MainThread]: On master: BEGIN
[0m13:00:13.618247 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:00:13.620576 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m13:00:13.620747 [debug] [MainThread]: On master: COMMIT
[0m13:00:13.620882 [debug] [MainThread]: Using duckdb connection "master"
[0m13:00:13.621004 [debug] [MainThread]: On master: COMMIT
[0m13:00:13.621138 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:00:13.621264 [debug] [MainThread]: On master: Close
[0m13:00:13.621772 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m13:00:13.621984 [info ] [MainThread]: 
[0m13:00:13.624265 [debug] [Thread-1 (]: Began running node model.data_takehome.stg__activities
[0m13:00:13.624500 [debug] [Thread-2 (]: Began running node model.data_takehome.stg__patients
[0m13:00:13.624671 [debug] [Thread-3 (]: Began running node model.data_takehome.stg__pcns
[0m13:00:13.625054 [debug] [Thread-4 (]: Began running node model.data_takehome.stg__practices
[0m13:00:13.624917 [info ] [Thread-1 (]: 1 of 5 START sql view model main.stg__activities ............................... [RUN]
[0m13:00:13.625305 [info ] [Thread-2 (]: 2 of 5 START sql view model main.stg__patients ................................. [RUN]
[0m13:00:13.625535 [info ] [Thread-3 (]: 3 of 5 START sql view model main.stg__pcns ..................................... [RUN]
[0m13:00:13.625755 [info ] [Thread-4 (]: 4 of 5 START sql view model main.stg__practices ................................ [RUN]
[0m13:00:13.626004 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_takehome_main, now model.data_takehome.stg__activities)
[0m13:00:13.626228 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.data_takehome.stg__patients'
[0m13:00:13.626432 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.data_takehome.stg__pcns'
[0m13:00:13.626623 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.data_takehome.stg__practices'
[0m13:00:13.626812 [debug] [Thread-1 (]: Began compiling node model.data_takehome.stg__activities
[0m13:00:13.626999 [debug] [Thread-2 (]: Began compiling node model.data_takehome.stg__patients
[0m13:00:13.627146 [debug] [Thread-3 (]: Began compiling node model.data_takehome.stg__pcns
[0m13:00:13.627291 [debug] [Thread-4 (]: Began compiling node model.data_takehome.stg__practices
[0m13:00:13.630756 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_takehome.stg__activities"
[0m13:00:13.632047 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_takehome.stg__patients"
[0m13:00:13.633365 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_takehome.stg__pcns"
[0m13:00:13.634548 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_takehome.stg__practices"
[0m13:00:13.635601 [debug] [Thread-4 (]: Began executing node model.data_takehome.stg__practices
[0m13:00:13.641774 [debug] [Thread-2 (]: Began executing node model.data_takehome.stg__patients
[0m13:00:13.651787 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_takehome.stg__patients"
[0m13:00:13.652167 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_takehome.stg__practices"
[0m13:00:13.652439 [debug] [Thread-1 (]: Began executing node model.data_takehome.stg__activities
[0m13:00:13.654031 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_takehome.stg__activities"
[0m13:00:13.654223 [debug] [Thread-3 (]: Began executing node model.data_takehome.stg__pcns
[0m13:00:13.656315 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_takehome.stg__pcns"
[0m13:00:13.656552 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m13:00:13.656747 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m13:00:13.656902 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: BEGIN
[0m13:00:13.657079 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: BEGIN
[0m13:00:13.657239 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m13:00:13.657397 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:00:13.657560 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m13:00:13.657765 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:00:13.657911 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: BEGIN
[0m13:00:13.660360 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: BEGIN
[0m13:00:13.660532 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m13:00:13.660730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:00:13.660890 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:00:13.661024 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:00:13.661171 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m13:00:13.661334 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m13:00:13.661480 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:00:13.661646 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */

  
  create view "data_takehome"."main"."stg__practices__dbt_tmp" as (
    with practices as (
select * from "data_takehome"."main"."raw_practices" )

select * from practices
  );

[0m13:00:13.661797 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:00:13.661950 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */

  
  create view "data_takehome"."main"."stg__patients__dbt_tmp" as (
    with patients as (
select * from "data_takehome"."main"."raw_patients" )

select * from patients
  );

[0m13:00:13.662092 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m13:00:13.662248 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m13:00:13.662428 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */

  
  create view "data_takehome"."main"."stg__activities__dbt_tmp" as (
    with activities as (
select * from "data_takehome"."main"."raw_activities" )

select * from activities
  );

[0m13:00:13.662600 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */

  
  create view "data_takehome"."main"."stg__pcns__dbt_tmp" as (
    with pcns as (
select * from "data_takehome"."main"."raw_pcns" )

select * from pcns
  );

[0m13:00:13.662746 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:00:13.662902 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:00:13.666017 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m13:00:13.667402 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m13:00:13.667587 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m13:00:13.667738 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m13:00:13.667877 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */
alter view "data_takehome"."main"."stg__practices" rename to "stg__practices__dbt_backup"
[0m13:00:13.668040 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */
alter view "data_takehome"."main"."stg__patients" rename to "stg__patients__dbt_backup"
[0m13:00:13.669369 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m13:00:13.670643 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m13:00:13.670864 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */
alter view "data_takehome"."main"."stg__activities" rename to "stg__activities__dbt_backup"
[0m13:00:13.671047 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */
alter view "data_takehome"."main"."stg__pcns" rename to "stg__pcns__dbt_backup"
[0m13:00:13.671216 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m13:00:13.672450 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m13:00:13.672607 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */
alter view "data_takehome"."main"."stg__patients__dbt_tmp" rename to "stg__patients"
[0m13:00:13.672825 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:00:13.674056 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m13:00:13.674217 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */
alter view "data_takehome"."main"."stg__pcns__dbt_tmp" rename to "stg__pcns"
[0m13:00:13.674388 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:00:13.675618 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m13:00:13.675776 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */
alter view "data_takehome"."main"."stg__activities__dbt_tmp" rename to "stg__activities"
[0m13:00:13.675970 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m13:00:13.677300 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m13:00:13.677475 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */
alter view "data_takehome"."main"."stg__practices__dbt_tmp" rename to "stg__practices"
[0m13:00:13.677646 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m13:00:13.684077 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m13:00:13.686777 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: COMMIT
[0m13:00:13.686959 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m13:00:13.687109 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: COMMIT
[0m13:00:13.687273 [debug] [Thread-3 (]: SQL status: OK in 0.013 seconds
[0m13:00:13.687939 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: COMMIT
[0m13:00:13.688087 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m13:00:13.688222 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: COMMIT
[0m13:00:13.688593 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: COMMIT
[0m13:00:13.688756 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m13:00:13.688904 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: COMMIT
[0m13:00:13.689098 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:00:13.691397 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m13:00:13.691576 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */
drop view if exists "data_takehome"."main"."stg__activities__dbt_backup" cascade
[0m13:00:13.691744 [debug] [Thread-4 (]: SQL status: OK in 0.014 seconds
[0m13:00:13.691901 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:00:13.692051 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m13:00:13.692758 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: COMMIT
[0m13:00:13.694538 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m13:00:13.694689 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:00:13.695694 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m13:00:13.695858 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m13:00:13.696026 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */
drop view if exists "data_takehome"."main"."stg__patients__dbt_backup" cascade
[0m13:00:13.697153 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: Close
[0m13:00:13.697325 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */
drop view if exists "data_takehome"."main"."stg__pcns__dbt_backup" cascade
[0m13:00:13.697485 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: COMMIT
[0m13:00:13.698241 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2daefcb-77e2-459f-a4d4-ae8db787dd8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053d3440>]}
[0m13:00:13.698417 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:00:13.698876 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:00:13.698725 [info ] [Thread-1 (]: 1 of 5 OK created sql view model main.stg__activities .......................... [[32mOK[0m in 0.07s]
[0m13:00:13.699541 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: Close
[0m13:00:13.699678 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:00:13.700251 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: Close
[0m13:00:13.700490 [debug] [Thread-1 (]: Finished running node model.data_takehome.stg__activities
[0m13:00:13.700707 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2daefcb-77e2-459f-a4d4-ae8db787dd8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10742f3e0>]}
[0m13:00:13.701679 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m13:00:13.701882 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2daefcb-77e2-459f-a4d4-ae8db787dd8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107414110>]}
[0m13:00:13.702359 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */
drop view if exists "data_takehome"."main"."stg__practices__dbt_backup" cascade
[0m13:00:13.702221 [info ] [Thread-2 (]: 2 of 5 OK created sql view model main.stg__patients ............................ [[32mOK[0m in 0.07s]
[0m13:00:13.702675 [info ] [Thread-3 (]: 3 of 5 OK created sql view model main.stg__pcns ................................ [[32mOK[0m in 0.08s]
[0m13:00:13.702949 [debug] [Thread-2 (]: Finished running node model.data_takehome.stg__patients
[0m13:00:13.703174 [debug] [Thread-3 (]: Finished running node model.data_takehome.stg__pcns
[0m13:00:13.703330 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:00:13.704116 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: Close
[0m13:00:13.704314 [debug] [Thread-6 (]: Began running node model.data_takehome.int__patients
[0m13:00:13.708954 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2daefcb-77e2-459f-a4d4-ae8db787dd8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074150d0>]}
[0m13:00:13.709229 [info ] [Thread-6 (]: 5 of 5 START sql table model main.int__patients ................................ [RUN]
[0m13:00:13.709756 [debug] [Thread-6 (]: Acquiring new duckdb connection 'model.data_takehome.int__patients'
[0m13:00:13.709538 [info ] [Thread-4 (]: 4 of 5 OK created sql view model main.stg__practices ........................... [[32mOK[0m in 0.08s]
[0m13:00:13.709986 [debug] [Thread-6 (]: Began compiling node model.data_takehome.int__patients
[0m13:00:13.710222 [debug] [Thread-4 (]: Finished running node model.data_takehome.stg__practices
[0m13:00:13.711790 [debug] [Thread-6 (]: Writing injected SQL for node "model.data_takehome.int__patients"
[0m13:00:13.712257 [debug] [Thread-6 (]: Began executing node model.data_takehome.int__patients
[0m13:00:13.721581 [debug] [Thread-6 (]: Writing runtime sql for node "model.data_takehome.int__patients"
[0m13:00:13.722247 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m13:00:13.722410 [debug] [Thread-6 (]: On model.data_takehome.int__patients: BEGIN
[0m13:00:13.722554 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m13:00:13.724987 [debug] [Thread-6 (]: SQL status: OK in 0.002 seconds
[0m13:00:13.725178 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m13:00:13.725362 [debug] [Thread-6 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */

  
    
    

    create  table
      "data_takehome"."main"."int__patients__dbt_tmp"
  
    as (
      WITH patients AS (
  SELECT 
    json_extract_string(data, '$.patient_id') AS patient_id,
    json_extract_string(data, '$.practice_id') AS practice_id,
    json_extract_string(data, '$.age') AS age,
    json_extract_string(data, '$.gender') AS gender,
    json_extract_string(data, '$.registration_date') AS registration_date,
    json_extract_string(data, '$.conditions') AS conditions,
    json_extract_string(data, '$.contact.email') AS email,
    json_extract_string(data, '$.contact.phone') AS phone
  FROM "data_takehome"."main"."stg__patients"

)

-- remove square brackets from conditions column
SELECT 
  patient_id,
  practice_id,
  age,
  gender,
  registration_date,
  replace(CASE
    WHEN conditions LIKE '[%' AND conditions LIKE '%]'
    THEN substr(conditions, 2, length(conditions)-2)
    ELSE conditions
  END, '"', '') as conditions2,
   CASE
    WHEN conditions LIKE '[%' AND conditions LIKE '%]'
    THEN substr(conditions, 2, length(conditions)-2)
    ELSE conditions
  END AS conditions,
  email,
  phone
FROM patients
    );
  
  
[0m13:00:13.730944 [debug] [Thread-6 (]: SQL status: OK in 0.005 seconds
[0m13:00:13.732512 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m13:00:13.732688 [debug] [Thread-6 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */
alter table "data_takehome"."main"."int__patients" rename to "int__patients__dbt_backup"
[0m13:00:13.733160 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m13:00:13.734381 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m13:00:13.734533 [debug] [Thread-6 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */
alter table "data_takehome"."main"."int__patients__dbt_tmp" rename to "int__patients"
[0m13:00:13.734729 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m13:00:13.737373 [debug] [Thread-6 (]: On model.data_takehome.int__patients: COMMIT
[0m13:00:13.737559 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m13:00:13.737714 [debug] [Thread-6 (]: On model.data_takehome.int__patients: COMMIT
[0m13:00:13.738362 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m13:00:13.739382 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m13:00:13.739531 [debug] [Thread-6 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */
drop table if exists "data_takehome"."main"."int__patients__dbt_backup" cascade
[0m13:00:13.739794 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m13:00:13.740375 [debug] [Thread-6 (]: On model.data_takehome.int__patients: Close
[0m13:00:13.746654 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2daefcb-77e2-459f-a4d4-ae8db787dd8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10743d790>]}
[0m13:00:13.746987 [info ] [Thread-6 (]: 5 of 5 OK created sql table model main.int__patients ........................... [[32mOK[0m in 0.04s]
[0m13:00:13.747253 [debug] [Thread-6 (]: Finished running node model.data_takehome.int__patients
[0m13:00:13.748281 [debug] [MainThread]: Using duckdb connection "master"
[0m13:00:13.748430 [debug] [MainThread]: On master: BEGIN
[0m13:00:13.748552 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:00:13.750986 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m13:00:13.751146 [debug] [MainThread]: On master: COMMIT
[0m13:00:13.751271 [debug] [MainThread]: Using duckdb connection "master"
[0m13:00:13.751385 [debug] [MainThread]: On master: COMMIT
[0m13:00:13.751516 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:00:13.751637 [debug] [MainThread]: On master: Close
[0m13:00:13.752070 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:00:13.752189 [debug] [MainThread]: Connection 'model.data_takehome.stg__activities' was properly closed.
[0m13:00:13.752291 [debug] [MainThread]: Connection 'model.data_takehome.stg__patients' was properly closed.
[0m13:00:13.752389 [debug] [MainThread]: Connection 'model.data_takehome.stg__pcns' was properly closed.
[0m13:00:13.752482 [debug] [MainThread]: Connection 'model.data_takehome.stg__practices' was properly closed.
[0m13:00:13.752577 [debug] [MainThread]: Connection 'model.data_takehome.int__patients' was properly closed.
[0m13:00:13.752747 [info ] [MainThread]: 
[0m13:00:13.752941 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m13:00:13.753519 [debug] [MainThread]: Command end result
[0m13:00:13.766867 [info ] [MainThread]: 
[0m13:00:13.767107 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:00:13.767261 [info ] [MainThread]: 
[0m13:00:13.767418 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:00:13.769346 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7586181, "process_user_time": 1.062804, "process_kernel_time": 0.212951, "process_mem_max_rss": "141770752", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:00:13.769634 [debug] [MainThread]: Command `dbt run` succeeded at 13:00:13.769587 after 0.76 seconds
[0m13:00:13.769835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069a0b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066f8b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106db2930>]}
[0m13:00:13.770059 [debug] [MainThread]: Flushing usage events
[0m13:01:24.861770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cd8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083c48f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108735610>]}


============================== 13:01:24.864855 | e32ad828-7b14-4c12-b05d-67c51791aa68 ==============================
[0m13:01:24.864855 [info ] [MainThread]: Running with dbt=1.8.1
[0m13:01:24.865168 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:01:25.022583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e32ad828-7b14-4c12-b05d-67c51791aa68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108898980>]}
[0m13:01:25.064646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e32ad828-7b14-4c12-b05d-67c51791aa68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10847d580>]}
[0m13:01:25.065951 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m13:01:25.122413 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m13:01:25.177771 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:01:25.178112 [debug] [MainThread]: Partial parsing: updated file: data_takehome://models/intermediate/int__patients.sql
[0m13:01:25.273036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e32ad828-7b14-4c12-b05d-67c51791aa68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cd3ef0>]}
[0m13:01:25.312655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e32ad828-7b14-4c12-b05d-67c51791aa68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a30f80>]}
[0m13:01:25.312928 [info ] [MainThread]: Found 4 seeds, 5 models, 421 macros
[0m13:01:25.313097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e32ad828-7b14-4c12-b05d-67c51791aa68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108711640>]}
[0m13:01:25.313899 [info ] [MainThread]: 
[0m13:01:25.314173 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:01:25.316379 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_data_takehome'
[0m13:01:25.347145 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome"
[0m13:01:25.347370 [debug] [ThreadPool]: On list_data_takehome: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m13:01:25.347512 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:25.356270 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m13:01:25.356492 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m13:01:25.356862 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:01:25.356991 [debug] [MainThread]: Connection 'list_data_takehome' was properly closed.
[0m13:01:25.357126 [info ] [MainThread]: 
[0m13:01:25.357274 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m13:01:25.357494 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/qamr/Documents/Development/suvera/data-dbt-takehome/data_takehome.duckdb": Conflicting lock is held in /opt/homebrew/Cellar/duckdb/1.1.1/bin/duckdb (PID 2266) by user qamr. See also https://duckdb.org/docs/connect/concurrency
[0m13:01:25.359340 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.52962095, "process_user_time": 0.892254, "process_kernel_time": 0.180215, "process_mem_max_rss": "122929152", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:01:25.359701 [debug] [MainThread]: Command `dbt run` failed at 13:01:25.359630 after 0.53 seconds
[0m13:01:25.359935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cd8050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086f6b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108910fb0>]}
[0m13:01:25.360132 [debug] [MainThread]: Flushing usage events
[0m13:01:46.006225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103078290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10421b020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046f9580>]}


============================== 13:01:46.009262 | 25beec6a-e274-4795-92e1-90916d6d83b1 ==============================
[0m13:01:46.009262 [info ] [MainThread]: Running with dbt=1.8.1
[0m13:01:46.009585 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:01:46.154427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25beec6a-e274-4795-92e1-90916d6d83b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10485fe60>]}
[0m13:01:46.196696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25beec6a-e274-4795-92e1-90916d6d83b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041417c0>]}
[0m13:01:46.198140 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m13:01:46.253275 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m13:01:46.306856 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:01:46.307084 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:01:46.322900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25beec6a-e274-4795-92e1-90916d6d83b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10485e660>]}
[0m13:01:46.363154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25beec6a-e274-4795-92e1-90916d6d83b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047ffe00>]}
[0m13:01:46.363439 [info ] [MainThread]: Found 4 seeds, 5 models, 421 macros
[0m13:01:46.363618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25beec6a-e274-4795-92e1-90916d6d83b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b40bf0>]}
[0m13:01:46.364446 [info ] [MainThread]: 
[0m13:01:46.364734 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:01:46.366964 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_data_takehome'
[0m13:01:46.399150 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome"
[0m13:01:46.399399 [debug] [ThreadPool]: On list_data_takehome: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m13:01:46.399551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:46.403972 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m13:01:46.404182 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m13:01:46.404569 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:01:46.404719 [debug] [MainThread]: Connection 'list_data_takehome' was properly closed.
[0m13:01:46.404861 [info ] [MainThread]: 
[0m13:01:46.405019 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.04 seconds (0.04s).
[0m13:01:46.405243 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/qamr/Documents/Development/suvera/data-dbt-takehome/data_takehome.duckdb": Conflicting lock is held in /opt/homebrew/Cellar/duckdb/1.1.1/bin/duckdb (PID 2266) by user qamr. See also https://duckdb.org/docs/connect/concurrency
[0m13:01:46.407158 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.43132028, "process_user_time": 0.826797, "process_kernel_time": 0.157578, "process_mem_max_rss": "120012800", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:01:46.407441 [debug] [MainThread]: Command `dbt run` failed at 13:01:46.407390 after 0.43 seconds
[0m13:01:46.407629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046f96d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bc0860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047a7a10>]}
[0m13:01:46.407792 [debug] [MainThread]: Flushing usage events
[0m13:01:54.550827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044d5820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a518e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a514c0>]}


============================== 13:01:54.553641 | fe197aa1-d98b-4c71-8208-c1d8f7ef8ab3 ==============================
[0m13:01:54.553641 [info ] [MainThread]: Running with dbt=1.8.1
[0m13:01:54.553966 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:01:54.643031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe197aa1-d98b-4c71-8208-c1d8f7ef8ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10476fce0>]}
[0m13:01:54.685921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe197aa1-d98b-4c71-8208-c1d8f7ef8ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b592e0>]}
[0m13:01:54.686502 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m13:01:54.735387 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m13:01:54.777396 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:01:54.777607 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:01:54.793692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe197aa1-d98b-4c71-8208-c1d8f7ef8ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b81460>]}
[0m13:01:54.829676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe197aa1-d98b-4c71-8208-c1d8f7ef8ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eaefc0>]}
[0m13:01:54.829956 [info ] [MainThread]: Found 4 seeds, 5 models, 421 macros
[0m13:01:54.830123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe197aa1-d98b-4c71-8208-c1d8f7ef8ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b5bc80>]}
[0m13:01:54.830914 [info ] [MainThread]: 
[0m13:01:54.831188 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:01:54.833377 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_data_takehome'
[0m13:01:54.860720 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome"
[0m13:01:54.860960 [debug] [ThreadPool]: On list_data_takehome: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m13:01:54.861106 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:01:54.876329 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m13:01:54.877125 [debug] [ThreadPool]: On list_data_takehome: Close
[0m13:01:54.878081 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data_takehome, now create_data_takehome_main)
[0m13:01:54.878333 [debug] [ThreadPool]: Creating schema "database: "data_takehome"
schema: "main"
"
[0m13:01:54.881685 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m13:01:54.881854 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
        select type from duckdb_databases()
        where database_name='data_takehome'
        and type='sqlite'
    
  
[0m13:01:54.881989 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:54.884982 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m13:01:54.885620 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m13:01:54.885757 [debug] [ThreadPool]: On create_data_takehome_main: BEGIN
[0m13:01:54.885907 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:01:54.886024 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m13:01:54.886145 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
    
        create schema if not exists "data_takehome"."main"
    
[0m13:01:54.886785 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:01:54.887169 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m13:01:54.887298 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m13:01:54.887410 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m13:01:54.887549 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:01:54.887675 [debug] [ThreadPool]: On create_data_takehome_main: Close
[0m13:01:54.888773 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_data_takehome_main, now list_data_takehome_main)
[0m13:01:54.891327 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m13:01:54.891472 [debug] [ThreadPool]: On list_data_takehome_main: BEGIN
[0m13:01:54.891587 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:01:54.893844 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m13:01:54.894001 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m13:01:54.894144 [debug] [ThreadPool]: On list_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome_main"} */
select
      'data_takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'data_takehome'
  
[0m13:01:54.907018 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m13:01:54.910031 [debug] [ThreadPool]: On list_data_takehome_main: ROLLBACK
[0m13:01:54.911182 [debug] [ThreadPool]: Failed to rollback 'list_data_takehome_main'
[0m13:01:54.911334 [debug] [ThreadPool]: On list_data_takehome_main: Close
[0m13:01:54.912853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe197aa1-d98b-4c71-8208-c1d8f7ef8ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b02a50>]}
[0m13:01:54.913074 [debug] [MainThread]: Using duckdb connection "master"
[0m13:01:54.913205 [debug] [MainThread]: On master: BEGIN
[0m13:01:54.913328 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:01:54.915592 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m13:01:54.915753 [debug] [MainThread]: On master: COMMIT
[0m13:01:54.915883 [debug] [MainThread]: Using duckdb connection "master"
[0m13:01:54.916007 [debug] [MainThread]: On master: COMMIT
[0m13:01:54.916145 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:01:54.916268 [debug] [MainThread]: On master: Close
[0m13:01:54.916734 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m13:01:54.916890 [info ] [MainThread]: 
[0m13:01:54.918835 [debug] [Thread-1 (]: Began running node model.data_takehome.stg__activities
[0m13:01:54.919028 [debug] [Thread-2 (]: Began running node model.data_takehome.stg__patients
[0m13:01:54.919200 [debug] [Thread-3 (]: Began running node model.data_takehome.stg__pcns
[0m13:01:54.919396 [debug] [Thread-4 (]: Began running node model.data_takehome.stg__practices
[0m13:01:54.919627 [info ] [Thread-1 (]: 1 of 5 START sql view model main.stg__activities ............................... [RUN]
[0m13:01:54.919903 [info ] [Thread-2 (]: 2 of 5 START sql view model main.stg__patients ................................. [RUN]
[0m13:01:54.920171 [info ] [Thread-3 (]: 3 of 5 START sql view model main.stg__pcns ..................................... [RUN]
[0m13:01:54.920433 [info ] [Thread-4 (]: 4 of 5 START sql view model main.stg__practices ................................ [RUN]
[0m13:01:54.920689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_takehome_main, now model.data_takehome.stg__activities)
[0m13:01:54.920935 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.data_takehome.stg__patients'
[0m13:01:54.921162 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.data_takehome.stg__pcns'
[0m13:01:54.921366 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.data_takehome.stg__practices'
[0m13:01:54.921529 [debug] [Thread-1 (]: Began compiling node model.data_takehome.stg__activities
[0m13:01:54.921675 [debug] [Thread-2 (]: Began compiling node model.data_takehome.stg__patients
[0m13:01:54.921816 [debug] [Thread-3 (]: Began compiling node model.data_takehome.stg__pcns
[0m13:01:54.921956 [debug] [Thread-4 (]: Began compiling node model.data_takehome.stg__practices
[0m13:01:54.925390 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_takehome.stg__activities"
[0m13:01:54.926633 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_takehome.stg__patients"
[0m13:01:54.928720 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_takehome.stg__pcns"
[0m13:01:54.929922 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_takehome.stg__practices"
[0m13:01:54.930450 [debug] [Thread-1 (]: Began executing node model.data_takehome.stg__activities
[0m13:01:54.943013 [debug] [Thread-2 (]: Began executing node model.data_takehome.stg__patients
[0m13:01:54.945539 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_takehome.stg__activities"
[0m13:01:54.945734 [debug] [Thread-3 (]: Began executing node model.data_takehome.stg__pcns
[0m13:01:54.947317 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_takehome.stg__patients"
[0m13:01:54.947525 [debug] [Thread-4 (]: Began executing node model.data_takehome.stg__practices
[0m13:01:54.949018 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_takehome.stg__pcns"
[0m13:01:54.950576 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_takehome.stg__practices"
[0m13:01:54.950857 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m13:01:54.951113 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: BEGIN
[0m13:01:54.951308 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m13:01:54.951493 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m13:01:54.951639 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:01:54.951808 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: BEGIN
[0m13:01:54.951956 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m13:01:54.952102 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: BEGIN
[0m13:01:54.954577 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m13:01:54.954759 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:01:54.954923 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: BEGIN
[0m13:01:54.955066 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:01:54.955207 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m13:01:54.955379 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:01:54.955558 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:01:54.955707 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */

  
  create view "data_takehome"."main"."stg__activities__dbt_tmp" as (
    with activities as (
select * from "data_takehome"."main"."raw_activities" )

select * from activities
  );

[0m13:01:54.955859 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:01:54.956030 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m13:01:54.956178 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:01:54.956336 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m13:01:54.956488 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */

  
  create view "data_takehome"."main"."stg__patients__dbt_tmp" as (
    with patients as (
select * from "data_takehome"."main"."raw_patients" )

select * from patients
  );

[0m13:01:54.956643 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m13:01:54.956794 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */

  
  create view "data_takehome"."main"."stg__pcns__dbt_tmp" as (
    with pcns as (
select * from "data_takehome"."main"."raw_pcns" )

select * from pcns
  );

[0m13:01:54.956936 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:01:54.957102 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */

  
  create view "data_takehome"."main"."stg__practices__dbt_tmp" as (
    with practices as (
select * from "data_takehome"."main"."raw_practices" )

select * from practices
  );

[0m13:01:54.960169 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m13:01:54.960349 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m13:01:54.960548 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */
alter view "data_takehome"."main"."stg__activities" rename to "stg__activities__dbt_backup"
[0m13:01:54.961937 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m13:01:54.962084 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m13:01:54.962238 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m13:01:54.962393 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */
alter view "data_takehome"."main"."stg__patients" rename to "stg__patients__dbt_backup"
[0m13:01:54.962551 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:01:54.963846 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m13:01:54.965569 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m13:01:54.966908 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m13:01:54.967068 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */
alter view "data_takehome"."main"."stg__pcns" rename to "stg__pcns__dbt_backup"
[0m13:01:54.967240 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */
alter view "data_takehome"."main"."stg__practices" rename to "stg__practices__dbt_backup"
[0m13:01:54.967389 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:01:54.967541 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */
alter view "data_takehome"."main"."stg__activities__dbt_tmp" rename to "stg__activities"
[0m13:01:54.968908 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m13:01:54.969108 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:01:54.969273 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */
alter view "data_takehome"."main"."stg__patients__dbt_tmp" rename to "stg__patients"
[0m13:01:54.969422 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m13:01:54.969563 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:01:54.970841 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m13:01:54.972106 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m13:01:54.972251 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m13:01:54.980077 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: COMMIT
[0m13:01:54.980274 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */
alter view "data_takehome"."main"."stg__pcns__dbt_tmp" rename to "stg__pcns"
[0m13:01:54.980443 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */
alter view "data_takehome"."main"."stg__practices__dbt_tmp" rename to "stg__practices"
[0m13:01:54.981169 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: COMMIT
[0m13:01:54.981331 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m13:01:54.981540 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m13:01:54.981694 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m13:01:54.981885 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: COMMIT
[0m13:01:54.982018 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:01:54.982155 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: COMMIT
[0m13:01:54.982887 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: COMMIT
[0m13:01:54.983602 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: COMMIT
[0m13:01:54.983774 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:01:54.983919 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m13:01:54.984058 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m13:01:54.984194 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m13:01:54.986493 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m13:01:54.987543 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m13:01:54.987705 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: COMMIT
[0m13:01:54.987860 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: COMMIT
[0m13:01:54.988018 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */
drop view if exists "data_takehome"."main"."stg__activities__dbt_backup" cascade
[0m13:01:54.988167 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */
drop view if exists "data_takehome"."main"."stg__patients__dbt_backup" cascade
[0m13:01:54.988460 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m13:01:54.989491 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m13:01:54.989653 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */
drop view if exists "data_takehome"."main"."stg__practices__dbt_backup" cascade
[0m13:01:54.989827 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:01:54.989978 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:01:54.990118 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m13:01:54.991102 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m13:01:54.992285 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: Close
[0m13:01:54.992447 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m13:01:54.993028 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: Close
[0m13:01:54.993187 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */
drop view if exists "data_takehome"."main"."stg__pcns__dbt_backup" cascade
[0m13:01:54.993840 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe197aa1-d98b-4c71-8208-c1d8f7ef8ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104be5880>]}
[0m13:01:54.994396 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: Close
[0m13:01:54.994610 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe197aa1-d98b-4c71-8208-c1d8f7ef8ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052fe180>]}
[0m13:01:54.995100 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe197aa1-d98b-4c71-8208-c1d8f7ef8ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b59970>]}
[0m13:01:54.994923 [info ] [Thread-1 (]: 1 of 5 OK created sql view model main.stg__activities .......................... [[32mOK[0m in 0.07s]
[0m13:01:54.995578 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m13:01:54.995392 [info ] [Thread-2 (]: 2 of 5 OK created sql view model main.stg__patients ............................ [[32mOK[0m in 0.07s]
[0m13:01:54.996075 [debug] [Thread-1 (]: Finished running node model.data_takehome.stg__activities
[0m13:01:54.995862 [info ] [Thread-4 (]: 4 of 5 OK created sql view model main.stg__practices ........................... [[32mOK[0m in 0.07s]
[0m13:01:54.996716 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: Close
[0m13:01:54.996940 [debug] [Thread-2 (]: Finished running node model.data_takehome.stg__patients
[0m13:01:54.997244 [debug] [Thread-4 (]: Finished running node model.data_takehome.stg__practices
[0m13:01:54.999907 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe197aa1-d98b-4c71-8208-c1d8f7ef8ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052bfe60>]}
[0m13:01:55.000222 [debug] [Thread-4 (]: Began running node model.data_takehome.int__patients
[0m13:01:55.000508 [info ] [Thread-3 (]: 3 of 5 OK created sql view model main.stg__pcns ................................ [[32mOK[0m in 0.08s]
[0m13:01:55.000952 [debug] [Thread-3 (]: Finished running node model.data_takehome.stg__pcns
[0m13:01:55.000697 [info ] [Thread-4 (]: 5 of 5 START sql table model main.int__patients ................................ [RUN]
[0m13:01:55.001224 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.data_takehome.stg__practices, now model.data_takehome.int__patients)
[0m13:01:55.001405 [debug] [Thread-4 (]: Began compiling node model.data_takehome.int__patients
[0m13:01:55.002935 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_takehome.int__patients"
[0m13:01:55.003376 [debug] [Thread-4 (]: Began executing node model.data_takehome.int__patients
[0m13:01:55.012881 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_takehome.int__patients"
[0m13:01:55.013316 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m13:01:55.013482 [debug] [Thread-4 (]: On model.data_takehome.int__patients: BEGIN
[0m13:01:55.013636 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:01:55.016091 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m13:01:55.016264 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m13:01:55.016440 [debug] [Thread-4 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */

  
    
    

    create  table
      "data_takehome"."main"."int__patients__dbt_tmp"
  
    as (
      WITH patients AS (
  SELECT 
    json_extract_string(data, '$.patient_id') AS patient_id,
    json_extract_string(data, '$.practice_id') AS practice_id,
    json_extract_string(data, '$.age') AS age,
    json_extract_string(data, '$.gender') AS gender,
    json_extract_string(data, '$.registration_date') AS registration_date,
    json_extract_string(data, '$.conditions') AS conditions,
    json_extract_string(data, '$.contact.email') AS email,
    json_extract_string(data, '$.contact.phone') AS phone
  FROM "data_takehome"."main"."stg__patients"

)

-- remove square brackets from conditions column
SELECT 
  patient_id,
  practice_id,
  age,
  gender,
  registration_date,
  replace(CASE
    WHEN conditions LIKE '[%' AND conditions LIKE '%]'
    THEN substr(conditions, 2, length(conditions)-2)
    ELSE conditions
  END, '"', '') as conditions,
  email,
  phone
FROM patients
    );
  
  
[0m13:01:55.020701 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m13:01:55.022956 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m13:01:55.023117 [debug] [Thread-4 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */
alter table "data_takehome"."main"."int__patients" rename to "int__patients__dbt_backup"
[0m13:01:55.023565 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m13:01:55.024799 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m13:01:55.024945 [debug] [Thread-4 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */
alter table "data_takehome"."main"."int__patients__dbt_tmp" rename to "int__patients"
[0m13:01:55.025172 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m13:01:55.027910 [debug] [Thread-4 (]: On model.data_takehome.int__patients: COMMIT
[0m13:01:55.028118 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m13:01:55.028266 [debug] [Thread-4 (]: On model.data_takehome.int__patients: COMMIT
[0m13:01:55.028953 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m13:01:55.030093 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m13:01:55.030244 [debug] [Thread-4 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */
drop table if exists "data_takehome"."main"."int__patients__dbt_backup" cascade
[0m13:01:55.030535 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m13:01:55.031138 [debug] [Thread-4 (]: On model.data_takehome.int__patients: Close
[0m13:01:55.036497 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe197aa1-d98b-4c71-8208-c1d8f7ef8ab3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105403da0>]}
[0m13:01:55.036807 [info ] [Thread-4 (]: 5 of 5 OK created sql table model main.int__patients ........................... [[32mOK[0m in 0.04s]
[0m13:01:55.037170 [debug] [Thread-4 (]: Finished running node model.data_takehome.int__patients
[0m13:01:55.038291 [debug] [MainThread]: Using duckdb connection "master"
[0m13:01:55.038440 [debug] [MainThread]: On master: BEGIN
[0m13:01:55.038559 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:01:55.040879 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m13:01:55.041040 [debug] [MainThread]: On master: COMMIT
[0m13:01:55.041170 [debug] [MainThread]: Using duckdb connection "master"
[0m13:01:55.041284 [debug] [MainThread]: On master: COMMIT
[0m13:01:55.041418 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:01:55.041542 [debug] [MainThread]: On master: Close
[0m13:01:55.041990 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:01:55.042112 [debug] [MainThread]: Connection 'model.data_takehome.stg__activities' was properly closed.
[0m13:01:55.042216 [debug] [MainThread]: Connection 'model.data_takehome.stg__patients' was properly closed.
[0m13:01:55.042317 [debug] [MainThread]: Connection 'model.data_takehome.stg__pcns' was properly closed.
[0m13:01:55.042414 [debug] [MainThread]: Connection 'model.data_takehome.int__patients' was properly closed.
[0m13:01:55.042580 [info ] [MainThread]: 
[0m13:01:55.042725 [info ] [MainThread]: Finished running 4 view models, 1 table model in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m13:01:55.043229 [debug] [MainThread]: Command end result
[0m13:01:55.057341 [info ] [MainThread]: 
[0m13:01:55.057764 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:01:55.057933 [info ] [MainThread]: 
[0m13:01:55.058115 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:01:55.059896 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.538013, "process_user_time": 0.983445, "process_kernel_time": 0.155116, "process_mem_max_rss": "138051584", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m13:01:55.060189 [debug] [MainThread]: Command `dbt run` succeeded at 13:01:55.060144 after 0.54 seconds
[0m13:01:55.060392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104576ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a578f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a54950>]}
[0m13:01:55.060558 [debug] [MainThread]: Flushing usage events
[0m00:09:18.980734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10622e750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108045a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080456a0>]}


============================== 00:09:18.986648 | b1014b78-1204-4610-ba8d-39c54a6d66dd ==============================
[0m00:09:18.986648 [info ] [MainThread]: Running with dbt=1.8.1
[0m00:09:18.986982 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m00:09:19.164425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1014b78-1204-4610-ba8d-39c54a6d66dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080b26c0>]}
[0m00:09:19.207766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1014b78-1204-4610-ba8d-39c54a6d66dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080a5cd0>]}
[0m00:09:19.208597 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m00:09:19.271506 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m00:09:19.330027 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m00:09:19.330344 [debug] [MainThread]: Partial parsing: added file: data_takehome://models/mart/patient_metadata.sql
[0m00:09:19.330541 [debug] [MainThread]: Partial parsing: updated file: data_takehome://models/intermediate/int__patients.sql
[0m00:09:19.405003 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.data_takehome.patient_metadata' (models/mart/patient_metadata.sql) depends on a node named 'int__practices' which was not found
[0m00:09:19.411253 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.46784896, "process_user_time": 0.84497, "process_kernel_time": 0.215994, "process_mem_max_rss": "115949568", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:09:19.411546 [debug] [MainThread]: Command `dbt run` failed at 00:09:19.411494 after 0.47 seconds
[0m00:09:19.411753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073e83e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108021dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10849d5b0>]}
[0m00:09:19.411938 [debug] [MainThread]: Flushing usage events
[0m00:09:35.183659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053ffe00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106345910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063454f0>]}


============================== 00:09:35.186909 | 0879b12c-0399-4a5a-8219-fba8c1dc3f4c ==============================
[0m00:09:35.186909 [info ] [MainThread]: Running with dbt=1.8.1
[0m00:09:35.187223 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:09:35.279553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0879b12c-0399-4a5a-8219-fba8c1dc3f4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106548da0>]}
[0m00:09:35.322046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0879b12c-0399-4a5a-8219-fba8c1dc3f4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065d1220>]}
[0m00:09:35.323436 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m00:09:35.375399 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m00:09:35.428714 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m00:09:35.429004 [debug] [MainThread]: Partial parsing: added file: data_takehome://models/mart/patient_metadata.sql
[0m00:09:35.429190 [debug] [MainThread]: Partial parsing: updated file: data_takehome://models/intermediate/int__patients.sql
[0m00:09:35.501457 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.data_takehome.patient_metadata' (models/mart/patient_metadata.sql) depends on a node named 'int__practices' which was not found
[0m00:09:35.503846 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.35088837, "process_user_time": 0.827004, "process_kernel_time": 0.139022, "process_mem_max_rss": "115671040", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:09:35.504125 [debug] [MainThread]: Command `dbt run` failed at 00:09:35.504077 after 0.35 seconds
[0m00:09:35.504320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106300c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047e5970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063adc70>]}
[0m00:09:35.504484 [debug] [MainThread]: Flushing usage events
[0m00:10:42.269316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f45df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bad7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bad400>]}


============================== 00:10:42.271880 | 973756e6-3237-4b56-858e-472c84e107a2 ==============================
[0m00:10:42.271880 [info ] [MainThread]: Running with dbt=1.8.1
[0m00:10:42.272182 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:10:42.360965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '973756e6-3237-4b56-858e-472c84e107a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c57920>]}
[0m00:10:42.403849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '973756e6-3237-4b56-858e-472c84e107a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c177a0>]}
[0m00:10:42.404413 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m00:10:42.453101 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m00:10:42.495596 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m00:10:42.495902 [debug] [MainThread]: Partial parsing: added file: data_takehome://models/intermediate/int__practices.sql
[0m00:10:42.496060 [debug] [MainThread]: Partial parsing: added file: data_takehome://models/mart/patient_metadata.sql
[0m00:10:42.496226 [debug] [MainThread]: Partial parsing: updated file: data_takehome://models/intermediate/int__patients.sql
[0m00:10:42.595043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '973756e6-3237-4b56-858e-472c84e107a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090e0fe0>]}
[0m00:10:42.640478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '973756e6-3237-4b56-858e-472c84e107a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d9bb00>]}
[0m00:10:42.640755 [info ] [MainThread]: Found 4 seeds, 7 models, 421 macros
[0m00:10:42.640926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '973756e6-3237-4b56-858e-472c84e107a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10911ade0>]}
[0m00:10:42.641774 [info ] [MainThread]: 
[0m00:10:42.642061 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:10:42.644393 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_data_takehome'
[0m00:10:42.697525 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome"
[0m00:10:42.697761 [debug] [ThreadPool]: On list_data_takehome: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m00:10:42.697913 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:10:42.713796 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m00:10:42.714731 [debug] [ThreadPool]: On list_data_takehome: Close
[0m00:10:42.716853 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data_takehome, now create_data_takehome_main)
[0m00:10:42.717071 [debug] [ThreadPool]: Creating schema "database: "data_takehome"
schema: "main"
"
[0m00:10:42.720272 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m00:10:42.720435 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
        select type from duckdb_databases()
        where database_name='data_takehome'
        and type='sqlite'
    
  
[0m00:10:42.720566 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:10:42.723262 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:10:42.723920 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m00:10:42.724060 [debug] [ThreadPool]: On create_data_takehome_main: BEGIN
[0m00:10:42.724204 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:10:42.724321 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m00:10:42.724442 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
    
        create schema if not exists "data_takehome"."main"
    
[0m00:10:42.725094 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:10:42.725477 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m00:10:42.725599 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m00:10:42.725709 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m00:10:42.725846 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:10:42.725971 [debug] [ThreadPool]: On create_data_takehome_main: Close
[0m00:10:42.727069 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_data_takehome_main, now list_data_takehome_main)
[0m00:10:42.729661 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m00:10:42.729823 [debug] [ThreadPool]: On list_data_takehome_main: BEGIN
[0m00:10:42.729949 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:10:42.732321 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:10:42.732486 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m00:10:42.732633 [debug] [ThreadPool]: On list_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome_main"} */
select
      'data_takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'data_takehome'
  
[0m00:10:42.746115 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m00:10:42.749143 [debug] [ThreadPool]: On list_data_takehome_main: ROLLBACK
[0m00:10:42.750298 [debug] [ThreadPool]: Failed to rollback 'list_data_takehome_main'
[0m00:10:42.750439 [debug] [ThreadPool]: On list_data_takehome_main: Close
[0m00:10:42.751883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '973756e6-3237-4b56-858e-472c84e107a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090823c0>]}
[0m00:10:42.752128 [debug] [MainThread]: Using duckdb connection "master"
[0m00:10:42.752267 [debug] [MainThread]: On master: BEGIN
[0m00:10:42.752388 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:10:42.754701 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m00:10:42.754883 [debug] [MainThread]: On master: COMMIT
[0m00:10:42.755014 [debug] [MainThread]: Using duckdb connection "master"
[0m00:10:42.755133 [debug] [MainThread]: On master: COMMIT
[0m00:10:42.755272 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:10:42.755392 [debug] [MainThread]: On master: Close
[0m00:10:42.755834 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m00:10:42.755991 [info ] [MainThread]: 
[0m00:10:42.758193 [debug] [Thread-1 (]: Began running node model.data_takehome.stg__activities
[0m00:10:42.758388 [debug] [Thread-2 (]: Began running node model.data_takehome.stg__patients
[0m00:10:42.758760 [debug] [Thread-3 (]: Began running node model.data_takehome.stg__pcns
[0m00:10:42.758916 [debug] [Thread-4 (]: Began running node model.data_takehome.stg__practices
[0m00:10:42.758625 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg__activities ............................... [RUN]
[0m00:10:42.759152 [info ] [Thread-2 (]: 2 of 7 START sql view model main.stg__patients ................................. [RUN]
[0m00:10:42.759340 [info ] [Thread-3 (]: 3 of 7 START sql view model main.stg__pcns ..................................... [RUN]
[0m00:10:42.759583 [info ] [Thread-4 (]: 4 of 7 START sql view model main.stg__practices ................................ [RUN]
[0m00:10:42.759802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_takehome_main, now model.data_takehome.stg__activities)
[0m00:10:42.760061 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.data_takehome.stg__patients'
[0m00:10:42.760266 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.data_takehome.stg__pcns'
[0m00:10:42.760448 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.data_takehome.stg__practices'
[0m00:10:42.760597 [debug] [Thread-1 (]: Began compiling node model.data_takehome.stg__activities
[0m00:10:42.760737 [debug] [Thread-2 (]: Began compiling node model.data_takehome.stg__patients
[0m00:10:42.760871 [debug] [Thread-3 (]: Began compiling node model.data_takehome.stg__pcns
[0m00:10:42.761004 [debug] [Thread-4 (]: Began compiling node model.data_takehome.stg__practices
[0m00:10:42.764437 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_takehome.stg__activities"
[0m00:10:42.765722 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_takehome.stg__patients"
[0m00:10:42.767052 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_takehome.stg__pcns"
[0m00:10:42.768217 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_takehome.stg__practices"
[0m00:10:42.769088 [debug] [Thread-4 (]: Began executing node model.data_takehome.stg__practices
[0m00:10:42.769294 [debug] [Thread-2 (]: Began executing node model.data_takehome.stg__patients
[0m00:10:42.775335 [debug] [Thread-1 (]: Began executing node model.data_takehome.stg__activities
[0m00:10:42.781835 [debug] [Thread-3 (]: Began executing node model.data_takehome.stg__pcns
[0m00:10:42.787143 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_takehome.stg__patients"
[0m00:10:42.787738 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_takehome.stg__practices"
[0m00:10:42.789224 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_takehome.stg__activities"
[0m00:10:42.790699 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_takehome.stg__pcns"
[0m00:10:42.791270 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m00:10:42.791445 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: BEGIN
[0m00:10:42.791616 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m00:10:42.791766 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:10:42.791993 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m00:10:42.792217 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m00:10:42.792367 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: BEGIN
[0m00:10:42.794780 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m00:10:42.794962 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: BEGIN
[0m00:10:42.795121 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: BEGIN
[0m00:10:42.795269 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:10:42.795414 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m00:10:42.795553 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:10:42.795691 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:10:42.795864 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */

  
  create view "data_takehome"."main"."stg__pcns__dbt_tmp" as (
    with pcns as (
select * from "data_takehome"."main"."raw_pcns" )

select * from pcns
  );

[0m00:10:42.796056 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:10:42.796230 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m00:10:42.796383 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:10:42.796521 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m00:10:42.796672 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m00:10:42.796826 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m00:10:42.796964 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:10:42.797114 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */

  
  create view "data_takehome"."main"."stg__activities__dbt_tmp" as (
    with activities as (
select * from "data_takehome"."main"."raw_activities" )

select * from activities
  );

[0m00:10:42.797284 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */

  
  create view "data_takehome"."main"."stg__patients__dbt_tmp" as (
    with patients as (
select * from "data_takehome"."main"."raw_patients" )

select * from patients
  );

[0m00:10:42.797441 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */

  
  create view "data_takehome"."main"."stg__practices__dbt_tmp" as (
    with practices as (
select * from "data_takehome"."main"."raw_practices" )

select * from practices
  );

[0m00:10:42.800528 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m00:10:42.800796 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */
alter view "data_takehome"."main"."stg__pcns" rename to "stg__pcns__dbt_backup"
[0m00:10:42.801047 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m00:10:42.802489 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m00:10:42.802678 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */
alter view "data_takehome"."main"."stg__patients" rename to "stg__patients__dbt_backup"
[0m00:10:42.802858 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:10:42.803024 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m00:10:42.803167 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m00:10:42.804525 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m00:10:42.804671 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m00:10:42.805909 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m00:10:42.807240 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m00:10:42.807406 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */
alter view "data_takehome"."main"."stg__activities" rename to "stg__activities__dbt_backup"
[0m00:10:42.808657 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m00:10:42.808815 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */
alter view "data_takehome"."main"."stg__pcns__dbt_tmp" rename to "stg__pcns"
[0m00:10:42.808965 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */
alter view "data_takehome"."main"."stg__practices" rename to "stg__practices__dbt_backup"
[0m00:10:42.809145 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */
alter view "data_takehome"."main"."stg__patients__dbt_tmp" rename to "stg__patients"
[0m00:10:42.809320 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:10:42.809518 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m00:10:42.809734 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m00:10:42.811048 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m00:10:42.811204 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m00:10:42.819504 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m00:10:42.821056 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: COMMIT
[0m00:10:42.821240 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */
alter view "data_takehome"."main"."stg__activities__dbt_tmp" rename to "stg__activities"
[0m00:10:42.821922 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: COMMIT
[0m00:10:42.822084 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */
alter view "data_takehome"."main"."stg__practices__dbt_tmp" rename to "stg__practices"
[0m00:10:42.822232 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m00:10:42.822405 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m00:10:42.822615 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: COMMIT
[0m00:10:42.822755 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:10:42.822885 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m00:10:42.823021 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: COMMIT
[0m00:10:42.823713 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: COMMIT
[0m00:10:42.824340 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: COMMIT
[0m00:10:42.824480 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:10:42.824645 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m00:10:42.824786 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m00:10:42.824924 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m00:10:42.827196 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m00:10:42.827368 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: COMMIT
[0m00:10:42.828382 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m00:10:42.828532 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: COMMIT
[0m00:10:42.828686 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */
drop view if exists "data_takehome"."main"."stg__pcns__dbt_backup" cascade
[0m00:10:42.828864 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */
drop view if exists "data_takehome"."main"."stg__patients__dbt_backup" cascade
[0m00:10:42.829025 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:10:42.830055 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m00:10:42.830204 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */
drop view if exists "data_takehome"."main"."stg__activities__dbt_backup" cascade
[0m00:10:42.830379 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:10:42.831401 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m00:10:42.831551 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */
drop view if exists "data_takehome"."main"."stg__practices__dbt_backup" cascade
[0m00:10:42.831711 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m00:10:42.831864 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m00:10:42.832011 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:10:42.833136 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: Close
[0m00:10:42.833736 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: Close
[0m00:10:42.834354 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: Close
[0m00:10:42.834819 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m00:10:42.835427 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '973756e6-3237-4b56-858e-472c84e107a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107567410>]}
[0m00:10:42.835782 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '973756e6-3237-4b56-858e-472c84e107a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094f7560>]}
[0m00:10:42.835975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '973756e6-3237-4b56-858e-472c84e107a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095b1c70>]}
[0m00:10:42.836557 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: Close
[0m00:10:42.836831 [info ] [Thread-2 (]: 2 of 7 OK created sql view model main.stg__patients ............................ [[32mOK[0m in 0.07s]
[0m00:10:42.837117 [info ] [Thread-3 (]: 3 of 7 OK created sql view model main.stg__pcns ................................ [[32mOK[0m in 0.07s]
[0m00:10:42.839600 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '973756e6-3237-4b56-858e-472c84e107a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095fe7b0>]}
[0m00:10:42.837380 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.stg__activities .......................... [[32mOK[0m in 0.08s]
[0m00:10:42.839936 [debug] [Thread-2 (]: Finished running node model.data_takehome.stg__patients
[0m00:10:42.840190 [debug] [Thread-3 (]: Finished running node model.data_takehome.stg__pcns
[0m00:10:42.840699 [debug] [Thread-1 (]: Finished running node model.data_takehome.stg__activities
[0m00:10:42.840483 [info ] [Thread-4 (]: 4 of 7 OK created sql view model main.stg__practices ........................... [[32mOK[0m in 0.08s]
[0m00:10:42.841146 [debug] [Thread-6 (]: Began running node model.data_takehome.int__patients
[0m00:10:42.841381 [debug] [Thread-4 (]: Finished running node model.data_takehome.stg__practices
[0m00:10:42.841629 [info ] [Thread-6 (]: 5 of 7 START sql table model main.int__patients ................................ [RUN]
[0m00:10:42.841930 [debug] [Thread-8 (]: Began running node model.data_takehome.int__practices
[0m00:10:42.842201 [debug] [Thread-6 (]: Acquiring new duckdb connection 'model.data_takehome.int__patients'
[0m00:10:42.842424 [info ] [Thread-8 (]: 6 of 7 START sql table model main.int__practices ............................... [RUN]
[0m00:10:42.842605 [debug] [Thread-6 (]: Began compiling node model.data_takehome.int__patients
[0m00:10:42.842826 [debug] [Thread-8 (]: Acquiring new duckdb connection 'model.data_takehome.int__practices'
[0m00:10:42.844409 [debug] [Thread-6 (]: Writing injected SQL for node "model.data_takehome.int__patients"
[0m00:10:42.844596 [debug] [Thread-8 (]: Began compiling node model.data_takehome.int__practices
[0m00:10:42.845884 [debug] [Thread-8 (]: Writing injected SQL for node "model.data_takehome.int__practices"
[0m00:10:42.846238 [debug] [Thread-8 (]: Began executing node model.data_takehome.int__practices
[0m00:10:42.855558 [debug] [Thread-8 (]: Writing runtime sql for node "model.data_takehome.int__practices"
[0m00:10:42.855779 [debug] [Thread-6 (]: Began executing node model.data_takehome.int__patients
[0m00:10:42.857254 [debug] [Thread-6 (]: Writing runtime sql for node "model.data_takehome.int__patients"
[0m00:10:42.857545 [debug] [Thread-8 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m00:10:42.857727 [debug] [Thread-8 (]: On model.data_takehome.int__practices: BEGIN
[0m00:10:42.857883 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m00:10:42.858043 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m00:10:42.860477 [debug] [Thread-8 (]: SQL status: OK in 0.003 seconds
[0m00:10:42.860659 [debug] [Thread-6 (]: On model.data_takehome.int__patients: BEGIN
[0m00:10:42.860817 [debug] [Thread-8 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m00:10:42.860959 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m00:10:42.861114 [debug] [Thread-8 (]: On model.data_takehome.int__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__practices"} */

  
    
    

    create  table
      "data_takehome"."main"."int__practices__dbt_tmp"
  
    as (
      with pcns as (
select *
FROM "data_takehome"."main"."stg__pcns"
)

, practices as (
select *
FROM "data_takehome"."main"."stg__practices"
)


select
     practices.id
   , practices.practice_name
   , practices.location
   , practices.established_date
   , practices.pcn
   , pcn_name
  from practices
  left join pcns
  on pcns.id = practices.pcn
    );
  
  
[0m00:10:42.861326 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m00:10:42.861468 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m00:10:42.861654 [debug] [Thread-6 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */

  
    
    

    create  table
      "data_takehome"."main"."int__patients__dbt_tmp"
  
    as (
      WITH patients AS (
  SELECT 
    json_extract_string(data, '$.patient_id') AS patient_id,
    json_extract_string(data, '$.practice_id') AS practice_id,
    json_extract_string(data, '$.age') AS age,
    json_extract_string(data, '$.gender') AS gender,
    json_extract_string(data, '$.registration_date') AS registration_date,
    json_extract_string(data, '$.conditions') AS conditions,
    json_extract_string(data, '$.contact.email') AS email,
    json_extract_string(data, '$.contact.phone') AS phone
  FROM "data_takehome"."main"."stg__patients"
)

clean_patients as (
-- remove square brackets from conditions column and clean phone number
SELECT 
  patient_id,
  practice_id,
  age,
  gender,
  registration_date,
  replace(CASE
    WHEN conditions LIKE '[%' AND conditions LIKE '%]'
    THEN substr(conditions, 2, length(conditions)-2)
    ELSE conditions
  END, '"', '') as conditions,
  email,
      regexp_replace(
        -- Step 2: Handle leading 1 or 001
        CASE
            WHEN regexp_matches(regexp_replace(phone, '[^0-9]', '', 'g'), '^(1|001)')
            THEN regexp_replace(regexp_replace(phone, '[^0-9]', '', 'g'), '^(1|001)', '')
            -- Step 3: Preserve numbers before letters, remove after
            ELSE regexp_replace(
                regexp_replace(phone, '([0-9]+)[a-zA-Z].*', '\1'),
                '[^0-9]', '', 'g'
            )
        END,
        -- Final cleanup in case any special chars remain
        '[^0-9]', '', 'g'
    ) AS phone
FROM patients)


select
     patient_id
   , practice_id
   , age
   , gender
   , registration_date
   , conditions
   , email
   , phone
from (
select *
 , dense_rank() over (partition by patient_id order by registration_date desc) as rank
from clean_patients) as a
where rank = 1
    );
  
  
[0m00:10:42.864662 [debug] [Thread-6 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */

  
    
    

    create  table
      "data_takehome"."main"."int__patients__dbt_tmp"
  
    as (
      WITH patients AS (
  SELECT 
    json_extract_string(data, '$.patient_id') AS patient_id,
    json_extract_string(data, '$.practice_id') AS practice_id,
    json_extract_string(data, '$.age') AS age,
    json_extract_string(data, '$.gender') AS gender,
    json_extract_string(data, '$.registration_date') AS registration_date,
    json_extract_string(data, '$.conditions') AS conditions,
    json_extract_string(data, '$.contact.email') AS email,
    json_extract_string(data, '$.contact.phone') AS phone
  FROM "data_takehome"."main"."stg__patients"
)

clean_patients as (
-- remove square brackets from conditions column and clean phone number
SELECT 
  patient_id,
  practice_id,
  age,
  gender,
  registration_date,
  replace(CASE
    WHEN conditions LIKE '[%' AND conditions LIKE '%]'
    THEN substr(conditions, 2, length(conditions)-2)
    ELSE conditions
  END, '"', '') as conditions,
  email,
      regexp_replace(
        -- Step 2: Handle leading 1 or 001
        CASE
            WHEN regexp_matches(regexp_replace(phone, '[^0-9]', '', 'g'), '^(1|001)')
            THEN regexp_replace(regexp_replace(phone, '[^0-9]', '', 'g'), '^(1|001)', '')
            -- Step 3: Preserve numbers before letters, remove after
            ELSE regexp_replace(
                regexp_replace(phone, '([0-9]+)[a-zA-Z].*', '\1'),
                '[^0-9]', '', 'g'
            )
        END,
        -- Final cleanup in case any special chars remain
        '[^0-9]', '', 'g'
    ) AS phone
FROM patients)


select
     patient_id
   , practice_id
   , age
   , gender
   , registration_date
   , conditions
   , email
   , phone
from (
select *
 , dense_rank() over (partition by patient_id order by registration_date desc) as rank
from clean_patients) as a
where rank = 1
    );
  
  
[0m00:10:42.864897 [debug] [Thread-6 (]: DuckDB adapter: Rolling back transaction.
[0m00:10:42.865126 [debug] [Thread-6 (]: On model.data_takehome.int__patients: ROLLBACK
[0m00:10:42.866387 [debug] [Thread-8 (]: SQL status: OK in 0.005 seconds
[0m00:10:42.868081 [debug] [Thread-8 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m00:10:42.868244 [debug] [Thread-8 (]: On model.data_takehome.int__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__practices"} */
alter table "data_takehome"."main"."int__practices__dbt_tmp" rename to "int__practices"
[0m00:10:42.868602 [debug] [Thread-8 (]: SQL status: OK in 0.000 seconds
[0m00:10:42.871017 [debug] [Thread-8 (]: On model.data_takehome.int__practices: COMMIT
[0m00:10:42.871200 [debug] [Thread-8 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m00:10:42.871375 [debug] [Thread-8 (]: On model.data_takehome.int__practices: COMMIT
[0m00:10:42.872032 [debug] [Thread-8 (]: SQL status: OK in 0.000 seconds
[0m00:10:42.873139 [debug] [Thread-8 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m00:10:42.873294 [debug] [Thread-8 (]: On model.data_takehome.int__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__practices"} */
drop table if exists "data_takehome"."main"."int__practices__dbt_backup" cascade
[0m00:10:42.873512 [debug] [Thread-8 (]: SQL status: OK in 0.000 seconds
[0m00:10:42.874171 [debug] [Thread-8 (]: On model.data_takehome.int__practices: Close
[0m00:10:42.874409 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '973756e6-3237-4b56-858e-472c84e107a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10965e180>]}
[0m00:10:42.874689 [info ] [Thread-8 (]: 6 of 7 OK created sql table model main.int__practices .......................... [[32mOK[0m in 0.03s]
[0m00:10:42.874978 [debug] [Thread-8 (]: Finished running node model.data_takehome.int__practices
[0m00:10:42.876925 [debug] [Thread-6 (]: Failed to rollback 'model.data_takehome.int__patients'
[0m00:10:42.877092 [debug] [Thread-6 (]: On model.data_takehome.int__patients: Close
[0m00:10:42.880405 [debug] [Thread-6 (]: Runtime Error in model int__patients (models/intermediate/int__patients.sql)
  Parser Error: syntax error at or near "clean_patients"
[0m00:10:42.880609 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '973756e6-3237-4b56-858e-472c84e107a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096c39b0>]}
[0m00:10:42.880870 [error] [Thread-6 (]: 5 of 7 ERROR creating sql table model main.int__patients ....................... [[31mERROR[0m in 0.04s]
[0m00:10:42.881120 [debug] [Thread-6 (]: Finished running node model.data_takehome.int__patients
[0m00:10:42.881534 [debug] [Thread-10 ]: Began running node model.data_takehome.patient_metadata
[0m00:10:42.881779 [info ] [Thread-10 ]: 7 of 7 SKIP relation main.patient_metadata ..................................... [[33mSKIP[0m]
[0m00:10:42.882004 [debug] [Thread-10 ]: Finished running node model.data_takehome.patient_metadata
[0m00:10:42.882889 [debug] [MainThread]: Using duckdb connection "master"
[0m00:10:42.883029 [debug] [MainThread]: On master: BEGIN
[0m00:10:42.883146 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:10:42.885540 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m00:10:42.885699 [debug] [MainThread]: On master: COMMIT
[0m00:10:42.885828 [debug] [MainThread]: Using duckdb connection "master"
[0m00:10:42.885947 [debug] [MainThread]: On master: COMMIT
[0m00:10:42.886079 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:10:42.886203 [debug] [MainThread]: On master: Close
[0m00:10:42.886637 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:10:42.886781 [debug] [MainThread]: Connection 'model.data_takehome.stg__activities' was properly closed.
[0m00:10:42.886891 [debug] [MainThread]: Connection 'model.data_takehome.stg__patients' was properly closed.
[0m00:10:42.886993 [debug] [MainThread]: Connection 'model.data_takehome.stg__pcns' was properly closed.
[0m00:10:42.887089 [debug] [MainThread]: Connection 'model.data_takehome.stg__practices' was properly closed.
[0m00:10:42.887188 [debug] [MainThread]: Connection 'model.data_takehome.int__patients' was properly closed.
[0m00:10:42.887287 [debug] [MainThread]: Connection 'model.data_takehome.int__practices' was properly closed.
[0m00:10:42.887461 [info ] [MainThread]: 
[0m00:10:42.887612 [info ] [MainThread]: Finished running 4 view models, 3 table models in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m00:10:42.888197 [debug] [MainThread]: Command end result
[0m00:10:42.902748 [info ] [MainThread]: 
[0m00:10:42.902985 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:10:42.903123 [info ] [MainThread]: 
[0m00:10:42.903292 [error] [MainThread]:   Runtime Error in model int__patients (models/intermediate/int__patients.sql)
  Parser Error: syntax error at or near "clean_patients"
[0m00:10:42.903426 [info ] [MainThread]: 
[0m00:10:42.903567 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=1 TOTAL=7
[0m00:10:42.904908 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.66482973, "process_user_time": 1.074282, "process_kernel_time": 0.166725, "process_mem_max_rss": "138821632", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:10:42.905256 [debug] [MainThread]: Command `dbt run` failed at 00:10:42.905213 after 0.67 seconds
[0m00:10:42.905439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bad7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088f1670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f45df0>]}
[0m00:10:42.905605 [debug] [MainThread]: Flushing usage events
[0m00:11:17.725499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058f6750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108649970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108649550>]}


============================== 00:11:17.728589 | 17cf3217-fb1e-47a7-814c-6a14111be95b ==============================
[0m00:11:17.728589 [info ] [MainThread]: Running with dbt=1.8.1
[0m00:11:17.728903 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:11:17.818378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17cf3217-fb1e-47a7-814c-6a14111be95b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10874b7a0>]}
[0m00:11:17.861581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17cf3217-fb1e-47a7-814c-6a14111be95b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070680b0>]}
[0m00:11:17.862170 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m00:11:17.912065 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m00:11:17.955249 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:11:17.955576 [debug] [MainThread]: Partial parsing: updated file: data_takehome://models/intermediate/int__patients.sql
[0m00:11:18.049202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17cf3217-fb1e-47a7-814c-6a14111be95b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bece00>]}
[0m00:11:18.084173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17cf3217-fb1e-47a7-814c-6a14111be95b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bed250>]}
[0m00:11:18.084449 [info ] [MainThread]: Found 4 seeds, 7 models, 421 macros
[0m00:11:18.084619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17cf3217-fb1e-47a7-814c-6a14111be95b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10874ab40>]}
[0m00:11:18.085459 [info ] [MainThread]: 
[0m00:11:18.085740 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:11:18.088015 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_data_takehome'
[0m00:11:18.115701 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome"
[0m00:11:18.115966 [debug] [ThreadPool]: On list_data_takehome: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m00:11:18.116112 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:11:18.119508 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:11:18.120181 [debug] [ThreadPool]: On list_data_takehome: Close
[0m00:11:18.120891 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data_takehome, now create_data_takehome_main)
[0m00:11:18.121134 [debug] [ThreadPool]: Creating schema "database: "data_takehome"
schema: "main"
"
[0m00:11:18.124370 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m00:11:18.124549 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
        select type from duckdb_databases()
        where database_name='data_takehome'
        and type='sqlite'
    
  
[0m00:11:18.124679 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:11:18.127366 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:11:18.128015 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m00:11:18.128154 [debug] [ThreadPool]: On create_data_takehome_main: BEGIN
[0m00:11:18.128305 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:11:18.128418 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m00:11:18.128528 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
    
        create schema if not exists "data_takehome"."main"
    
[0m00:11:18.128684 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:11:18.129057 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m00:11:18.129187 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m00:11:18.129297 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m00:11:18.129434 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:11:18.129555 [debug] [ThreadPool]: On create_data_takehome_main: Close
[0m00:11:18.130646 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_data_takehome_main, now list_data_takehome_main)
[0m00:11:18.133246 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m00:11:18.133399 [debug] [ThreadPool]: On list_data_takehome_main: BEGIN
[0m00:11:18.133525 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:11:18.135807 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:11:18.135973 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m00:11:18.136111 [debug] [ThreadPool]: On list_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome_main"} */
select
      'data_takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'data_takehome'
  
[0m00:11:18.145332 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m00:11:18.147574 [debug] [ThreadPool]: On list_data_takehome_main: ROLLBACK
[0m00:11:18.148248 [debug] [ThreadPool]: Failed to rollback 'list_data_takehome_main'
[0m00:11:18.148389 [debug] [ThreadPool]: On list_data_takehome_main: Close
[0m00:11:18.149818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17cf3217-fb1e-47a7-814c-6a14111be95b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070a45f0>]}
[0m00:11:18.150061 [debug] [MainThread]: Using duckdb connection "master"
[0m00:11:18.150199 [debug] [MainThread]: On master: BEGIN
[0m00:11:18.150323 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:11:18.152617 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m00:11:18.152778 [debug] [MainThread]: On master: COMMIT
[0m00:11:18.152907 [debug] [MainThread]: Using duckdb connection "master"
[0m00:11:18.153024 [debug] [MainThread]: On master: COMMIT
[0m00:11:18.153159 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:11:18.153281 [debug] [MainThread]: On master: Close
[0m00:11:18.153741 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m00:11:18.153891 [info ] [MainThread]: 
[0m00:11:18.155938 [debug] [Thread-1 (]: Began running node model.data_takehome.stg__activities
[0m00:11:18.156311 [debug] [Thread-2 (]: Began running node model.data_takehome.stg__patients
[0m00:11:18.156556 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg__activities ............................... [RUN]
[0m00:11:18.156824 [info ] [Thread-2 (]: 2 of 7 START sql view model main.stg__patients ................................. [RUN]
[0m00:11:18.157083 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_takehome_main, now model.data_takehome.stg__activities)
[0m00:11:18.157255 [debug] [Thread-3 (]: Began running node model.data_takehome.stg__pcns
[0m00:11:18.157459 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.data_takehome.stg__patients'
[0m00:11:18.157606 [debug] [Thread-4 (]: Began running node model.data_takehome.stg__practices
[0m00:11:18.157749 [debug] [Thread-1 (]: Began compiling node model.data_takehome.stg__activities
[0m00:11:18.157937 [info ] [Thread-3 (]: 3 of 7 START sql view model main.stg__pcns ..................................... [RUN]
[0m00:11:18.158096 [debug] [Thread-2 (]: Began compiling node model.data_takehome.stg__patients
[0m00:11:18.158275 [info ] [Thread-4 (]: 4 of 7 START sql view model main.stg__practices ................................ [RUN]
[0m00:11:18.161730 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_takehome.stg__activities"
[0m00:11:18.161970 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.data_takehome.stg__pcns'
[0m00:11:18.163129 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_takehome.stg__patients"
[0m00:11:18.163348 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.data_takehome.stg__practices'
[0m00:11:18.163564 [debug] [Thread-3 (]: Began compiling node model.data_takehome.stg__pcns
[0m00:11:18.163814 [debug] [Thread-4 (]: Began compiling node model.data_takehome.stg__practices
[0m00:11:18.165209 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_takehome.stg__pcns"
[0m00:11:18.165466 [debug] [Thread-1 (]: Began executing node model.data_takehome.stg__activities
[0m00:11:18.166700 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_takehome.stg__practices"
[0m00:11:18.166875 [debug] [Thread-2 (]: Began executing node model.data_takehome.stg__patients
[0m00:11:18.182505 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_takehome.stg__activities"
[0m00:11:18.184927 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_takehome.stg__patients"
[0m00:11:18.185163 [debug] [Thread-3 (]: Began executing node model.data_takehome.stg__pcns
[0m00:11:18.185336 [debug] [Thread-4 (]: Began executing node model.data_takehome.stg__practices
[0m00:11:18.186839 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_takehome.stg__pcns"
[0m00:11:18.188296 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_takehome.stg__practices"
[0m00:11:18.188584 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m00:11:18.188762 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m00:11:18.188983 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: BEGIN
[0m00:11:18.189159 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: BEGIN
[0m00:11:18.189311 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m00:11:18.189466 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:11:18.189617 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m00:11:18.189763 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:11:18.189913 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: BEGIN
[0m00:11:18.192409 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:11:18.192597 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: BEGIN
[0m00:11:18.192779 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:11:18.192930 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m00:11:18.193086 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m00:11:18.193228 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:11:18.193408 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m00:11:18.193573 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */

  
  create view "data_takehome"."main"."stg__activities__dbt_tmp" as (
    with activities as (
select * from "data_takehome"."main"."raw_activities" )

select * from activities
  );

[0m00:11:18.193731 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:11:18.193901 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */

  
  create view "data_takehome"."main"."stg__patients__dbt_tmp" as (
    with patients as (
select * from "data_takehome"."main"."raw_patients" )

select * from patients
  );

[0m00:11:18.194053 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:11:18.194215 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m00:11:18.194403 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m00:11:18.194580 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */

  
  create view "data_takehome"."main"."stg__pcns__dbt_tmp" as (
    with pcns as (
select * from "data_takehome"."main"."raw_pcns" )

select * from pcns
  );

[0m00:11:18.194730 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:11:18.194889 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */

  
  create view "data_takehome"."main"."stg__practices__dbt_tmp" as (
    with practices as (
select * from "data_takehome"."main"."raw_practices" )

select * from practices
  );

[0m00:11:18.195032 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m00:11:18.198265 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m00:11:18.199835 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m00:11:18.200022 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */
alter view "data_takehome"."main"."stg__activities" rename to "stg__activities__dbt_backup"
[0m00:11:18.200179 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m00:11:18.200342 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */
alter view "data_takehome"."main"."stg__patients" rename to "stg__patients__dbt_backup"
[0m00:11:18.200510 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m00:11:18.201898 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m00:11:18.203354 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m00:11:18.203535 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:11:18.203711 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */
alter view "data_takehome"."main"."stg__pcns" rename to "stg__pcns__dbt_backup"
[0m00:11:18.203880 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m00:11:18.204024 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */
alter view "data_takehome"."main"."stg__practices" rename to "stg__practices__dbt_backup"
[0m00:11:18.205235 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m00:11:18.206583 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m00:11:18.206782 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:11:18.206975 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */
alter view "data_takehome"."main"."stg__activities__dbt_tmp" rename to "stg__activities"
[0m00:11:18.207135 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m00:11:18.207282 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */
alter view "data_takehome"."main"."stg__patients__dbt_tmp" rename to "stg__patients"
[0m00:11:18.208527 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m00:11:18.209806 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m00:11:18.209980 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:11:18.210170 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */
alter view "data_takehome"."main"."stg__pcns__dbt_tmp" rename to "stg__pcns"
[0m00:11:18.210316 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m00:11:18.210455 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */
alter view "data_takehome"."main"."stg__practices__dbt_tmp" rename to "stg__practices"
[0m00:11:18.218362 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: COMMIT
[0m00:11:18.218589 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m00:11:18.219297 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: COMMIT
[0m00:11:18.219504 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m00:11:18.220226 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: COMMIT
[0m00:11:18.220387 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m00:11:18.220559 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:11:18.220708 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: COMMIT
[0m00:11:18.221073 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m00:11:18.221244 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: COMMIT
[0m00:11:18.221910 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: COMMIT
[0m00:11:18.222160 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: COMMIT
[0m00:11:18.222354 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m00:11:18.222527 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:11:18.223599 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: COMMIT
[0m00:11:18.223741 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m00:11:18.223870 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:11:18.226199 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m00:11:18.227277 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m00:11:18.228255 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m00:11:18.228409 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m00:11:18.228563 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */
drop view if exists "data_takehome"."main"."stg__activities__dbt_backup" cascade
[0m00:11:18.228739 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */
drop view if exists "data_takehome"."main"."stg__patients__dbt_backup" cascade
[0m00:11:18.228899 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */
drop view if exists "data_takehome"."main"."stg__pcns__dbt_backup" cascade
[0m00:11:18.229844 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m00:11:18.230102 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */
drop view if exists "data_takehome"."main"."stg__practices__dbt_backup" cascade
[0m00:11:18.230268 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:11:18.231461 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: Close
[0m00:11:18.232003 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m00:11:18.232333 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17cf3217-fb1e-47a7-814c-6a14111be95b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070036b0>]}
[0m00:11:18.232492 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m00:11:18.233067 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: Close
[0m00:11:18.233262 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m00:11:18.234068 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: Close
[0m00:11:18.233530 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.stg__activities .......................... [[32mOK[0m in 0.07s]
[0m00:11:18.234324 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17cf3217-fb1e-47a7-814c-6a14111be95b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10906ec60>]}
[0m00:11:18.234921 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: Close
[0m00:11:18.235122 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17cf3217-fb1e-47a7-814c-6a14111be95b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109058860>]}
[0m00:11:18.235373 [debug] [Thread-1 (]: Finished running node model.data_takehome.stg__activities
[0m00:11:18.236969 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17cf3217-fb1e-47a7-814c-6a14111be95b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f4a870>]}
[0m00:11:18.235610 [info ] [Thread-2 (]: 2 of 7 OK created sql view model main.stg__patients ............................ [[32mOK[0m in 0.08s]
[0m00:11:18.237272 [info ] [Thread-3 (]: 3 of 7 OK created sql view model main.stg__pcns ................................ [[32mOK[0m in 0.07s]
[0m00:11:18.237844 [debug] [Thread-2 (]: Finished running node model.data_takehome.stg__patients
[0m00:11:18.237632 [info ] [Thread-4 (]: 4 of 7 OK created sql view model main.stg__practices ........................... [[32mOK[0m in 0.07s]
[0m00:11:18.238103 [debug] [Thread-3 (]: Finished running node model.data_takehome.stg__pcns
[0m00:11:18.238403 [debug] [Thread-4 (]: Finished running node model.data_takehome.stg__practices
[0m00:11:18.238575 [debug] [Thread-6 (]: Began running node model.data_takehome.int__patients
[0m00:11:18.238844 [info ] [Thread-6 (]: 5 of 7 START sql table model main.int__patients ................................ [RUN]
[0m00:11:18.239085 [debug] [Thread-6 (]: Acquiring new duckdb connection 'model.data_takehome.int__patients'
[0m00:11:18.239261 [debug] [Thread-8 (]: Began running node model.data_takehome.int__practices
[0m00:11:18.239419 [debug] [Thread-6 (]: Began compiling node model.data_takehome.int__patients
[0m00:11:18.240992 [debug] [Thread-6 (]: Writing injected SQL for node "model.data_takehome.int__patients"
[0m00:11:18.239628 [info ] [Thread-8 (]: 6 of 7 START sql table model main.int__practices ............................... [RUN]
[0m00:11:18.241283 [debug] [Thread-8 (]: Acquiring new duckdb connection 'model.data_takehome.int__practices'
[0m00:11:18.241448 [debug] [Thread-8 (]: Began compiling node model.data_takehome.int__practices
[0m00:11:18.242864 [debug] [Thread-8 (]: Writing injected SQL for node "model.data_takehome.int__practices"
[0m00:11:18.243042 [debug] [Thread-6 (]: Began executing node model.data_takehome.int__patients
[0m00:11:18.252556 [debug] [Thread-6 (]: Writing runtime sql for node "model.data_takehome.int__patients"
[0m00:11:18.252928 [debug] [Thread-8 (]: Began executing node model.data_takehome.int__practices
[0m00:11:18.254480 [debug] [Thread-8 (]: Writing runtime sql for node "model.data_takehome.int__practices"
[0m00:11:18.254734 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m00:11:18.254909 [debug] [Thread-6 (]: On model.data_takehome.int__patients: BEGIN
[0m00:11:18.255062 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m00:11:18.257479 [debug] [Thread-6 (]: SQL status: OK in 0.002 seconds
[0m00:11:18.257739 [debug] [Thread-8 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m00:11:18.257897 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m00:11:18.258053 [debug] [Thread-8 (]: On model.data_takehome.int__practices: BEGIN
[0m00:11:18.258250 [debug] [Thread-6 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */

  
    
    

    create  table
      "data_takehome"."main"."int__patients__dbt_tmp"
  
    as (
      WITH patients AS (
  SELECT 
    json_extract_string(data, '$.patient_id') AS patient_id,
    json_extract_string(data, '$.practice_id') AS practice_id,
    json_extract_string(data, '$.age') AS age,
    json_extract_string(data, '$.gender') AS gender,
    json_extract_string(data, '$.registration_date') AS registration_date,
    json_extract_string(data, '$.conditions') AS conditions,
    json_extract_string(data, '$.contact.email') AS email,
    json_extract_string(data, '$.contact.phone') AS phone
  FROM "data_takehome"."main"."stg__patients"
)

, clean_patients as (
-- remove square brackets from conditions column and clean phone number
SELECT 
  patient_id,
  practice_id,
  age,
  gender,
  registration_date,
  replace(CASE
    WHEN conditions LIKE '[%' AND conditions LIKE '%]'
    THEN substr(conditions, 2, length(conditions)-2)
    ELSE conditions
  END, '"', '') as conditions,
  email,
      regexp_replace(
        -- Step 2: Handle leading 1 or 001
        CASE
            WHEN regexp_matches(regexp_replace(phone, '[^0-9]', '', 'g'), '^(1|001)')
            THEN regexp_replace(regexp_replace(phone, '[^0-9]', '', 'g'), '^(1|001)', '')
            -- Step 3: Preserve numbers before letters, remove after
            ELSE regexp_replace(
                regexp_replace(phone, '([0-9]+)[a-zA-Z].*', '\1'),
                '[^0-9]', '', 'g'
            )
        END,
        -- Final cleanup in case any special chars remain
        '[^0-9]', '', 'g'
    ) AS phone
FROM patients)

select
     patient_id
   , practice_id
   , age
   , gender
   , registration_date
   , conditions
   , email
   , phone
from (
select *
 , dense_rank() over (partition by patient_id order by registration_date desc) as rank
from clean_patients) as a
where rank = 1
    );
  
  
[0m00:11:18.258441 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m00:11:18.258648 [debug] [Thread-8 (]: SQL status: OK in 0.000 seconds
[0m00:11:18.258793 [debug] [Thread-8 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m00:11:18.258948 [debug] [Thread-8 (]: On model.data_takehome.int__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__practices"} */

  
    
    

    create  table
      "data_takehome"."main"."int__practices__dbt_tmp"
  
    as (
      with pcns as (
select *
FROM "data_takehome"."main"."stg__pcns"
)

, practices as (
select *
FROM "data_takehome"."main"."stg__practices"
)


select
     practices.id
   , practices.practice_name
   , practices.location
   , practices.established_date
   , practices.pcn
   , pcn_name
  from practices
  left join pcns
  on pcns.id = practices.pcn
    );
  
  
[0m00:11:18.259849 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m00:11:18.261223 [debug] [Thread-8 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m00:11:18.261383 [debug] [Thread-8 (]: On model.data_takehome.int__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__practices"} */
alter table "data_takehome"."main"."int__practices" rename to "int__practices__dbt_backup"
[0m00:11:18.261609 [debug] [Thread-8 (]: SQL status: OK in 0.000 seconds
[0m00:11:18.262964 [debug] [Thread-8 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m00:11:18.263149 [debug] [Thread-8 (]: On model.data_takehome.int__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__practices"} */
alter table "data_takehome"."main"."int__practices__dbt_tmp" rename to "int__practices"
[0m00:11:18.263446 [debug] [Thread-8 (]: SQL status: OK in 0.000 seconds
[0m00:11:18.266792 [debug] [Thread-8 (]: On model.data_takehome.int__practices: COMMIT
[0m00:11:18.267113 [debug] [Thread-8 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m00:11:18.267314 [debug] [Thread-8 (]: On model.data_takehome.int__practices: COMMIT
[0m00:11:18.267971 [debug] [Thread-8 (]: SQL status: OK in 0.000 seconds
[0m00:11:18.269083 [debug] [Thread-8 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m00:11:18.269239 [debug] [Thread-8 (]: On model.data_takehome.int__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__practices"} */
drop table if exists "data_takehome"."main"."int__practices__dbt_backup" cascade
[0m00:11:18.270215 [debug] [Thread-6 (]: SQL status: OK in 0.011 seconds
[0m00:11:18.271510 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m00:11:18.271673 [debug] [Thread-6 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */
alter table "data_takehome"."main"."int__patients" rename to "int__patients__dbt_backup"
[0m00:11:18.271957 [debug] [Thread-8 (]: SQL status: OK in 0.002 seconds
[0m00:11:18.272142 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m00:11:18.272749 [debug] [Thread-8 (]: On model.data_takehome.int__practices: Close
[0m00:11:18.274115 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m00:11:18.274357 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17cf3217-fb1e-47a7-814c-6a14111be95b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10908c830>]}
[0m00:11:18.274533 [debug] [Thread-6 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */
alter table "data_takehome"."main"."int__patients__dbt_tmp" rename to "int__patients"
[0m00:11:18.274811 [info ] [Thread-8 (]: 6 of 7 OK created sql table model main.int__practices .......................... [[32mOK[0m in 0.03s]
[0m00:11:18.275028 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m00:11:18.275265 [debug] [Thread-8 (]: Finished running node model.data_takehome.int__practices
[0m00:11:18.276051 [debug] [Thread-6 (]: On model.data_takehome.int__patients: COMMIT
[0m00:11:18.276262 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m00:11:18.276406 [debug] [Thread-6 (]: On model.data_takehome.int__patients: COMMIT
[0m00:11:18.276924 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m00:11:18.277936 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m00:11:18.278082 [debug] [Thread-6 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */
drop table if exists "data_takehome"."main"."int__patients__dbt_backup" cascade
[0m00:11:18.278338 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m00:11:18.278904 [debug] [Thread-6 (]: On model.data_takehome.int__patients: Close
[0m00:11:18.283787 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17cf3217-fb1e-47a7-814c-6a14111be95b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10909b470>]}
[0m00:11:18.284088 [info ] [Thread-6 (]: 5 of 7 OK created sql table model main.int__patients ........................... [[32mOK[0m in 0.04s]
[0m00:11:18.284336 [debug] [Thread-6 (]: Finished running node model.data_takehome.int__patients
[0m00:11:18.284703 [debug] [Thread-10 ]: Began running node model.data_takehome.patient_metadata
[0m00:11:18.284950 [info ] [Thread-10 ]: 7 of 7 START sql table model main.patient_metadata ............................. [RUN]
[0m00:11:18.285172 [debug] [Thread-10 ]: Acquiring new duckdb connection 'model.data_takehome.patient_metadata'
[0m00:11:18.285323 [debug] [Thread-10 ]: Began compiling node model.data_takehome.patient_metadata
[0m00:11:18.286782 [debug] [Thread-10 ]: Writing injected SQL for node "model.data_takehome.patient_metadata"
[0m00:11:18.287195 [debug] [Thread-10 ]: Began executing node model.data_takehome.patient_metadata
[0m00:11:18.288637 [debug] [Thread-10 ]: Writing runtime sql for node "model.data_takehome.patient_metadata"
[0m00:11:18.289034 [debug] [Thread-10 ]: Using duckdb connection "model.data_takehome.patient_metadata"
[0m00:11:18.289181 [debug] [Thread-10 ]: On model.data_takehome.patient_metadata: BEGIN
[0m00:11:18.289320 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m00:11:18.291773 [debug] [Thread-10 ]: SQL status: OK in 0.002 seconds
[0m00:11:18.291951 [debug] [Thread-10 ]: Using duckdb connection "model.data_takehome.patient_metadata"
[0m00:11:18.292112 [debug] [Thread-10 ]: On model.data_takehome.patient_metadata: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patient_metadata"} */

  
    
    

    create  table
      "data_takehome"."main"."patient_metadata__dbt_tmp"
  
    as (
      with patients as (
select *
 FROM "data_takehome"."main"."int__patients"
)

, practices as (
select *
 FROM "data_takehome"."main"."int__practices"
)

select
      patient_id
    , practice_id
    , practices.practice_name
    , practices.location
    , pcn_name
    , age
    , gender
    , registration_date
    , conditions
FROM patients
LEFT JOIN practices
ON patients.patients_id = practices.id
    );
  
  
[0m00:11:18.294615 [debug] [Thread-10 ]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patient_metadata"} */

  
    
    

    create  table
      "data_takehome"."main"."patient_metadata__dbt_tmp"
  
    as (
      with patients as (
select *
 FROM "data_takehome"."main"."int__patients"
)

, practices as (
select *
 FROM "data_takehome"."main"."int__practices"
)

select
      patient_id
    , practice_id
    , practices.practice_name
    , practices.location
    , pcn_name
    , age
    , gender
    , registration_date
    , conditions
FROM patients
LEFT JOIN practices
ON patients.patients_id = practices.id
    );
  
  
[0m00:11:18.294785 [debug] [Thread-10 ]: DuckDB adapter: Rolling back transaction.
[0m00:11:18.294977 [debug] [Thread-10 ]: On model.data_takehome.patient_metadata: ROLLBACK
[0m00:11:18.299836 [debug] [Thread-10 ]: Failed to rollback 'model.data_takehome.patient_metadata'
[0m00:11:18.300043 [debug] [Thread-10 ]: On model.data_takehome.patient_metadata: Close
[0m00:11:18.301852 [debug] [Thread-10 ]: Runtime Error in model patient_metadata (models/mart/patient_metadata.sql)
  Binder Error: Values list "patients" does not have a column named "patients_id"
  LINE 33: ON patients.patients_id = practices.id
              ^
[0m00:11:18.302075 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17cf3217-fb1e-47a7-814c-6a14111be95b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109033200>]}
[0m00:11:18.302357 [error] [Thread-10 ]: 7 of 7 ERROR creating sql table model main.patient_metadata .................... [[31mERROR[0m in 0.02s]
[0m00:11:18.302610 [debug] [Thread-10 ]: Finished running node model.data_takehome.patient_metadata
[0m00:11:18.303502 [debug] [MainThread]: Using duckdb connection "master"
[0m00:11:18.303643 [debug] [MainThread]: On master: BEGIN
[0m00:11:18.303760 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:11:18.306154 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m00:11:18.306317 [debug] [MainThread]: On master: COMMIT
[0m00:11:18.306447 [debug] [MainThread]: Using duckdb connection "master"
[0m00:11:18.306561 [debug] [MainThread]: On master: COMMIT
[0m00:11:18.306696 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:11:18.306824 [debug] [MainThread]: On master: Close
[0m00:11:18.307278 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:11:18.307431 [debug] [MainThread]: Connection 'model.data_takehome.stg__activities' was properly closed.
[0m00:11:18.307549 [debug] [MainThread]: Connection 'model.data_takehome.stg__patients' was properly closed.
[0m00:11:18.307653 [debug] [MainThread]: Connection 'model.data_takehome.stg__pcns' was properly closed.
[0m00:11:18.307751 [debug] [MainThread]: Connection 'model.data_takehome.stg__practices' was properly closed.
[0m00:11:18.307847 [debug] [MainThread]: Connection 'model.data_takehome.int__patients' was properly closed.
[0m00:11:18.307942 [debug] [MainThread]: Connection 'model.data_takehome.int__practices' was properly closed.
[0m00:11:18.308037 [debug] [MainThread]: Connection 'model.data_takehome.patient_metadata' was properly closed.
[0m00:11:18.308204 [info ] [MainThread]: 
[0m00:11:18.308352 [info ] [MainThread]: Finished running 4 view models, 3 table models in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m00:11:18.308961 [debug] [MainThread]: Command end result
[0m00:11:18.323516 [info ] [MainThread]: 
[0m00:11:18.323794 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:11:18.323940 [info ] [MainThread]: 
[0m00:11:18.324123 [error] [MainThread]:   Runtime Error in model patient_metadata (models/mart/patient_metadata.sql)
  Binder Error: Values list "patients" does not have a column named "patients_id"
  LINE 33: ON patients.patients_id = practices.id
              ^
[0m00:11:18.324334 [info ] [MainThread]: 
[0m00:11:18.324484 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m00:11:18.326248 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.63092977, "process_user_time": 1.092841, "process_kernel_time": 0.163879, "process_mem_max_rss": "157171712", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:11:18.326573 [debug] [MainThread]: Command `dbt run` failed at 00:11:18.326524 after 0.63 seconds
[0m00:11:18.326777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108649970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108afdf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058f6750>]}
[0m00:11:18.326947 [debug] [MainThread]: Flushing usage events
[0m00:11:48.968776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10308f200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10587da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10587d670>]}


============================== 00:11:48.971391 | 4b6b74a2-8315-4210-9386-30f16cbf11e3 ==============================
[0m00:11:48.971391 [info ] [MainThread]: Running with dbt=1.8.1
[0m00:11:48.971715 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:11:49.061105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b6b74a2-8315-4210-9386-30f16cbf11e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058ecd70>]}
[0m00:11:49.104265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b6b74a2-8315-4210-9386-30f16cbf11e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056bc7a0>]}
[0m00:11:49.104770 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m00:11:49.154144 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m00:11:49.208976 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:11:49.209317 [debug] [MainThread]: Partial parsing: updated file: data_takehome://models/mart/patient_metadata.sql
[0m00:11:49.303206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b6b74a2-8315-4210-9386-30f16cbf11e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ff4260>]}
[0m00:11:49.342755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b6b74a2-8315-4210-9386-30f16cbf11e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060a9460>]}
[0m00:11:49.343042 [info ] [MainThread]: Found 4 seeds, 7 models, 421 macros
[0m00:11:49.343216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b6b74a2-8315-4210-9386-30f16cbf11e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060c26f0>]}
[0m00:11:49.344023 [info ] [MainThread]: 
[0m00:11:49.344295 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:11:49.346528 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_data_takehome'
[0m00:11:49.383445 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome"
[0m00:11:49.383696 [debug] [ThreadPool]: On list_data_takehome: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m00:11:49.383849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:11:49.387928 [debug] [ThreadPool]: SQL status: OK in 0.004 seconds
[0m00:11:49.388629 [debug] [ThreadPool]: On list_data_takehome: Close
[0m00:11:49.389359 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data_takehome, now create_data_takehome_main)
[0m00:11:49.389605 [debug] [ThreadPool]: Creating schema "database: "data_takehome"
schema: "main"
"
[0m00:11:49.392915 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m00:11:49.393093 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
        select type from duckdb_databases()
        where database_name='data_takehome'
        and type='sqlite'
    
  
[0m00:11:49.393239 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:11:49.396014 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:11:49.396697 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m00:11:49.396833 [debug] [ThreadPool]: On create_data_takehome_main: BEGIN
[0m00:11:49.396980 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:11:49.397091 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m00:11:49.397206 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
    
        create schema if not exists "data_takehome"."main"
    
[0m00:11:49.397364 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:11:49.397726 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m00:11:49.397851 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m00:11:49.397963 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m00:11:49.398101 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:11:49.398219 [debug] [ThreadPool]: On create_data_takehome_main: Close
[0m00:11:49.399327 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_data_takehome_main, now list_data_takehome_main)
[0m00:11:49.401890 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m00:11:49.402049 [debug] [ThreadPool]: On list_data_takehome_main: BEGIN
[0m00:11:49.402172 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:11:49.404523 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:11:49.404686 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m00:11:49.404840 [debug] [ThreadPool]: On list_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome_main"} */
select
      'data_takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'data_takehome'
  
[0m00:11:49.414222 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m00:11:49.416501 [debug] [ThreadPool]: On list_data_takehome_main: ROLLBACK
[0m00:11:49.417529 [debug] [ThreadPool]: Failed to rollback 'list_data_takehome_main'
[0m00:11:49.417668 [debug] [ThreadPool]: On list_data_takehome_main: Close
[0m00:11:49.419100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b6b74a2-8315-4210-9386-30f16cbf11e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f1ac00>]}
[0m00:11:49.419306 [debug] [MainThread]: Using duckdb connection "master"
[0m00:11:49.419426 [debug] [MainThread]: On master: BEGIN
[0m00:11:49.419539 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:11:49.421838 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m00:11:49.421998 [debug] [MainThread]: On master: COMMIT
[0m00:11:49.422127 [debug] [MainThread]: Using duckdb connection "master"
[0m00:11:49.422246 [debug] [MainThread]: On master: COMMIT
[0m00:11:49.422380 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:11:49.422503 [debug] [MainThread]: On master: Close
[0m00:11:49.422990 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m00:11:49.423147 [info ] [MainThread]: 
[0m00:11:49.425192 [debug] [Thread-1 (]: Began running node model.data_takehome.stg__activities
[0m00:11:49.425393 [debug] [Thread-2 (]: Began running node model.data_takehome.stg__patients
[0m00:11:49.425564 [debug] [Thread-3 (]: Began running node model.data_takehome.stg__pcns
[0m00:11:49.425916 [debug] [Thread-4 (]: Began running node model.data_takehome.stg__practices
[0m00:11:49.425788 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg__activities ............................... [RUN]
[0m00:11:49.426191 [info ] [Thread-2 (]: 2 of 7 START sql view model main.stg__patients ................................. [RUN]
[0m00:11:49.426410 [info ] [Thread-3 (]: 3 of 7 START sql view model main.stg__pcns ..................................... [RUN]
[0m00:11:49.426627 [info ] [Thread-4 (]: 4 of 7 START sql view model main.stg__practices ................................ [RUN]
[0m00:11:49.426870 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_takehome_main, now model.data_takehome.stg__activities)
[0m00:11:49.427113 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.data_takehome.stg__patients'
[0m00:11:49.427319 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.data_takehome.stg__pcns'
[0m00:11:49.427507 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.data_takehome.stg__practices'
[0m00:11:49.427657 [debug] [Thread-1 (]: Began compiling node model.data_takehome.stg__activities
[0m00:11:49.427800 [debug] [Thread-2 (]: Began compiling node model.data_takehome.stg__patients
[0m00:11:49.427938 [debug] [Thread-3 (]: Began compiling node model.data_takehome.stg__pcns
[0m00:11:49.428074 [debug] [Thread-4 (]: Began compiling node model.data_takehome.stg__practices
[0m00:11:49.431603 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_takehome.stg__activities"
[0m00:11:49.432709 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_takehome.stg__patients"
[0m00:11:49.433839 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_takehome.stg__pcns"
[0m00:11:49.434916 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_takehome.stg__practices"
[0m00:11:49.435427 [debug] [Thread-1 (]: Began executing node model.data_takehome.stg__activities
[0m00:11:49.441505 [debug] [Thread-3 (]: Began executing node model.data_takehome.stg__pcns
[0m00:11:49.450841 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_takehome.stg__activities"
[0m00:11:49.451029 [debug] [Thread-2 (]: Began executing node model.data_takehome.stg__patients
[0m00:11:49.453255 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_takehome.stg__pcns"
[0m00:11:49.454838 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_takehome.stg__patients"
[0m00:11:49.455010 [debug] [Thread-4 (]: Began executing node model.data_takehome.stg__practices
[0m00:11:49.456717 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_takehome.stg__practices"
[0m00:11:49.457016 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m00:11:49.457205 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m00:11:49.457372 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: BEGIN
[0m00:11:49.457561 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m00:11:49.457754 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: BEGIN
[0m00:11:49.457923 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m00:11:49.458068 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:11:49.458226 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: BEGIN
[0m00:11:49.458366 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:11:49.458510 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: BEGIN
[0m00:11:49.460927 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m00:11:49.461107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:11:49.461283 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:11:49.461433 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m00:11:49.461582 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m00:11:49.461793 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:11:49.461934 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m00:11:49.462079 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:11:49.462217 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */

  
  create view "data_takehome"."main"."stg__pcns__dbt_tmp" as (
    with pcns as (
select * from "data_takehome"."main"."raw_pcns" )

select * from pcns
  );

[0m00:11:49.462363 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m00:11:49.462509 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */

  
  create view "data_takehome"."main"."stg__patients__dbt_tmp" as (
    with patients as (
select * from "data_takehome"."main"."raw_patients" )

select * from patients
  );

[0m00:11:49.462654 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m00:11:49.462822 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */

  
  create view "data_takehome"."main"."stg__activities__dbt_tmp" as (
    with activities as (
select * from "data_takehome"."main"."raw_activities" )

select * from activities
  );

[0m00:11:49.463011 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */

  
  create view "data_takehome"."main"."stg__practices__dbt_tmp" as (
    with practices as (
select * from "data_takehome"."main"."raw_practices" )

select * from practices
  );

[0m00:11:49.463198 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m00:11:49.463357 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m00:11:49.466453 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m00:11:49.466619 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:11:49.466776 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m00:11:49.468119 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m00:11:49.468285 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */
alter view "data_takehome"."main"."stg__pcns" rename to "stg__pcns__dbt_backup"
[0m00:11:49.469630 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m00:11:49.470934 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m00:11:49.471092 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */
alter view "data_takehome"."main"."stg__patients" rename to "stg__patients__dbt_backup"
[0m00:11:49.471276 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */
alter view "data_takehome"."main"."stg__activities" rename to "stg__activities__dbt_backup"
[0m00:11:49.471441 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */
alter view "data_takehome"."main"."stg__practices" rename to "stg__practices__dbt_backup"
[0m00:11:49.471613 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m00:11:49.472872 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m00:11:49.473028 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */
alter view "data_takehome"."main"."stg__pcns__dbt_tmp" rename to "stg__pcns"
[0m00:11:49.473200 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:11:49.474438 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m00:11:49.474589 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */
alter view "data_takehome"."main"."stg__activities__dbt_tmp" rename to "stg__activities"
[0m00:11:49.474757 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m00:11:49.475975 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m00:11:49.476166 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m00:11:49.476301 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m00:11:49.476429 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:11:49.477416 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */
alter view "data_takehome"."main"."stg__patients__dbt_tmp" rename to "stg__patients"
[0m00:11:49.478702 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m00:11:49.487762 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: COMMIT
[0m00:11:49.488044 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: COMMIT
[0m00:11:49.488291 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m00:11:49.488448 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */
alter view "data_takehome"."main"."stg__practices__dbt_tmp" rename to "stg__practices"
[0m00:11:49.488666 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m00:11:49.489243 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m00:11:49.489974 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: COMMIT
[0m00:11:49.491011 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: COMMIT
[0m00:11:49.491155 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: COMMIT
[0m00:11:49.491322 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m00:11:49.491461 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m00:11:49.492190 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: COMMIT
[0m00:11:49.492350 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: COMMIT
[0m00:11:49.492491 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:11:49.492623 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:11:49.492764 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m00:11:49.495122 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m00:11:49.495287 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m00:11:49.496305 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m00:11:49.496463 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: COMMIT
[0m00:11:49.496623 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */
drop view if exists "data_takehome"."main"."stg__activities__dbt_backup" cascade
[0m00:11:49.497608 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m00:11:49.497767 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */
drop view if exists "data_takehome"."main"."stg__pcns__dbt_backup" cascade
[0m00:11:49.497989 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */
drop view if exists "data_takehome"."main"."stg__patients__dbt_backup" cascade
[0m00:11:49.498140 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m00:11:49.499170 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m00:11:49.499319 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */
drop view if exists "data_takehome"."main"."stg__practices__dbt_backup" cascade
[0m00:11:49.499470 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:11:49.500638 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: Close
[0m00:11:49.501094 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m00:11:49.501449 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b6b74a2-8315-4210-9386-30f16cbf11e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034f79e0>]}
[0m00:11:49.501611 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m00:11:49.502167 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: Close
[0m00:11:49.502613 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m00:11:49.502472 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.stg__activities .......................... [[32mOK[0m in 0.07s]
[0m00:11:49.503250 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: Close
[0m00:11:49.503457 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b6b74a2-8315-4210-9386-30f16cbf11e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10675e510>]}
[0m00:11:49.504030 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: Close
[0m00:11:49.504270 [debug] [Thread-1 (]: Finished running node model.data_takehome.stg__activities
[0m00:11:49.504466 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b6b74a2-8315-4210-9386-30f16cbf11e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10657acf0>]}
[0m00:11:49.504718 [info ] [Thread-3 (]: 3 of 7 OK created sql view model main.stg__pcns ................................ [[32mOK[0m in 0.08s]
[0m00:11:49.506165 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b6b74a2-8315-4210-9386-30f16cbf11e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10655d3d0>]}
[0m00:11:49.506750 [debug] [Thread-3 (]: Finished running node model.data_takehome.stg__pcns
[0m00:11:49.506535 [info ] [Thread-2 (]: 2 of 7 OK created sql view model main.stg__patients ............................ [[32mOK[0m in 0.08s]
[0m00:11:49.507059 [info ] [Thread-4 (]: 4 of 7 OK created sql view model main.stg__practices ........................... [[32mOK[0m in 0.08s]
[0m00:11:49.507367 [debug] [Thread-2 (]: Finished running node model.data_takehome.stg__patients
[0m00:11:49.507592 [debug] [Thread-4 (]: Finished running node model.data_takehome.stg__practices
[0m00:11:49.507976 [debug] [Thread-6 (]: Began running node model.data_takehome.int__patients
[0m00:11:49.508158 [debug] [Thread-7 (]: Began running node model.data_takehome.int__practices
[0m00:11:49.508350 [info ] [Thread-6 (]: 5 of 7 START sql table model main.int__patients ................................ [RUN]
[0m00:11:49.508586 [info ] [Thread-7 (]: 6 of 7 START sql table model main.int__practices ............................... [RUN]
[0m00:11:49.508854 [debug] [Thread-6 (]: Acquiring new duckdb connection 'model.data_takehome.int__patients'
[0m00:11:49.509082 [debug] [Thread-7 (]: Acquiring new duckdb connection 'model.data_takehome.int__practices'
[0m00:11:49.509247 [debug] [Thread-6 (]: Began compiling node model.data_takehome.int__patients
[0m00:11:49.509401 [debug] [Thread-7 (]: Began compiling node model.data_takehome.int__practices
[0m00:11:49.510908 [debug] [Thread-6 (]: Writing injected SQL for node "model.data_takehome.int__patients"
[0m00:11:49.512100 [debug] [Thread-7 (]: Writing injected SQL for node "model.data_takehome.int__practices"
[0m00:11:49.512561 [debug] [Thread-6 (]: Began executing node model.data_takehome.int__patients
[0m00:11:49.512717 [debug] [Thread-7 (]: Began executing node model.data_takehome.int__practices
[0m00:11:49.522310 [debug] [Thread-6 (]: Writing runtime sql for node "model.data_takehome.int__patients"
[0m00:11:49.523901 [debug] [Thread-7 (]: Writing runtime sql for node "model.data_takehome.int__practices"
[0m00:11:49.524451 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m00:11:49.524644 [debug] [Thread-7 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m00:11:49.524804 [debug] [Thread-6 (]: On model.data_takehome.int__patients: BEGIN
[0m00:11:49.524966 [debug] [Thread-7 (]: On model.data_takehome.int__practices: BEGIN
[0m00:11:49.525119 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m00:11:49.525277 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m00:11:49.527868 [debug] [Thread-6 (]: SQL status: OK in 0.003 seconds
[0m00:11:49.528056 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m00:11:49.528218 [debug] [Thread-7 (]: SQL status: OK in 0.003 seconds
[0m00:11:49.528415 [debug] [Thread-6 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */

  
    
    

    create  table
      "data_takehome"."main"."int__patients__dbt_tmp"
  
    as (
      WITH patients AS (
  SELECT 
    json_extract_string(data, '$.patient_id') AS patient_id,
    json_extract_string(data, '$.practice_id') AS practice_id,
    json_extract_string(data, '$.age') AS age,
    json_extract_string(data, '$.gender') AS gender,
    json_extract_string(data, '$.registration_date') AS registration_date,
    json_extract_string(data, '$.conditions') AS conditions,
    json_extract_string(data, '$.contact.email') AS email,
    json_extract_string(data, '$.contact.phone') AS phone
  FROM "data_takehome"."main"."stg__patients"
)

, clean_patients as (
-- remove square brackets from conditions column and clean phone number
SELECT 
  patient_id,
  practice_id,
  age,
  gender,
  registration_date,
  replace(CASE
    WHEN conditions LIKE '[%' AND conditions LIKE '%]'
    THEN substr(conditions, 2, length(conditions)-2)
    ELSE conditions
  END, '"', '') as conditions,
  email,
      regexp_replace(
        -- Step 2: Handle leading 1 or 001
        CASE
            WHEN regexp_matches(regexp_replace(phone, '[^0-9]', '', 'g'), '^(1|001)')
            THEN regexp_replace(regexp_replace(phone, '[^0-9]', '', 'g'), '^(1|001)', '')
            -- Step 3: Preserve numbers before letters, remove after
            ELSE regexp_replace(
                regexp_replace(phone, '([0-9]+)[a-zA-Z].*', '\1'),
                '[^0-9]', '', 'g'
            )
        END,
        -- Final cleanup in case any special chars remain
        '[^0-9]', '', 'g'
    ) AS phone
FROM patients)

select
     patient_id
   , practice_id
   , age
   , gender
   , registration_date
   , conditions
   , email
   , phone
from (
select *
 , dense_rank() over (partition by patient_id order by registration_date desc) as rank
from clean_patients) as a
where rank = 1
    );
  
  
[0m00:11:49.528612 [debug] [Thread-7 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m00:11:49.528796 [debug] [Thread-7 (]: On model.data_takehome.int__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__practices"} */

  
    
    

    create  table
      "data_takehome"."main"."int__practices__dbt_tmp"
  
    as (
      with pcns as (
select *
FROM "data_takehome"."main"."stg__pcns"
)

, practices as (
select *
FROM "data_takehome"."main"."stg__practices"
)


select
     practices.id
   , practices.practice_name
   , practices.location
   , practices.established_date
   , practices.pcn
   , pcn_name
  from practices
  left join pcns
  on pcns.id = practices.pcn
    );
  
  
[0m00:11:49.529996 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m00:11:49.531928 [debug] [Thread-7 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m00:11:49.532186 [debug] [Thread-7 (]: On model.data_takehome.int__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__practices"} */
alter table "data_takehome"."main"."int__practices" rename to "int__practices__dbt_backup"
[0m00:11:49.533057 [debug] [Thread-6 (]: SQL status: OK in 0.004 seconds
[0m00:11:49.534528 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m00:11:49.534694 [debug] [Thread-6 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */
alter table "data_takehome"."main"."int__patients" rename to "int__patients__dbt_backup"
[0m00:11:49.534918 [debug] [Thread-7 (]: SQL status: OK in 0.002 seconds
[0m00:11:49.536349 [debug] [Thread-7 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m00:11:49.536517 [debug] [Thread-7 (]: On model.data_takehome.int__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__practices"} */
alter table "data_takehome"."main"."int__practices__dbt_tmp" rename to "int__practices"
[0m00:11:49.536727 [debug] [Thread-6 (]: SQL status: OK in 0.002 seconds
[0m00:11:49.536890 [debug] [Thread-7 (]: SQL status: OK in 0.000 seconds
[0m00:11:49.539090 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m00:11:49.541666 [debug] [Thread-7 (]: On model.data_takehome.int__practices: COMMIT
[0m00:11:49.541857 [debug] [Thread-6 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */
alter table "data_takehome"."main"."int__patients__dbt_tmp" rename to "int__patients"
[0m00:11:49.542034 [debug] [Thread-7 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m00:11:49.542298 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m00:11:49.542570 [debug] [Thread-7 (]: On model.data_takehome.int__practices: COMMIT
[0m00:11:49.543424 [debug] [Thread-6 (]: On model.data_takehome.int__patients: COMMIT
[0m00:11:49.543615 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m00:11:49.543796 [debug] [Thread-6 (]: On model.data_takehome.int__patients: COMMIT
[0m00:11:49.544075 [debug] [Thread-7 (]: SQL status: OK in 0.000 seconds
[0m00:11:49.545413 [debug] [Thread-7 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m00:11:49.545582 [debug] [Thread-7 (]: On model.data_takehome.int__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__practices"} */
drop table if exists "data_takehome"."main"."int__practices__dbt_backup" cascade
[0m00:11:49.545818 [debug] [Thread-6 (]: SQL status: OK in 0.002 seconds
[0m00:11:49.546772 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m00:11:49.546927 [debug] [Thread-6 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */
drop table if exists "data_takehome"."main"."int__patients__dbt_backup" cascade
[0m00:11:49.547522 [debug] [Thread-7 (]: SQL status: OK in 0.002 seconds
[0m00:11:49.548231 [debug] [Thread-7 (]: On model.data_takehome.int__practices: Close
[0m00:11:49.548484 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b6b74a2-8315-4210-9386-30f16cbf11e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10680ffb0>]}
[0m00:11:49.548928 [debug] [Thread-6 (]: SQL status: OK in 0.002 seconds
[0m00:11:49.548796 [info ] [Thread-7 (]: 6 of 7 OK created sql table model main.int__practices .......................... [[32mOK[0m in 0.04s]
[0m00:11:49.549587 [debug] [Thread-6 (]: On model.data_takehome.int__patients: Close
[0m00:11:49.549830 [debug] [Thread-7 (]: Finished running node model.data_takehome.int__practices
[0m00:11:49.555041 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b6b74a2-8315-4210-9386-30f16cbf11e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060c1cd0>]}
[0m00:11:49.555497 [info ] [Thread-6 (]: 5 of 7 OK created sql table model main.int__patients ........................... [[32mOK[0m in 0.05s]
[0m00:11:49.555764 [debug] [Thread-6 (]: Finished running node model.data_takehome.int__patients
[0m00:11:49.556186 [debug] [Thread-9 (]: Began running node model.data_takehome.patient_metadata
[0m00:11:49.556426 [info ] [Thread-9 (]: 7 of 7 START sql table model main.patient_metadata ............................. [RUN]
[0m00:11:49.556690 [debug] [Thread-9 (]: Acquiring new duckdb connection 'model.data_takehome.patient_metadata'
[0m00:11:49.556855 [debug] [Thread-9 (]: Began compiling node model.data_takehome.patient_metadata
[0m00:11:49.558336 [debug] [Thread-9 (]: Writing injected SQL for node "model.data_takehome.patient_metadata"
[0m00:11:49.559038 [debug] [Thread-9 (]: Began executing node model.data_takehome.patient_metadata
[0m00:11:49.560729 [debug] [Thread-9 (]: Writing runtime sql for node "model.data_takehome.patient_metadata"
[0m00:11:49.561090 [debug] [Thread-9 (]: Using duckdb connection "model.data_takehome.patient_metadata"
[0m00:11:49.561241 [debug] [Thread-9 (]: On model.data_takehome.patient_metadata: BEGIN
[0m00:11:49.561382 [debug] [Thread-9 (]: Opening a new connection, currently in state init
[0m00:11:49.563901 [debug] [Thread-9 (]: SQL status: OK in 0.002 seconds
[0m00:11:49.564091 [debug] [Thread-9 (]: Using duckdb connection "model.data_takehome.patient_metadata"
[0m00:11:49.564281 [debug] [Thread-9 (]: On model.data_takehome.patient_metadata: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patient_metadata"} */

  
    
    

    create  table
      "data_takehome"."main"."patient_metadata__dbt_tmp"
  
    as (
      with patients as (
select *
 FROM "data_takehome"."main"."int__patients"
)

, practices as (
select *
 FROM "data_takehome"."main"."int__practices"
)

select
      patient_id
    , practice_id
    , practices.practice_name
    , practices.location
    , pcn_name
    , age
    , gender
    , registration_date
    , conditions
FROM patients
LEFT JOIN practices
ON patients.patient_id = practices.id
    );
  
  
[0m00:11:49.565912 [debug] [Thread-9 (]: SQL status: OK in 0.001 seconds
[0m00:11:49.567574 [debug] [Thread-9 (]: Using duckdb connection "model.data_takehome.patient_metadata"
[0m00:11:49.567740 [debug] [Thread-9 (]: On model.data_takehome.patient_metadata: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patient_metadata"} */
alter table "data_takehome"."main"."patient_metadata__dbt_tmp" rename to "patient_metadata"
[0m00:11:49.567986 [debug] [Thread-9 (]: SQL status: OK in 0.000 seconds
[0m00:11:49.568688 [debug] [Thread-9 (]: On model.data_takehome.patient_metadata: COMMIT
[0m00:11:49.568843 [debug] [Thread-9 (]: Using duckdb connection "model.data_takehome.patient_metadata"
[0m00:11:49.568981 [debug] [Thread-9 (]: On model.data_takehome.patient_metadata: COMMIT
[0m00:11:49.569949 [debug] [Thread-9 (]: SQL status: OK in 0.001 seconds
[0m00:11:49.571029 [debug] [Thread-9 (]: Using duckdb connection "model.data_takehome.patient_metadata"
[0m00:11:49.571200 [debug] [Thread-9 (]: On model.data_takehome.patient_metadata: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patient_metadata"} */
drop table if exists "data_takehome"."main"."patient_metadata__dbt_backup" cascade
[0m00:11:49.571501 [debug] [Thread-9 (]: SQL status: OK in 0.000 seconds
[0m00:11:49.572121 [debug] [Thread-9 (]: On model.data_takehome.patient_metadata: Close
[0m00:11:49.575728 [debug] [Thread-9 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b6b74a2-8315-4210-9386-30f16cbf11e3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106541880>]}
[0m00:11:49.576040 [info ] [Thread-9 (]: 7 of 7 OK created sql table model main.patient_metadata ........................ [[32mOK[0m in 0.02s]
[0m00:11:49.576298 [debug] [Thread-9 (]: Finished running node model.data_takehome.patient_metadata
[0m00:11:49.577162 [debug] [MainThread]: Using duckdb connection "master"
[0m00:11:49.577302 [debug] [MainThread]: On master: BEGIN
[0m00:11:49.577418 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:11:49.579792 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m00:11:49.579951 [debug] [MainThread]: On master: COMMIT
[0m00:11:49.580080 [debug] [MainThread]: Using duckdb connection "master"
[0m00:11:49.580191 [debug] [MainThread]: On master: COMMIT
[0m00:11:49.580326 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:11:49.580448 [debug] [MainThread]: On master: Close
[0m00:11:49.580944 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:11:49.581070 [debug] [MainThread]: Connection 'model.data_takehome.stg__activities' was properly closed.
[0m00:11:49.581180 [debug] [MainThread]: Connection 'model.data_takehome.stg__patients' was properly closed.
[0m00:11:49.581282 [debug] [MainThread]: Connection 'model.data_takehome.stg__pcns' was properly closed.
[0m00:11:49.581378 [debug] [MainThread]: Connection 'model.data_takehome.stg__practices' was properly closed.
[0m00:11:49.581475 [debug] [MainThread]: Connection 'model.data_takehome.int__patients' was properly closed.
[0m00:11:49.581571 [debug] [MainThread]: Connection 'model.data_takehome.int__practices' was properly closed.
[0m00:11:49.581665 [debug] [MainThread]: Connection 'model.data_takehome.patient_metadata' was properly closed.
[0m00:11:49.581910 [info ] [MainThread]: 
[0m00:11:49.582066 [info ] [MainThread]: Finished running 4 view models, 3 table models in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m00:11:49.582674 [debug] [MainThread]: Command end result
[0m00:11:49.596469 [info ] [MainThread]: 
[0m00:11:49.596716 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:11:49.596872 [info ] [MainThread]: 
[0m00:11:49.597030 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m00:11:49.599027 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.66260004, "process_user_time": 1.097921, "process_kernel_time": 0.168138, "process_mem_max_rss": "162168832", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:11:49.599280 [debug] [MainThread]: Command `dbt run` succeeded at 00:11:49.599239 after 0.66 seconds
[0m00:11:49.599451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fe7c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fc52e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1011feb10>]}
[0m00:11:49.599609 [debug] [MainThread]: Flushing usage events
[0m00:16:54.828260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108048a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108349880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083494c0>]}


============================== 00:16:54.840899 | bb563718-e6b4-4a34-8bf2-574c8a4f6147 ==============================
[0m00:16:54.840899 [info ] [MainThread]: Running with dbt=1.8.1
[0m00:16:54.841247 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:16:55.013271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb563718-e6b4-4a34-8bf2-574c8a4f6147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080625d0>]}
[0m00:16:55.056149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb563718-e6b4-4a34-8bf2-574c8a4f6147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083a5160>]}
[0m00:16:55.056999 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m00:16:55.113084 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m00:16:55.171532 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:16:55.171856 [debug] [MainThread]: Partial parsing: updated file: data_takehome://models/mart/patient_metadata.sql
[0m00:16:55.268315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb563718-e6b4-4a34-8bf2-574c8a4f6147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083074a0>]}
[0m00:16:55.310573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb563718-e6b4-4a34-8bf2-574c8a4f6147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ba9310>]}
[0m00:16:55.310859 [info ] [MainThread]: Found 4 seeds, 7 models, 421 macros
[0m00:16:55.311029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb563718-e6b4-4a34-8bf2-574c8a4f6147', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108be63f0>]}
[0m00:16:55.311860 [info ] [MainThread]: 
[0m00:16:55.312141 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:16:55.314396 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_data_takehome'
[0m00:16:55.357183 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome"
[0m00:16:55.357419 [debug] [ThreadPool]: On list_data_takehome: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m00:16:55.357565 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:16:55.365498 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m00:16:55.365714 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m00:16:55.366083 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:16:55.366213 [debug] [MainThread]: Connection 'list_data_takehome' was properly closed.
[0m00:16:55.366349 [info ] [MainThread]: 
[0m00:16:55.366495 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.05 seconds (0.05s).
[0m00:16:55.366722 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/qamr/Documents/Development/suvera/data-dbt-takehome/data_takehome.duckdb": Conflicting lock is held in /Applications/DBeaver.app/Contents/MacOS/dbeaver (PID 4014) by user qamr. See also https://duckdb.org/docs/connect/concurrency
[0m00:16:55.368751 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5761189, "process_user_time": 0.898009, "process_kernel_time": 0.200506, "process_mem_max_rss": "123437056", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:16:55.369066 [debug] [MainThread]: Command `dbt run` failed at 00:16:55.369008 after 0.58 seconds
[0m00:16:55.369264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108349880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089dd7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c0a960>]}
[0m00:16:55.369440 [debug] [MainThread]: Flushing usage events
[0m00:17:13.227425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064d67b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b21970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b21580>]}


============================== 00:17:13.230421 | f3e2bd60-bbc1-4cdf-be9c-8df929fd5888 ==============================
[0m00:17:13.230421 [info ] [MainThread]: Running with dbt=1.8.1
[0m00:17:13.230744 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:17:13.367537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3e2bd60-bbc1-4cdf-be9c-8df929fd5888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065a1f40>]}
[0m00:17:13.409699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3e2bd60-bbc1-4cdf-be9c-8df929fd5888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c4c1a0>]}
[0m00:17:13.411159 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m00:17:13.464838 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m00:17:13.517852 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:17:13.518081 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:17:13.533799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3e2bd60-bbc1-4cdf-be9c-8df929fd5888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068694c0>]}
[0m00:17:13.573339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3e2bd60-bbc1-4cdf-be9c-8df929fd5888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106efb440>]}
[0m00:17:13.573621 [info ] [MainThread]: Found 4 seeds, 7 models, 421 macros
[0m00:17:13.573790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3e2bd60-bbc1-4cdf-be9c-8df929fd5888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b4ec60>]}
[0m00:17:13.574618 [info ] [MainThread]: 
[0m00:17:13.574893 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:17:13.577132 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_data_takehome'
[0m00:17:13.609795 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome"
[0m00:17:13.610034 [debug] [ThreadPool]: On list_data_takehome: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m00:17:13.610183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:17:13.622298 [debug] [ThreadPool]: SQL status: OK in 0.012 seconds
[0m00:17:13.623271 [debug] [ThreadPool]: On list_data_takehome: Close
[0m00:17:13.624317 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data_takehome, now create_data_takehome_main)
[0m00:17:13.624595 [debug] [ThreadPool]: Creating schema "database: "data_takehome"
schema: "main"
"
[0m00:17:13.627889 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m00:17:13.628070 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
        select type from duckdb_databases()
        where database_name='data_takehome'
        and type='sqlite'
    
  
[0m00:17:13.628206 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:17:13.631253 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:17:13.631978 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m00:17:13.632117 [debug] [ThreadPool]: On create_data_takehome_main: BEGIN
[0m00:17:13.632264 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:17:13.632382 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m00:17:13.632501 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
    
        create schema if not exists "data_takehome"."main"
    
[0m00:17:13.632728 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:17:13.633116 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m00:17:13.633240 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m00:17:13.633352 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m00:17:13.633496 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:17:13.633621 [debug] [ThreadPool]: On create_data_takehome_main: Close
[0m00:17:13.634725 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_data_takehome_main, now list_data_takehome_main)
[0m00:17:13.637364 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m00:17:13.637534 [debug] [ThreadPool]: On list_data_takehome_main: BEGIN
[0m00:17:13.637661 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:17:13.640020 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:17:13.640192 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m00:17:13.640334 [debug] [ThreadPool]: On list_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome_main"} */
select
      'data_takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'data_takehome'
  
[0m00:17:13.651370 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m00:17:13.653927 [debug] [ThreadPool]: On list_data_takehome_main: ROLLBACK
[0m00:17:13.655479 [debug] [ThreadPool]: Failed to rollback 'list_data_takehome_main'
[0m00:17:13.656059 [debug] [ThreadPool]: On list_data_takehome_main: Close
[0m00:17:13.657610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3e2bd60-bbc1-4cdf-be9c-8df929fd5888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b23b00>]}
[0m00:17:13.657839 [debug] [MainThread]: Using duckdb connection "master"
[0m00:17:13.657976 [debug] [MainThread]: On master: BEGIN
[0m00:17:13.658095 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:17:13.660444 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m00:17:13.660611 [debug] [MainThread]: On master: COMMIT
[0m00:17:13.660758 [debug] [MainThread]: Using duckdb connection "master"
[0m00:17:13.660875 [debug] [MainThread]: On master: COMMIT
[0m00:17:13.661023 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:17:13.661151 [debug] [MainThread]: On master: Close
[0m00:17:13.661634 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m00:17:13.661802 [info ] [MainThread]: 
[0m00:17:13.663888 [debug] [Thread-1 (]: Began running node model.data_takehome.stg__activities
[0m00:17:13.664087 [debug] [Thread-2 (]: Began running node model.data_takehome.stg__patients
[0m00:17:13.664461 [debug] [Thread-3 (]: Began running node model.data_takehome.stg__pcns
[0m00:17:13.664616 [debug] [Thread-4 (]: Began running node model.data_takehome.stg__practices
[0m00:17:13.664326 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg__activities ............................... [RUN]
[0m00:17:13.664851 [info ] [Thread-2 (]: 2 of 7 START sql view model main.stg__patients ................................. [RUN]
[0m00:17:13.665039 [info ] [Thread-3 (]: 3 of 7 START sql view model main.stg__pcns ..................................... [RUN]
[0m00:17:13.665249 [info ] [Thread-4 (]: 4 of 7 START sql view model main.stg__practices ................................ [RUN]
[0m00:17:13.665503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_takehome_main, now model.data_takehome.stg__activities)
[0m00:17:13.665719 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.data_takehome.stg__patients'
[0m00:17:13.665921 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.data_takehome.stg__pcns'
[0m00:17:13.666104 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.data_takehome.stg__practices'
[0m00:17:13.666252 [debug] [Thread-1 (]: Began compiling node model.data_takehome.stg__activities
[0m00:17:13.666394 [debug] [Thread-2 (]: Began compiling node model.data_takehome.stg__patients
[0m00:17:13.666528 [debug] [Thread-3 (]: Began compiling node model.data_takehome.stg__pcns
[0m00:17:13.666661 [debug] [Thread-4 (]: Began compiling node model.data_takehome.stg__practices
[0m00:17:13.670167 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_takehome.stg__activities"
[0m00:17:13.672170 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_takehome.stg__patients"
[0m00:17:13.673340 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_takehome.stg__pcns"
[0m00:17:13.674613 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_takehome.stg__practices"
[0m00:17:13.675810 [debug] [Thread-2 (]: Began executing node model.data_takehome.stg__patients
[0m00:17:13.676004 [debug] [Thread-4 (]: Began executing node model.data_takehome.stg__practices
[0m00:17:13.676186 [debug] [Thread-3 (]: Began executing node model.data_takehome.stg__pcns
[0m00:17:13.682717 [debug] [Thread-1 (]: Began executing node model.data_takehome.stg__activities
[0m00:17:13.696909 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_takehome.stg__practices"
[0m00:17:13.698027 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_takehome.stg__patients"
[0m00:17:13.699478 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_takehome.stg__activities"
[0m00:17:13.699668 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_takehome.stg__pcns"
[0m00:17:13.700304 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m00:17:13.700459 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: BEGIN
[0m00:17:13.700600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:17:13.703139 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m00:17:13.703350 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m00:17:13.703529 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:17:13.703677 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: BEGIN
[0m00:17:13.703835 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m00:17:13.703985 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: BEGIN
[0m00:17:13.704135 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m00:17:13.704279 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:17:13.704421 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: BEGIN
[0m00:17:13.704554 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:17:13.704699 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */

  
  create view "data_takehome"."main"."stg__activities__dbt_tmp" as (
    with activities as (
select * from "data_takehome"."main"."raw_activities" )

select * from activities
  );

[0m00:17:13.704872 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:17:13.705080 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:17:13.705269 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m00:17:13.705455 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:17:13.705591 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m00:17:13.705739 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:17:13.705867 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m00:17:13.708981 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m00:17:13.709169 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */

  
  create view "data_takehome"."main"."stg__pcns__dbt_tmp" as (
    with pcns as (
select * from "data_takehome"."main"."raw_pcns" )

select * from pcns
  );

[0m00:17:13.709330 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m00:17:13.709486 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */

  
  create view "data_takehome"."main"."stg__patients__dbt_tmp" as (
    with patients as (
select * from "data_takehome"."main"."raw_patients" )

select * from patients
  );

[0m00:17:13.709643 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */
alter view "data_takehome"."main"."stg__activities" rename to "stg__activities__dbt_backup"
[0m00:17:13.709812 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */

  
  create view "data_takehome"."main"."stg__practices__dbt_tmp" as (
    with practices as (
select * from "data_takehome"."main"."raw_practices" )

select * from practices
  );

[0m00:17:13.710080 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m00:17:13.711467 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m00:17:13.711623 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */
alter view "data_takehome"."main"."stg__pcns" rename to "stg__pcns__dbt_backup"
[0m00:17:13.711785 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m00:17:13.711960 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m00:17:13.712093 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:17:13.713944 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m00:17:13.715263 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m00:17:13.715414 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m00:17:13.716732 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m00:17:13.716896 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */
alter view "data_takehome"."main"."stg__patients" rename to "stg__patients__dbt_backup"
[0m00:17:13.717053 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */
alter view "data_takehome"."main"."stg__practices" rename to "stg__practices__dbt_backup"
[0m00:17:13.718285 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m00:17:13.718446 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */
alter view "data_takehome"."main"."stg__activities__dbt_tmp" rename to "stg__activities"
[0m00:17:13.718657 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m00:17:13.718806 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */
alter view "data_takehome"."main"."stg__pcns__dbt_tmp" rename to "stg__pcns"
[0m00:17:13.718945 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m00:17:13.720229 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m00:17:13.720374 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:17:13.721648 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m00:17:13.721839 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */
alter view "data_takehome"."main"."stg__patients__dbt_tmp" rename to "stg__patients"
[0m00:17:13.721984 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:17:13.729849 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: COMMIT
[0m00:17:13.730023 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */
alter view "data_takehome"."main"."stg__practices__dbt_tmp" rename to "stg__practices"
[0m00:17:13.730752 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: COMMIT
[0m00:17:13.730931 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m00:17:13.731146 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m00:17:13.731312 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m00:17:13.731495 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: COMMIT
[0m00:17:13.731642 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:17:13.732291 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: COMMIT
[0m00:17:13.732446 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: COMMIT
[0m00:17:13.733119 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: COMMIT
[0m00:17:13.733262 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:17:13.733401 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m00:17:13.733578 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m00:17:13.735863 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m00:17:13.736027 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m00:17:13.736178 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: COMMIT
[0m00:17:13.736316 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: COMMIT
[0m00:17:13.736454 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */
drop view if exists "data_takehome"."main"."stg__activities__dbt_backup" cascade
[0m00:17:13.737446 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m00:17:13.737704 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */
drop view if exists "data_takehome"."main"."stg__pcns__dbt_backup" cascade
[0m00:17:13.737883 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m00:17:13.738061 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m00:17:13.739080 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m00:17:13.739226 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:17:13.740225 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m00:17:13.740380 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */
drop view if exists "data_takehome"."main"."stg__practices__dbt_backup" cascade
[0m00:17:13.740523 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m00:17:13.741644 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: Close
[0m00:17:13.741817 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */
drop view if exists "data_takehome"."main"."stg__patients__dbt_backup" cascade
[0m00:17:13.742429 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: Close
[0m00:17:13.743083 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3e2bd60-bbc1-4cdf-be9c-8df929fd5888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073a89e0>]}
[0m00:17:13.743342 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3e2bd60-bbc1-4cdf-be9c-8df929fd5888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072e30e0>]}
[0m00:17:13.743508 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m00:17:13.743777 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.stg__activities .......................... [[32mOK[0m in 0.08s]
[0m00:17:13.744075 [info ] [Thread-3 (]: 3 of 7 OK created sql view model main.stg__pcns ................................ [[32mOK[0m in 0.08s]
[0m00:17:13.744279 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m00:17:13.744872 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: Close
[0m00:17:13.745115 [debug] [Thread-1 (]: Finished running node model.data_takehome.stg__activities
[0m00:17:13.745354 [debug] [Thread-3 (]: Finished running node model.data_takehome.stg__pcns
[0m00:17:13.745907 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: Close
[0m00:17:13.746104 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3e2bd60-bbc1-4cdf-be9c-8df929fd5888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073bba70>]}
[0m00:17:13.748758 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3e2bd60-bbc1-4cdf-be9c-8df929fd5888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073a8e00>]}
[0m00:17:13.749045 [info ] [Thread-4 (]: 4 of 7 OK created sql view model main.stg__practices ........................... [[32mOK[0m in 0.08s]
[0m00:17:13.749536 [debug] [Thread-4 (]: Finished running node model.data_takehome.stg__practices
[0m00:17:13.749321 [info ] [Thread-2 (]: 2 of 7 OK created sql view model main.stg__patients ............................ [[32mOK[0m in 0.08s]
[0m00:17:13.749849 [debug] [Thread-2 (]: Finished running node model.data_takehome.stg__patients
[0m00:17:13.750207 [debug] [Thread-6 (]: Began running node model.data_takehome.int__patients
[0m00:17:13.750403 [debug] [Thread-7 (]: Began running node model.data_takehome.int__practices
[0m00:17:13.750615 [info ] [Thread-6 (]: 5 of 7 START sql table model main.int__patients ................................ [RUN]
[0m00:17:13.750868 [info ] [Thread-7 (]: 6 of 7 START sql table model main.int__practices ............................... [RUN]
[0m00:17:13.751120 [debug] [Thread-6 (]: Acquiring new duckdb connection 'model.data_takehome.int__patients'
[0m00:17:13.751340 [debug] [Thread-7 (]: Acquiring new duckdb connection 'model.data_takehome.int__practices'
[0m00:17:13.751504 [debug] [Thread-6 (]: Began compiling node model.data_takehome.int__patients
[0m00:17:13.751656 [debug] [Thread-7 (]: Began compiling node model.data_takehome.int__practices
[0m00:17:13.753394 [debug] [Thread-6 (]: Writing injected SQL for node "model.data_takehome.int__patients"
[0m00:17:13.754651 [debug] [Thread-7 (]: Writing injected SQL for node "model.data_takehome.int__practices"
[0m00:17:13.755256 [debug] [Thread-7 (]: Began executing node model.data_takehome.int__practices
[0m00:17:13.755418 [debug] [Thread-6 (]: Began executing node model.data_takehome.int__patients
[0m00:17:13.765598 [debug] [Thread-7 (]: Writing runtime sql for node "model.data_takehome.int__practices"
[0m00:17:13.767103 [debug] [Thread-6 (]: Writing runtime sql for node "model.data_takehome.int__patients"
[0m00:17:13.767640 [debug] [Thread-7 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m00:17:13.767823 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m00:17:13.767981 [debug] [Thread-7 (]: On model.data_takehome.int__practices: BEGIN
[0m00:17:13.768130 [debug] [Thread-6 (]: On model.data_takehome.int__patients: BEGIN
[0m00:17:13.768274 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m00:17:13.768412 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m00:17:13.771078 [debug] [Thread-7 (]: SQL status: OK in 0.003 seconds
[0m00:17:13.771270 [debug] [Thread-7 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m00:17:13.771447 [debug] [Thread-7 (]: On model.data_takehome.int__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__practices"} */

  
    
    

    create  table
      "data_takehome"."main"."int__practices__dbt_tmp"
  
    as (
      with pcns as (
select *
FROM "data_takehome"."main"."stg__pcns"
)

, practices as (
select *
FROM "data_takehome"."main"."stg__practices"
)


select
     practices.id
   , practices.practice_name
   , practices.location
   , practices.established_date
   , practices.pcn
   , pcn_name
  from practices
  left join pcns
  on pcns.id = practices.pcn
    );
  
  
[0m00:17:13.771613 [debug] [Thread-6 (]: SQL status: OK in 0.003 seconds
[0m00:17:13.771770 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m00:17:13.771955 [debug] [Thread-6 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */

  
    
    

    create  table
      "data_takehome"."main"."int__patients__dbt_tmp"
  
    as (
      WITH patients AS (
  SELECT 
    json_extract_string(data, '$.patient_id') AS patient_id,
    json_extract_string(data, '$.practice_id') AS practice_id,
    json_extract_string(data, '$.age') AS age,
    json_extract_string(data, '$.gender') AS gender,
    json_extract_string(data, '$.registration_date') AS registration_date,
    json_extract_string(data, '$.conditions') AS conditions,
    json_extract_string(data, '$.contact.email') AS email,
    json_extract_string(data, '$.contact.phone') AS phone
  FROM "data_takehome"."main"."stg__patients"
)

, clean_patients as (
-- remove square brackets from conditions column and clean phone number
SELECT 
  patient_id,
  practice_id,
  age,
  gender,
  registration_date,
  replace(CASE
    WHEN conditions LIKE '[%' AND conditions LIKE '%]'
    THEN substr(conditions, 2, length(conditions)-2)
    ELSE conditions
  END, '"', '') as conditions,
  email,
      regexp_replace(
        -- Step 2: Handle leading 1 or 001
        CASE
            WHEN regexp_matches(regexp_replace(phone, '[^0-9]', '', 'g'), '^(1|001)')
            THEN regexp_replace(regexp_replace(phone, '[^0-9]', '', 'g'), '^(1|001)', '')
            -- Step 3: Preserve numbers before letters, remove after
            ELSE regexp_replace(
                regexp_replace(phone, '([0-9]+)[a-zA-Z].*', '\1'),
                '[^0-9]', '', 'g'
            )
        END,
        -- Final cleanup in case any special chars remain
        '[^0-9]', '', 'g'
    ) AS phone
FROM patients)

select
     patient_id
   , practice_id
   , age
   , gender
   , registration_date
   , conditions
   , email
   , phone
from (
select *
 , dense_rank() over (partition by patient_id order by registration_date desc) as rank
from clean_patients) as a
where rank = 1
    );
  
  
[0m00:17:13.774987 [debug] [Thread-7 (]: SQL status: OK in 0.003 seconds
[0m00:17:13.777008 [debug] [Thread-7 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m00:17:13.777262 [debug] [Thread-7 (]: On model.data_takehome.int__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__practices"} */
alter table "data_takehome"."main"."int__practices" rename to "int__practices__dbt_backup"
[0m00:17:13.777501 [debug] [Thread-6 (]: SQL status: OK in 0.005 seconds
[0m00:17:13.779102 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m00:17:13.779280 [debug] [Thread-6 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */
alter table "data_takehome"."main"."int__patients" rename to "int__patients__dbt_backup"
[0m00:17:13.779468 [debug] [Thread-7 (]: SQL status: OK in 0.002 seconds
[0m00:17:13.780862 [debug] [Thread-7 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m00:17:13.781029 [debug] [Thread-7 (]: On model.data_takehome.int__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__practices"} */
alter table "data_takehome"."main"."int__practices__dbt_tmp" rename to "int__practices"
[0m00:17:13.781191 [debug] [Thread-6 (]: SQL status: OK in 0.002 seconds
[0m00:17:13.782471 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m00:17:13.782627 [debug] [Thread-6 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */
alter table "data_takehome"."main"."int__patients__dbt_tmp" rename to "int__patients"
[0m00:17:13.782782 [debug] [Thread-7 (]: SQL status: OK in 0.002 seconds
[0m00:17:13.785247 [debug] [Thread-7 (]: On model.data_takehome.int__practices: COMMIT
[0m00:17:13.785420 [debug] [Thread-7 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m00:17:13.785574 [debug] [Thread-7 (]: On model.data_takehome.int__practices: COMMIT
[0m00:17:13.785720 [debug] [Thread-6 (]: SQL status: OK in 0.003 seconds
[0m00:17:13.786600 [debug] [Thread-6 (]: On model.data_takehome.int__patients: COMMIT
[0m00:17:13.786747 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m00:17:13.786882 [debug] [Thread-6 (]: On model.data_takehome.int__patients: COMMIT
[0m00:17:13.787019 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m00:17:13.788049 [debug] [Thread-7 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m00:17:13.788260 [debug] [Thread-7 (]: On model.data_takehome.int__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__practices"} */
drop table if exists "data_takehome"."main"."int__practices__dbt_backup" cascade
[0m00:17:13.788419 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m00:17:13.789365 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m00:17:13.789520 [debug] [Thread-6 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */
drop table if exists "data_takehome"."main"."int__patients__dbt_backup" cascade
[0m00:17:13.789721 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m00:17:13.790333 [debug] [Thread-7 (]: On model.data_takehome.int__practices: Close
[0m00:17:13.790563 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3e2bd60-bbc1-4cdf-be9c-8df929fd5888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074c5a30>]}
[0m00:17:13.790833 [info ] [Thread-7 (]: 6 of 7 OK created sql table model main.int__practices .......................... [[32mOK[0m in 0.04s]
[0m00:17:13.791088 [debug] [Thread-7 (]: Finished running node model.data_takehome.int__practices
[0m00:17:13.791241 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m00:17:13.791878 [debug] [Thread-6 (]: On model.data_takehome.int__patients: Close
[0m00:17:13.797268 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3e2bd60-bbc1-4cdf-be9c-8df929fd5888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072f8800>]}
[0m00:17:13.797690 [info ] [Thread-6 (]: 5 of 7 OK created sql table model main.int__patients ........................... [[32mOK[0m in 0.05s]
[0m00:17:13.798022 [debug] [Thread-6 (]: Finished running node model.data_takehome.int__patients
[0m00:17:13.798469 [debug] [Thread-9 (]: Began running node model.data_takehome.patient_metadata
[0m00:17:13.798733 [info ] [Thread-9 (]: 7 of 7 START sql table model main.patient_metadata ............................. [RUN]
[0m00:17:13.798995 [debug] [Thread-9 (]: Acquiring new duckdb connection 'model.data_takehome.patient_metadata'
[0m00:17:13.799155 [debug] [Thread-9 (]: Began compiling node model.data_takehome.patient_metadata
[0m00:17:13.800593 [debug] [Thread-9 (]: Writing injected SQL for node "model.data_takehome.patient_metadata"
[0m00:17:13.801134 [debug] [Thread-9 (]: Began executing node model.data_takehome.patient_metadata
[0m00:17:13.802711 [debug] [Thread-9 (]: Writing runtime sql for node "model.data_takehome.patient_metadata"
[0m00:17:13.803180 [debug] [Thread-9 (]: Using duckdb connection "model.data_takehome.patient_metadata"
[0m00:17:13.803338 [debug] [Thread-9 (]: On model.data_takehome.patient_metadata: BEGIN
[0m00:17:13.803480 [debug] [Thread-9 (]: Opening a new connection, currently in state init
[0m00:17:13.806173 [debug] [Thread-9 (]: SQL status: OK in 0.003 seconds
[0m00:17:13.806360 [debug] [Thread-9 (]: Using duckdb connection "model.data_takehome.patient_metadata"
[0m00:17:13.806528 [debug] [Thread-9 (]: On model.data_takehome.patient_metadata: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patient_metadata"} */

  
    
    

    create  table
      "data_takehome"."main"."patient_metadata__dbt_tmp"
  
    as (
      with patients as (
select *
 FROM "data_takehome"."main"."int__patients"
)

, practices as (
select *
 FROM "data_takehome"."main"."int__practices"
)

select
      patient_id
    , practice_id
    , practices.practice_name
    , practices.location
    , pcn_name
    , age
    , gender
    , registration_date
    , conditions
FROM patients
LEFT JOIN practices
ON patients.practice_id = practices.id
    );
  
  
[0m00:17:13.810180 [debug] [Thread-9 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patient_metadata"} */

  
    
    

    create  table
      "data_takehome"."main"."patient_metadata__dbt_tmp"
  
    as (
      with patients as (
select *
 FROM "data_takehome"."main"."int__patients"
)

, practices as (
select *
 FROM "data_takehome"."main"."int__practices"
)

select
      patient_id
    , practice_id
    , practices.practice_name
    , practices.location
    , pcn_name
    , age
    , gender
    , registration_date
    , conditions
FROM patients
LEFT JOIN practices
ON patients.practice_id = practices.id
    );
  
  
[0m00:17:13.810359 [debug] [Thread-9 (]: DuckDB adapter: Rolling back transaction.
[0m00:17:13.810560 [debug] [Thread-9 (]: On model.data_takehome.patient_metadata: ROLLBACK
[0m00:17:13.815382 [debug] [Thread-9 (]: Failed to rollback 'model.data_takehome.patient_metadata'
[0m00:17:13.815554 [debug] [Thread-9 (]: On model.data_takehome.patient_metadata: Close
[0m00:17:13.817103 [debug] [Thread-9 (]: Runtime Error in model patient_metadata (models/mart/patient_metadata.sql)
  Conversion Error: Could not convert string 'invalid' to INT32
[0m00:17:13.817309 [debug] [Thread-9 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3e2bd60-bbc1-4cdf-be9c-8df929fd5888', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e1e960>]}
[0m00:17:13.817599 [error] [Thread-9 (]: 7 of 7 ERROR creating sql table model main.patient_metadata .................... [[31mERROR[0m in 0.02s]
[0m00:17:13.817856 [debug] [Thread-9 (]: Finished running node model.data_takehome.patient_metadata
[0m00:17:13.818747 [debug] [MainThread]: Using duckdb connection "master"
[0m00:17:13.818896 [debug] [MainThread]: On master: BEGIN
[0m00:17:13.819016 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:17:13.821634 [debug] [MainThread]: SQL status: OK in 0.003 seconds
[0m00:17:13.821864 [debug] [MainThread]: On master: COMMIT
[0m00:17:13.822002 [debug] [MainThread]: Using duckdb connection "master"
[0m00:17:13.822132 [debug] [MainThread]: On master: COMMIT
[0m00:17:13.822281 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:17:13.822412 [debug] [MainThread]: On master: Close
[0m00:17:13.823057 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:17:13.823230 [debug] [MainThread]: Connection 'model.data_takehome.stg__activities' was properly closed.
[0m00:17:13.823349 [debug] [MainThread]: Connection 'model.data_takehome.stg__patients' was properly closed.
[0m00:17:13.823459 [debug] [MainThread]: Connection 'model.data_takehome.stg__pcns' was properly closed.
[0m00:17:13.823562 [debug] [MainThread]: Connection 'model.data_takehome.stg__practices' was properly closed.
[0m00:17:13.823665 [debug] [MainThread]: Connection 'model.data_takehome.int__patients' was properly closed.
[0m00:17:13.823767 [debug] [MainThread]: Connection 'model.data_takehome.int__practices' was properly closed.
[0m00:17:13.823861 [debug] [MainThread]: Connection 'model.data_takehome.patient_metadata' was properly closed.
[0m00:17:13.824040 [info ] [MainThread]: 
[0m00:17:13.824191 [info ] [MainThread]: Finished running 4 view models, 3 table models in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m00:17:13.824803 [debug] [MainThread]: Command end result
[0m00:17:13.838774 [info ] [MainThread]: 
[0m00:17:13.839000 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m00:17:13.839136 [info ] [MainThread]: 
[0m00:17:13.839306 [error] [MainThread]:   Runtime Error in model patient_metadata (models/mart/patient_metadata.sql)
  Conversion Error: Could not convert string 'invalid' to INT32
[0m00:17:13.839440 [info ] [MainThread]: 
[0m00:17:13.839581 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m00:17:13.841463 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6447096, "process_user_time": 1.021391, "process_kernel_time": 0.199962, "process_mem_max_rss": "153632768", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:17:13.841704 [debug] [MainThread]: Command `dbt run` failed at 00:17:13.841665 after 0.65 seconds
[0m00:17:13.841885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba9970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f72c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f730e0>]}
[0m00:17:13.842040 [debug] [MainThread]: Flushing usage events
[0m00:30:09.945862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b98920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bc48f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e793d0>]}


============================== 00:30:09.955381 | 722253a1-646b-4290-ae10-6a049d8095d9 ==============================
[0m00:30:09.955381 [info ] [MainThread]: Running with dbt=1.8.1
[0m00:30:09.955716 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'version_check': 'True', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:30:10.106155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '722253a1-646b-4290-ae10-6a049d8095d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e796d0>]}
[0m00:30:10.148749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '722253a1-646b-4290-ae10-6a049d8095d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e57380>]}
[0m00:30:10.149556 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m00:30:10.205651 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m00:30:10.263379 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:30:10.263701 [debug] [MainThread]: Partial parsing: updated file: data_takehome://models/intermediate/int__patients.sql
[0m00:30:10.359896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '722253a1-646b-4290-ae10-6a049d8095d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108420f50>]}
[0m00:30:10.401725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '722253a1-646b-4290-ae10-6a049d8095d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108175580>]}
[0m00:30:10.402005 [info ] [MainThread]: Found 4 seeds, 7 models, 421 macros
[0m00:30:10.402170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '722253a1-646b-4290-ae10-6a049d8095d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108059100>]}
[0m00:30:10.402999 [info ] [MainThread]: 
[0m00:30:10.403282 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:30:10.405569 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_data_takehome'
[0m00:30:10.448122 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome"
[0m00:30:10.448353 [debug] [ThreadPool]: On list_data_takehome: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m00:30:10.448499 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:30:10.455681 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m00:30:10.455889 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m00:30:10.456267 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:30:10.456398 [debug] [MainThread]: Connection 'list_data_takehome' was properly closed.
[0m00:30:10.456539 [info ] [MainThread]: 
[0m00:30:10.456685 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.05 seconds (0.05s).
[0m00:30:10.456912 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/qamr/Documents/Development/suvera/data-dbt-takehome/data_takehome.duckdb": Conflicting lock is held in /Applications/DBeaver.app/Contents/MacOS/dbeaver (PID 4092) by user qamr. See also https://duckdb.org/docs/connect/concurrency
[0m00:30:10.458794 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.54734915, "process_user_time": 0.895731, "process_kernel_time": 0.191662, "process_mem_max_rss": "124010496", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:30:10.459048 [debug] [MainThread]: Command `dbt run` failed at 00:30:10.458998 after 0.55 seconds
[0m00:30:10.459213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e3cc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083eac60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108318fb0>]}
[0m00:30:10.459377 [debug] [MainThread]: Flushing usage events
[0m00:30:26.104630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104696d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106155910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106155460>]}


============================== 00:30:26.107621 | 37f792ae-09a5-427d-917d-06745b0d09d3 ==============================
[0m00:30:26.107621 [info ] [MainThread]: Running with dbt=1.8.1
[0m00:30:26.107935 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'version_check': 'True', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:30:26.199893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37f792ae-09a5-427d-917d-06745b0d09d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106419f70>]}
[0m00:30:26.241901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37f792ae-09a5-427d-917d-06745b0d09d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106445130>]}
[0m00:30:26.243388 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m00:30:26.295198 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m00:30:26.347897 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:30:26.348137 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:30:26.363910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37f792ae-09a5-427d-917d-06745b0d09d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10646b7a0>]}
[0m00:30:26.403992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37f792ae-09a5-427d-917d-06745b0d09d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106633c20>]}
[0m00:30:26.404273 [info ] [MainThread]: Found 4 seeds, 7 models, 421 macros
[0m00:30:26.404445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37f792ae-09a5-427d-917d-06745b0d09d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106893230>]}
[0m00:30:26.405287 [info ] [MainThread]: 
[0m00:30:26.405576 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:30:26.407848 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_data_takehome'
[0m00:30:26.438754 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome"
[0m00:30:26.438985 [debug] [ThreadPool]: On list_data_takehome: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m00:30:26.439137 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:30:26.454465 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m00:30:26.455398 [debug] [ThreadPool]: On list_data_takehome: Close
[0m00:30:26.456372 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data_takehome, now create_data_takehome_main)
[0m00:30:26.456592 [debug] [ThreadPool]: Creating schema "database: "data_takehome"
schema: "main"
"
[0m00:30:26.459913 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m00:30:26.460090 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
        select type from duckdb_databases()
        where database_name='data_takehome'
        and type='sqlite'
    
  
[0m00:30:26.460226 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:30:26.463088 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m00:30:26.463703 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m00:30:26.463832 [debug] [ThreadPool]: On create_data_takehome_main: BEGIN
[0m00:30:26.463983 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:30:26.464097 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m00:30:26.464214 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
    
        create schema if not exists "data_takehome"."main"
    
[0m00:30:26.464795 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:30:26.465184 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m00:30:26.465307 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m00:30:26.465415 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m00:30:26.465555 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:30:26.465676 [debug] [ThreadPool]: On create_data_takehome_main: Close
[0m00:30:26.466789 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_data_takehome_main, now list_data_takehome_main)
[0m00:30:26.469346 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m00:30:26.469487 [debug] [ThreadPool]: On list_data_takehome_main: BEGIN
[0m00:30:26.469599 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:30:26.471871 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m00:30:26.472033 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m00:30:26.472172 [debug] [ThreadPool]: On list_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome_main"} */
select
      'data_takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'data_takehome'
  
[0m00:30:26.484877 [debug] [ThreadPool]: SQL status: OK in 0.013 seconds
[0m00:30:26.488067 [debug] [ThreadPool]: On list_data_takehome_main: ROLLBACK
[0m00:30:26.489186 [debug] [ThreadPool]: Failed to rollback 'list_data_takehome_main'
[0m00:30:26.489329 [debug] [ThreadPool]: On list_data_takehome_main: Close
[0m00:30:26.490906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37f792ae-09a5-427d-917d-06745b0d09d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ffffb0>]}
[0m00:30:26.491121 [debug] [MainThread]: Using duckdb connection "master"
[0m00:30:26.491252 [debug] [MainThread]: On master: BEGIN
[0m00:30:26.491366 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:30:26.493628 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m00:30:26.493789 [debug] [MainThread]: On master: COMMIT
[0m00:30:26.493919 [debug] [MainThread]: Using duckdb connection "master"
[0m00:30:26.494037 [debug] [MainThread]: On master: COMMIT
[0m00:30:26.494170 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:30:26.494291 [debug] [MainThread]: On master: Close
[0m00:30:26.494746 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m00:30:26.494947 [info ] [MainThread]: 
[0m00:30:26.496974 [debug] [Thread-1 (]: Began running node model.data_takehome.stg__activities
[0m00:30:26.497166 [debug] [Thread-2 (]: Began running node model.data_takehome.stg__patients
[0m00:30:26.497339 [debug] [Thread-3 (]: Began running node model.data_takehome.stg__pcns
[0m00:30:26.497693 [debug] [Thread-4 (]: Began running node model.data_takehome.stg__practices
[0m00:30:26.497562 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg__activities ............................... [RUN]
[0m00:30:26.497943 [info ] [Thread-2 (]: 2 of 7 START sql view model main.stg__patients ................................. [RUN]
[0m00:30:26.498166 [info ] [Thread-3 (]: 3 of 7 START sql view model main.stg__pcns ..................................... [RUN]
[0m00:30:26.498435 [info ] [Thread-4 (]: 4 of 7 START sql view model main.stg__practices ................................ [RUN]
[0m00:30:26.498695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_takehome_main, now model.data_takehome.stg__activities)
[0m00:30:26.498921 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.data_takehome.stg__patients'
[0m00:30:26.499118 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.data_takehome.stg__pcns'
[0m00:30:26.499306 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.data_takehome.stg__practices'
[0m00:30:26.499462 [debug] [Thread-1 (]: Began compiling node model.data_takehome.stg__activities
[0m00:30:26.499605 [debug] [Thread-2 (]: Began compiling node model.data_takehome.stg__patients
[0m00:30:26.499744 [debug] [Thread-3 (]: Began compiling node model.data_takehome.stg__pcns
[0m00:30:26.499880 [debug] [Thread-4 (]: Began compiling node model.data_takehome.stg__practices
[0m00:30:26.503362 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_takehome.stg__activities"
[0m00:30:26.505549 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_takehome.stg__patients"
[0m00:30:26.506939 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_takehome.stg__pcns"
[0m00:30:26.508098 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_takehome.stg__practices"
[0m00:30:26.508990 [debug] [Thread-4 (]: Began executing node model.data_takehome.stg__practices
[0m00:30:26.524072 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_takehome.stg__practices"
[0m00:30:26.524381 [debug] [Thread-3 (]: Began executing node model.data_takehome.stg__pcns
[0m00:30:26.526058 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_takehome.stg__pcns"
[0m00:30:26.526370 [debug] [Thread-2 (]: Began executing node model.data_takehome.stg__patients
[0m00:30:26.526565 [debug] [Thread-1 (]: Began executing node model.data_takehome.stg__activities
[0m00:30:26.528054 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_takehome.stg__patients"
[0m00:30:26.529479 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_takehome.stg__activities"
[0m00:30:26.529733 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m00:30:26.529901 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m00:30:26.530101 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: BEGIN
[0m00:30:26.530279 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m00:30:26.530444 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: BEGIN
[0m00:30:26.530600 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m00:30:26.530782 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m00:30:26.530921 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: BEGIN
[0m00:30:26.531061 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m00:30:26.533573 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m00:30:26.533772 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: BEGIN
[0m00:30:26.533925 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m00:30:26.534112 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m00:30:26.534268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:30:26.534419 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m00:30:26.534593 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */

  
  create view "data_takehome"."main"."stg__practices__dbt_tmp" as (
    with practices as (
select * from "data_takehome"."main"."raw_practices" )

select * from practices
  );

[0m00:30:26.534761 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m00:30:26.534952 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m00:30:26.535114 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:30:26.535274 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m00:30:26.535434 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */

  
  create view "data_takehome"."main"."stg__pcns__dbt_tmp" as (
    with pcns as (
select * from "data_takehome"."main"."raw_pcns" )

select * from pcns
  );

[0m00:30:26.535593 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m00:30:26.535756 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */

  
  create view "data_takehome"."main"."stg__patients__dbt_tmp" as (
    with patients as (
select * from "data_takehome"."main"."raw_patients" )

select * from patients
  );

[0m00:30:26.535907 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m00:30:26.536105 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */

  
  create view "data_takehome"."main"."stg__activities__dbt_tmp" as (
    with activities as (
select * from "data_takehome"."main"."raw_activities" )

select * from activities
  );

[0m00:30:26.539655 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m00:30:26.540001 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */
alter view "data_takehome"."main"."stg__practices" rename to "stg__practices__dbt_backup"
[0m00:30:26.540203 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m00:30:26.540398 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:30:26.542144 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m00:30:26.542338 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m00:30:26.542527 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m00:30:26.544720 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m00:30:26.544946 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */
alter view "data_takehome"."main"."stg__pcns" rename to "stg__pcns__dbt_backup"
[0m00:30:26.546617 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m00:30:26.548219 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m00:30:26.548432 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */
alter view "data_takehome"."main"."stg__activities" rename to "stg__activities__dbt_backup"
[0m00:30:26.548661 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */
alter view "data_takehome"."main"."stg__patients" rename to "stg__patients__dbt_backup"
[0m00:30:26.548837 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */
alter view "data_takehome"."main"."stg__practices__dbt_tmp" rename to "stg__practices"
[0m00:30:26.549014 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m00:30:26.550460 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m00:30:26.550627 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */
alter view "data_takehome"."main"."stg__pcns__dbt_tmp" rename to "stg__pcns"
[0m00:30:26.550798 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m00:30:26.557283 [debug] [Thread-1 (]: SQL status: OK in 0.008 seconds
[0m00:30:26.558686 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m00:30:26.558862 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */
alter view "data_takehome"."main"."stg__activities__dbt_tmp" rename to "stg__activities"
[0m00:30:26.560565 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: COMMIT
[0m00:30:26.560752 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m00:30:26.560904 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: COMMIT
[0m00:30:26.561097 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m00:30:26.562398 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m00:30:26.562565 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */
alter view "data_takehome"."main"."stg__patients__dbt_tmp" rename to "stg__patients"
[0m00:30:26.562727 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m00:30:26.562891 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m00:30:26.563041 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:30:26.563765 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: COMMIT
[0m00:30:26.566085 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m00:30:26.566256 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m00:30:26.566973 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: COMMIT
[0m00:30:26.567138 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m00:30:26.567306 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */
drop view if exists "data_takehome"."main"."stg__practices__dbt_backup" cascade
[0m00:30:26.568054 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: COMMIT
[0m00:30:26.568217 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m00:30:26.568373 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: COMMIT
[0m00:30:26.568549 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m00:30:26.568699 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: COMMIT
[0m00:30:26.568873 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: COMMIT
[0m00:30:26.569027 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m00:30:26.569175 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m00:30:26.570360 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: Close
[0m00:30:26.570525 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m00:30:26.571587 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m00:30:26.571728 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:30:26.572402 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37f792ae-09a5-427d-917d-06745b0d09d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106447e90>]}
[0m00:30:26.573442 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m00:30:26.573606 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */
drop view if exists "data_takehome"."main"."stg__pcns__dbt_backup" cascade
[0m00:30:26.574615 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m00:30:26.574892 [info ] [Thread-4 (]: 4 of 7 OK created sql view model main.stg__practices ........................... [[32mOK[0m in 0.07s]
[0m00:30:26.575078 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */
drop view if exists "data_takehome"."main"."stg__patients__dbt_backup" cascade
[0m00:30:26.575267 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */
drop view if exists "data_takehome"."main"."stg__activities__dbt_backup" cascade
[0m00:30:26.575526 [debug] [Thread-4 (]: Finished running node model.data_takehome.stg__practices
[0m00:30:26.575790 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m00:30:26.576414 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: Close
[0m00:30:26.576618 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37f792ae-09a5-427d-917d-06745b0d09d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ce9ca0>]}
[0m00:30:26.577002 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:30:26.576870 [info ] [Thread-3 (]: 3 of 7 OK created sql view model main.stg__pcns ................................ [[32mOK[0m in 0.08s]
[0m00:30:26.577194 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m00:30:26.577741 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: Close
[0m00:30:26.577962 [debug] [Thread-3 (]: Finished running node model.data_takehome.stg__pcns
[0m00:30:26.578547 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: Close
[0m00:30:26.578743 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37f792ae-09a5-427d-917d-06745b0d09d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e24b00>]}
[0m00:30:26.582224 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37f792ae-09a5-427d-917d-06745b0d09d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cc8fe0>]}
[0m00:30:26.582406 [debug] [Thread-6 (]: Began running node model.data_takehome.int__practices
[0m00:30:26.582684 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.stg__activities .......................... [[32mOK[0m in 0.08s]
[0m00:30:26.582912 [info ] [Thread-2 (]: 2 of 7 OK created sql view model main.stg__patients ............................ [[32mOK[0m in 0.08s]
[0m00:30:26.583132 [info ] [Thread-6 (]: 5 of 7 START sql table model main.int__practices ............................... [RUN]
[0m00:30:26.583431 [debug] [Thread-1 (]: Finished running node model.data_takehome.stg__activities
[0m00:30:26.583653 [debug] [Thread-2 (]: Finished running node model.data_takehome.stg__patients
[0m00:30:26.583876 [debug] [Thread-6 (]: Acquiring new duckdb connection 'model.data_takehome.int__practices'
[0m00:30:26.584117 [debug] [Thread-6 (]: Began compiling node model.data_takehome.int__practices
[0m00:30:26.585559 [debug] [Thread-6 (]: Writing injected SQL for node "model.data_takehome.int__practices"
[0m00:30:26.585765 [debug] [Thread-8 (]: Began running node model.data_takehome.int__patients
[0m00:30:26.585962 [info ] [Thread-8 (]: 6 of 7 START sql table model main.int__patients ................................ [RUN]
[0m00:30:26.586188 [debug] [Thread-8 (]: Acquiring new duckdb connection 'model.data_takehome.int__patients'
[0m00:30:26.586338 [debug] [Thread-8 (]: Began compiling node model.data_takehome.int__patients
[0m00:30:26.587715 [debug] [Thread-8 (]: Writing injected SQL for node "model.data_takehome.int__patients"
[0m00:30:26.587927 [debug] [Thread-6 (]: Began executing node model.data_takehome.int__practices
[0m00:30:26.598022 [debug] [Thread-6 (]: Writing runtime sql for node "model.data_takehome.int__practices"
[0m00:30:26.598306 [debug] [Thread-8 (]: Began executing node model.data_takehome.int__patients
[0m00:30:26.599739 [debug] [Thread-8 (]: Writing runtime sql for node "model.data_takehome.int__patients"
[0m00:30:26.600022 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m00:30:26.600190 [debug] [Thread-6 (]: On model.data_takehome.int__practices: BEGIN
[0m00:30:26.600349 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m00:30:26.603273 [debug] [Thread-8 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m00:30:26.603479 [debug] [Thread-8 (]: On model.data_takehome.int__patients: BEGIN
[0m00:30:26.603654 [debug] [Thread-6 (]: SQL status: OK in 0.003 seconds
[0m00:30:26.603821 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m00:30:26.603976 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m00:30:26.604181 [debug] [Thread-6 (]: On model.data_takehome.int__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__practices"} */

  
    
    

    create  table
      "data_takehome"."main"."int__practices__dbt_tmp"
  
    as (
      with pcns as (
select *
FROM "data_takehome"."main"."stg__pcns"
)

, practices as (
select *
FROM "data_takehome"."main"."stg__practices"
)


select
     practices.id
   , practices.practice_name
   , practices.location
   , practices.established_date
   , practices.pcn
   , pcn_name
  from practices
  left join pcns
  on pcns.id = practices.pcn
    );
  
  
[0m00:30:26.604349 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m00:30:26.604503 [debug] [Thread-8 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m00:30:26.604689 [debug] [Thread-8 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */

  
    
    

    create  table
      "data_takehome"."main"."int__patients__dbt_tmp"
  
    as (
      WITH patients AS (
  SELECT 
    json_extract_string(data, '$.patient_id') AS patient_id,
    json_extract_string(data, '$.practice_id') AS practice_id,
    json_extract_string(data, '$.age') AS age,
    json_extract_string(data, '$.gender') AS gender,
    json_extract_string(data, '$.registration_date') AS registration_date,
    json_extract_string(data, '$.conditions') AS conditions,
    json_extract_string(data, '$.contact.email') AS email,
    json_extract_string(data, '$.contact.phone') AS phone
  FROM "data_takehome"."main"."stg__patients"
)

, clean_patients as (
-- remove square brackets from conditions column and clean phone number
SELECT 
  patient_id,
  case when practice_id = 'invalid' then '999'
       when practice_id IS NULL then '0' ELSE practice_id END AS practice_id,
  age,
  gender,
  registration_date,
  replace(CASE
    WHEN conditions LIKE '[%' AND conditions LIKE '%]'
    THEN substr(conditions, 2, length(conditions)-2)
    ELSE conditions
  END, '"', '') as conditions,
  email,
      regexp_replace(
        -- Step 2: Handle leading 1 or 001
        CASE
            WHEN regexp_matches(regexp_replace(phone, '[^0-9]', '', 'g'), '^(1|001)')
            THEN regexp_replace(regexp_replace(phone, '[^0-9]', '', 'g'), '^(1|001)', '')
            -- Step 3: Preserve numbers before letters, remove after
            ELSE regexp_replace(
                regexp_replace(phone, '([0-9]+)[a-zA-Z].*', '\1'),
                '[^0-9]', '', 'g'
            )
        END,
        -- Final cleanup in case any special chars remain
        '[^0-9]', '', 'g'
    ) AS phone
FROM patients)

select
     patient_id
   , CAST(practice_id AS INT) AS practice_id
   , practice_id
   , age
   , gender
   , registration_date
   , conditions
   , email
   , phone
from (
select *
 , dense_rank() over (partition by patient_id order by registration_date desc) as rank
from clean_patients) as a
where rank = 1
    );
  
  
[0m00:30:26.607810 [debug] [Thread-6 (]: SQL status: OK in 0.003 seconds
[0m00:30:26.609391 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m00:30:26.609820 [debug] [Thread-6 (]: On model.data_takehome.int__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__practices"} */
alter table "data_takehome"."main"."int__practices" rename to "int__practices__dbt_backup"
[0m00:30:26.610226 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m00:30:26.611585 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m00:30:26.611740 [debug] [Thread-6 (]: On model.data_takehome.int__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__practices"} */
alter table "data_takehome"."main"."int__practices__dbt_tmp" rename to "int__practices"
[0m00:30:26.611927 [debug] [Thread-8 (]: SQL status: OK in 0.007 seconds
[0m00:30:26.613252 [debug] [Thread-8 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m00:30:26.613406 [debug] [Thread-8 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */
alter table "data_takehome"."main"."int__patients" rename to "int__patients__dbt_backup"
[0m00:30:26.613563 [debug] [Thread-6 (]: SQL status: OK in 0.002 seconds
[0m00:30:26.616013 [debug] [Thread-6 (]: On model.data_takehome.int__practices: COMMIT
[0m00:30:26.616186 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m00:30:26.616336 [debug] [Thread-6 (]: On model.data_takehome.int__practices: COMMIT
[0m00:30:26.616477 [debug] [Thread-8 (]: SQL status: OK in 0.003 seconds
[0m00:30:26.617791 [debug] [Thread-8 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m00:30:26.617947 [debug] [Thread-8 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */
alter table "data_takehome"."main"."int__patients__dbt_tmp" rename to "int__patients"
[0m00:30:26.618103 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m00:30:26.619113 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m00:30:26.619261 [debug] [Thread-6 (]: On model.data_takehome.int__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__practices"} */
drop table if exists "data_takehome"."main"."int__practices__dbt_backup" cascade
[0m00:30:26.619446 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m00:30:26.620205 [debug] [Thread-8 (]: On model.data_takehome.int__patients: COMMIT
[0m00:30:26.620353 [debug] [Thread-8 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m00:30:26.620489 [debug] [Thread-8 (]: On model.data_takehome.int__patients: COMMIT
[0m00:30:26.620632 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m00:30:26.621247 [debug] [Thread-6 (]: On model.data_takehome.int__practices: Close
[0m00:30:26.621403 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m00:30:26.621617 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37f792ae-09a5-427d-917d-06745b0d09d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e9d670>]}
[0m00:30:26.622607 [debug] [Thread-8 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m00:30:26.623018 [debug] [Thread-8 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */
drop table if exists "data_takehome"."main"."int__patients__dbt_backup" cascade
[0m00:30:26.622884 [info ] [Thread-6 (]: 5 of 7 OK created sql table model main.int__practices .......................... [[32mOK[0m in 0.04s]
[0m00:30:26.623352 [debug] [Thread-6 (]: Finished running node model.data_takehome.int__practices
[0m00:30:26.623625 [debug] [Thread-8 (]: SQL status: OK in 0.000 seconds
[0m00:30:26.624211 [debug] [Thread-8 (]: On model.data_takehome.int__patients: Close
[0m00:30:26.630632 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37f792ae-09a5-427d-917d-06745b0d09d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ef71a0>]}
[0m00:30:26.630976 [info ] [Thread-8 (]: 6 of 7 OK created sql table model main.int__patients ........................... [[32mOK[0m in 0.04s]
[0m00:30:26.631238 [debug] [Thread-8 (]: Finished running node model.data_takehome.int__patients
[0m00:30:26.631603 [debug] [Thread-10 ]: Began running node model.data_takehome.patient_metadata
[0m00:30:26.631879 [info ] [Thread-10 ]: 7 of 7 START sql table model main.patient_metadata ............................. [RUN]
[0m00:30:26.632140 [debug] [Thread-10 ]: Acquiring new duckdb connection 'model.data_takehome.patient_metadata'
[0m00:30:26.632295 [debug] [Thread-10 ]: Began compiling node model.data_takehome.patient_metadata
[0m00:30:26.633827 [debug] [Thread-10 ]: Writing injected SQL for node "model.data_takehome.patient_metadata"
[0m00:30:26.634369 [debug] [Thread-10 ]: Began executing node model.data_takehome.patient_metadata
[0m00:30:26.635843 [debug] [Thread-10 ]: Writing runtime sql for node "model.data_takehome.patient_metadata"
[0m00:30:26.636274 [debug] [Thread-10 ]: Using duckdb connection "model.data_takehome.patient_metadata"
[0m00:30:26.636436 [debug] [Thread-10 ]: On model.data_takehome.patient_metadata: BEGIN
[0m00:30:26.636571 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m00:30:26.639043 [debug] [Thread-10 ]: SQL status: OK in 0.002 seconds
[0m00:30:26.639231 [debug] [Thread-10 ]: Using duckdb connection "model.data_takehome.patient_metadata"
[0m00:30:26.639403 [debug] [Thread-10 ]: On model.data_takehome.patient_metadata: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patient_metadata"} */

  
    
    

    create  table
      "data_takehome"."main"."patient_metadata__dbt_tmp"
  
    as (
      with patients as (
select *
 FROM "data_takehome"."main"."int__patients"
)

, practices as (
select *
 FROM "data_takehome"."main"."int__practices"
)

select
      patient_id
    , practice_id
    , practices.practice_name
    , practices.location
    , pcn_name
    , age
    , gender
    , registration_date
    , conditions
FROM patients
LEFT JOIN practices
ON patients.practice_id = practices.id
    );
  
  
[0m00:30:26.640647 [debug] [Thread-10 ]: SQL status: OK in 0.001 seconds
[0m00:30:26.642378 [debug] [Thread-10 ]: Using duckdb connection "model.data_takehome.patient_metadata"
[0m00:30:26.642546 [debug] [Thread-10 ]: On model.data_takehome.patient_metadata: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patient_metadata"} */
alter table "data_takehome"."main"."patient_metadata" rename to "patient_metadata__dbt_backup"
[0m00:30:26.642773 [debug] [Thread-10 ]: SQL status: OK in 0.000 seconds
[0m00:30:26.644921 [debug] [Thread-10 ]: Using duckdb connection "model.data_takehome.patient_metadata"
[0m00:30:26.645080 [debug] [Thread-10 ]: On model.data_takehome.patient_metadata: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patient_metadata"} */
alter table "data_takehome"."main"."patient_metadata__dbt_tmp" rename to "patient_metadata"
[0m00:30:26.645281 [debug] [Thread-10 ]: SQL status: OK in 0.000 seconds
[0m00:30:26.646022 [debug] [Thread-10 ]: On model.data_takehome.patient_metadata: COMMIT
[0m00:30:26.646163 [debug] [Thread-10 ]: Using duckdb connection "model.data_takehome.patient_metadata"
[0m00:30:26.646292 [debug] [Thread-10 ]: On model.data_takehome.patient_metadata: COMMIT
[0m00:30:26.647022 [debug] [Thread-10 ]: SQL status: OK in 0.001 seconds
[0m00:30:26.648066 [debug] [Thread-10 ]: Using duckdb connection "model.data_takehome.patient_metadata"
[0m00:30:26.648226 [debug] [Thread-10 ]: On model.data_takehome.patient_metadata: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patient_metadata"} */
drop table if exists "data_takehome"."main"."patient_metadata__dbt_backup" cascade
[0m00:30:26.648504 [debug] [Thread-10 ]: SQL status: OK in 0.000 seconds
[0m00:30:26.649105 [debug] [Thread-10 ]: On model.data_takehome.patient_metadata: Close
[0m00:30:26.653552 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37f792ae-09a5-427d-917d-06745b0d09d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106efd5e0>]}
[0m00:30:26.653905 [info ] [Thread-10 ]: 7 of 7 OK created sql table model main.patient_metadata ........................ [[32mOK[0m in 0.02s]
[0m00:30:26.654171 [debug] [Thread-10 ]: Finished running node model.data_takehome.patient_metadata
[0m00:30:26.655013 [debug] [MainThread]: Using duckdb connection "master"
[0m00:30:26.655178 [debug] [MainThread]: On master: BEGIN
[0m00:30:26.655303 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:30:26.657785 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m00:30:26.657989 [debug] [MainThread]: On master: COMMIT
[0m00:30:26.658123 [debug] [MainThread]: Using duckdb connection "master"
[0m00:30:26.658242 [debug] [MainThread]: On master: COMMIT
[0m00:30:26.658378 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:30:26.658515 [debug] [MainThread]: On master: Close
[0m00:30:26.659117 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:30:26.659243 [debug] [MainThread]: Connection 'model.data_takehome.stg__activities' was properly closed.
[0m00:30:26.659348 [debug] [MainThread]: Connection 'model.data_takehome.stg__patients' was properly closed.
[0m00:30:26.659450 [debug] [MainThread]: Connection 'model.data_takehome.stg__pcns' was properly closed.
[0m00:30:26.659545 [debug] [MainThread]: Connection 'model.data_takehome.stg__practices' was properly closed.
[0m00:30:26.659645 [debug] [MainThread]: Connection 'model.data_takehome.int__practices' was properly closed.
[0m00:30:26.659740 [debug] [MainThread]: Connection 'model.data_takehome.int__patients' was properly closed.
[0m00:30:26.659837 [debug] [MainThread]: Connection 'model.data_takehome.patient_metadata' was properly closed.
[0m00:30:26.660011 [info ] [MainThread]: 
[0m00:30:26.660161 [info ] [MainThread]: Finished running 4 view models, 3 table models in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m00:30:26.660765 [debug] [MainThread]: Command end result
[0m00:30:26.673589 [info ] [MainThread]: 
[0m00:30:26.673810 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:30:26.673965 [info ] [MainThread]: 
[0m00:30:26.674120 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m00:30:26.675710 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6009748, "process_user_time": 1.031734, "process_kernel_time": 0.177018, "process_mem_max_rss": "161447936", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m00:30:26.675970 [debug] [MainThread]: Command `dbt run` succeeded at 00:30:26.675929 after 0.60 seconds
[0m00:30:26.676180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b9d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104696d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f18890>]}
[0m00:30:26.676344 [debug] [MainThread]: Flushing usage events
[0m09:49:13.318157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092834a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097458e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109745520>]}


============================== 09:49:13.321211 | eb1da785-fe42-474e-81b2-b7f487e99d61 ==============================
[0m09:49:13.321211 [info ] [MainThread]: Running with dbt=1.8.1
[0m09:49:13.321581 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:49:13.494556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb1da785-fe42-474e-81b2-b7f487e99d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a018f50>]}
[0m09:49:13.538836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb1da785-fe42-474e-81b2-b7f487e99d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0d1370>]}
[0m09:49:13.539602 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m09:49:13.599418 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m09:49:13.658077 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:49:13.658316 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:49:13.674456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb1da785-fe42-474e-81b2-b7f487e99d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109703680>]}
[0m09:49:13.720742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb1da785-fe42-474e-81b2-b7f487e99d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a12f7d0>]}
[0m09:49:13.721029 [info ] [MainThread]: Found 4 seeds, 7 models, 421 macros
[0m09:49:13.721193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb1da785-fe42-474e-81b2-b7f487e99d61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108efd8b0>]}
[0m09:49:13.722084 [info ] [MainThread]: 
[0m09:49:13.722362 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:49:13.724873 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_data_takehome'
[0m09:49:13.768228 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome"
[0m09:49:13.768466 [debug] [ThreadPool]: On list_data_takehome: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m09:49:13.768611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:49:13.775953 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m09:49:13.776172 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m09:49:13.776585 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:49:13.776760 [debug] [MainThread]: Connection 'list_data_takehome' was properly closed.
[0m09:49:13.776904 [info ] [MainThread]: 
[0m09:49:13.777061 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.05 seconds (0.05s).
[0m09:49:13.777280 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/Users/qamr/Documents/Development/suvera/data-dbt-takehome/data_takehome.duckdb": Conflicting lock is held in /Applications/DBeaver.app/Contents/MacOS/dbeaver (PID 1174) by user qamr. See also https://duckdb.org/docs/connect/concurrency
[0m09:49:13.782814 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5024717, "process_user_time": 0.835916, "process_kernel_time": 0.202799, "process_mem_max_rss": "121274368", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:49:13.783193 [debug] [MainThread]: Command `dbt run` failed at 09:49:13.783135 after 0.50 seconds
[0m09:49:13.783403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ec51f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109703500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3a2330>]}
[0m09:49:13.783594 [debug] [MainThread]: Flushing usage events
[0m09:52:55.584294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041c5df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063d5940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063d55b0>]}


============================== 09:52:55.590405 | 6bbbfd77-5fbb-4868-98ac-c408168dcaa9 ==============================
[0m09:52:55.590405 [info ] [MainThread]: Running with dbt=1.8.1
[0m09:52:55.590723 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m09:52:55.737723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6bbbfd77-5fbb-4868-98ac-c408168dcaa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10611cfb0>]}
[0m09:52:55.780513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6bbbfd77-5fbb-4868-98ac-c408168dcaa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f9c6b0>]}
[0m09:52:55.781210 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m09:52:55.835176 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m09:52:55.893815 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:52:55.894038 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:52:55.910123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6bbbfd77-5fbb-4868-98ac-c408168dcaa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ffd10>]}
[0m09:52:55.953211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6bbbfd77-5fbb-4868-98ac-c408168dcaa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065cb740>]}
[0m09:52:55.953479 [info ] [MainThread]: Found 4 seeds, 7 models, 421 macros
[0m09:52:55.953645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bbbfd77-5fbb-4868-98ac-c408168dcaa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106835760>]}
[0m09:52:55.954532 [info ] [MainThread]: 
[0m09:52:55.954846 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m09:52:55.957700 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_data_takehome'
[0m09:52:56.000767 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome"
[0m09:52:56.000990 [debug] [ThreadPool]: On list_data_takehome: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m09:52:56.001130 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:52:56.011699 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m09:52:56.012449 [debug] [ThreadPool]: On list_data_takehome: Close
[0m09:52:56.013434 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data_takehome, now create_data_takehome_main)
[0m09:52:56.013660 [debug] [ThreadPool]: Creating schema "database: "data_takehome"
schema: "main"
"
[0m09:52:56.016879 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m09:52:56.017040 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
        select type from duckdb_databases()
        where database_name='data_takehome'
        and type='sqlite'
    
  
[0m09:52:56.017168 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:52:56.019775 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m09:52:56.020421 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m09:52:56.020558 [debug] [ThreadPool]: On create_data_takehome_main: BEGIN
[0m09:52:56.020701 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:52:56.020821 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m09:52:56.020940 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
    
        create schema if not exists "data_takehome"."main"
    
[0m09:52:56.021163 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:52:56.021549 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m09:52:56.021673 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m09:52:56.021782 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m09:52:56.021916 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m09:52:56.022041 [debug] [ThreadPool]: On create_data_takehome_main: Close
[0m09:52:56.023147 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_data_takehome_main, now list_data_takehome_main)
[0m09:52:56.025635 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m09:52:56.025773 [debug] [ThreadPool]: On list_data_takehome_main: BEGIN
[0m09:52:56.025883 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:52:56.028035 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m09:52:56.028183 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m09:52:56.028310 [debug] [ThreadPool]: On list_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome_main"} */
select
      'data_takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'data_takehome'
  
[0m09:52:56.039265 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m09:52:56.041720 [debug] [ThreadPool]: On list_data_takehome_main: ROLLBACK
[0m09:52:56.042650 [debug] [ThreadPool]: Failed to rollback 'list_data_takehome_main'
[0m09:52:56.042781 [debug] [ThreadPool]: On list_data_takehome_main: Close
[0m09:52:56.044320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bbbfd77-5fbb-4868-98ac-c408168dcaa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a7f8f0>]}
[0m09:52:56.044564 [debug] [MainThread]: Using duckdb connection "master"
[0m09:52:56.044703 [debug] [MainThread]: On master: BEGIN
[0m09:52:56.044820 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:52:56.047086 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m09:52:56.047246 [debug] [MainThread]: On master: COMMIT
[0m09:52:56.047376 [debug] [MainThread]: Using duckdb connection "master"
[0m09:52:56.047493 [debug] [MainThread]: On master: COMMIT
[0m09:52:56.047627 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:52:56.047751 [debug] [MainThread]: On master: Close
[0m09:52:56.048220 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m09:52:56.048380 [info ] [MainThread]: 
[0m09:52:56.050428 [debug] [Thread-1 (]: Began running node model.data_takehome.stg__activities
[0m09:52:56.050626 [debug] [Thread-2 (]: Began running node model.data_takehome.stg__patients
[0m09:52:56.050998 [debug] [Thread-3 (]: Began running node model.data_takehome.stg__pcns
[0m09:52:56.051153 [debug] [Thread-4 (]: Began running node model.data_takehome.stg__practices
[0m09:52:56.050861 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg__activities ............................... [RUN]
[0m09:52:56.051423 [info ] [Thread-2 (]: 2 of 7 START sql view model main.stg__patients ................................. [RUN]
[0m09:52:56.051656 [info ] [Thread-3 (]: 3 of 7 START sql view model main.stg__pcns ..................................... [RUN]
[0m09:52:56.051913 [info ] [Thread-4 (]: 4 of 7 START sql view model main.stg__practices ................................ [RUN]
[0m09:52:56.052177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_takehome_main, now model.data_takehome.stg__activities)
[0m09:52:56.052390 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.data_takehome.stg__patients'
[0m09:52:56.052611 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.data_takehome.stg__pcns'
[0m09:52:56.052819 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.data_takehome.stg__practices'
[0m09:52:56.052988 [debug] [Thread-1 (]: Began compiling node model.data_takehome.stg__activities
[0m09:52:56.053146 [debug] [Thread-2 (]: Began compiling node model.data_takehome.stg__patients
[0m09:52:56.053293 [debug] [Thread-3 (]: Began compiling node model.data_takehome.stg__pcns
[0m09:52:56.053436 [debug] [Thread-4 (]: Began compiling node model.data_takehome.stg__practices
[0m09:52:56.057215 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_takehome.stg__activities"
[0m09:52:56.059480 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_takehome.stg__patients"
[0m09:52:56.060667 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_takehome.stg__pcns"
[0m09:52:56.061768 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_takehome.stg__practices"
[0m09:52:56.063197 [debug] [Thread-3 (]: Began executing node model.data_takehome.stg__pcns
[0m09:52:56.063373 [debug] [Thread-1 (]: Began executing node model.data_takehome.stg__activities
[0m09:52:56.063530 [debug] [Thread-2 (]: Began executing node model.data_takehome.stg__patients
[0m09:52:56.063665 [debug] [Thread-4 (]: Began executing node model.data_takehome.stg__practices
[0m09:52:56.080164 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_takehome.stg__activities"
[0m09:52:56.080558 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_takehome.stg__pcns"
[0m09:52:56.082085 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_takehome.stg__patients"
[0m09:52:56.083480 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_takehome.stg__practices"
[0m09:52:56.084473 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m09:52:56.084642 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: BEGIN
[0m09:52:56.084783 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:52:56.087261 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m09:52:56.087472 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m09:52:56.087667 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: BEGIN
[0m09:52:56.087876 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m09:52:56.088064 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m09:52:56.088225 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m09:52:56.088370 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:52:56.088527 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */

  
  create view "data_takehome"."main"."stg__pcns__dbt_tmp" as (
    with pcns as (
select * from "data_takehome"."main"."raw_pcns" )

select * from pcns
  );

[0m09:52:56.088685 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: BEGIN
[0m09:52:56.088832 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: BEGIN
[0m09:52:56.089025 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:52:56.089173 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:52:56.089320 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:52:56.089459 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m09:52:56.089603 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m09:52:56.089825 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:52:56.092823 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m09:52:56.092982 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m09:52:56.093146 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */

  
  create view "data_takehome"."main"."stg__activities__dbt_tmp" as (
    with activities as (
select * from "data_takehome"."main"."raw_activities" )

select * from activities
  );

[0m09:52:56.093304 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m09:52:56.093448 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */
alter view "data_takehome"."main"."stg__pcns" rename to "stg__pcns__dbt_backup"
[0m09:52:56.093590 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m09:52:56.093758 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */

  
  create view "data_takehome"."main"."stg__practices__dbt_tmp" as (
    with practices as (
select * from "data_takehome"."main"."raw_practices" )

select * from practices
  );

[0m09:52:56.093948 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */

  
  create view "data_takehome"."main"."stg__patients__dbt_tmp" as (
    with patients as (
select * from "data_takehome"."main"."raw_patients" )

select * from patients
  );

[0m09:52:56.094116 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:52:56.094267 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m09:52:56.095644 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m09:52:56.097528 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m09:52:56.097717 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m09:52:56.097872 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m09:52:56.098019 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */
alter view "data_takehome"."main"."stg__activities" rename to "stg__activities__dbt_backup"
[0m09:52:56.098174 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */
alter view "data_takehome"."main"."stg__pcns__dbt_tmp" rename to "stg__pcns"
[0m09:52:56.099493 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m09:52:56.100802 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m09:52:56.101017 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:52:56.101173 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */
alter view "data_takehome"."main"."stg__practices" rename to "stg__practices__dbt_backup"
[0m09:52:56.101334 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */
alter view "data_takehome"."main"."stg__patients" rename to "stg__patients__dbt_backup"
[0m09:52:56.101473 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m09:52:56.102681 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m09:52:56.102908 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m09:52:56.103039 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m09:52:56.109337 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */
alter view "data_takehome"."main"."stg__activities__dbt_tmp" rename to "stg__activities"
[0m09:52:56.110873 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: COMMIT
[0m09:52:56.112202 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m09:52:56.113445 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m09:52:56.113630 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m09:52:56.113783 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */
alter view "data_takehome"."main"."stg__patients__dbt_tmp" rename to "stg__patients"
[0m09:52:56.113967 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */
alter view "data_takehome"."main"."stg__practices__dbt_tmp" rename to "stg__practices"
[0m09:52:56.114115 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m09:52:56.114250 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: COMMIT
[0m09:52:56.114996 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: COMMIT
[0m09:52:56.115143 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m09:52:56.115306 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:52:56.115497 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m09:52:56.115651 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m09:52:56.116318 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: COMMIT
[0m09:52:56.117030 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: COMMIT
[0m09:52:56.117181 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: COMMIT
[0m09:52:56.119405 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m09:52:56.119579 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m09:52:56.119742 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m09:52:56.119923 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */
drop view if exists "data_takehome"."main"."stg__pcns__dbt_backup" cascade
[0m09:52:56.120078 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: COMMIT
[0m09:52:56.120218 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m09:52:56.120360 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: COMMIT
[0m09:52:56.121459 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m09:52:56.121648 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m09:52:56.121794 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m09:52:56.121954 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */
drop view if exists "data_takehome"."main"."stg__activities__dbt_backup" cascade
[0m09:52:56.122976 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m09:52:56.123112 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:52:56.124291 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: Close
[0m09:52:56.124499 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */
drop view if exists "data_takehome"."main"."stg__patients__dbt_backup" cascade
[0m09:52:56.125567 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m09:52:56.126251 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bbbfd77-5fbb-4868-98ac-c408168dcaa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d93530>]}
[0m09:52:56.126417 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m09:52:56.126587 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */
drop view if exists "data_takehome"."main"."stg__practices__dbt_backup" cascade
[0m09:52:56.126868 [info ] [Thread-3 (]: 3 of 7 OK created sql view model main.stg__pcns ................................ [[32mOK[0m in 0.07s]
[0m09:52:56.127052 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m09:52:56.127662 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: Close
[0m09:52:56.127945 [debug] [Thread-3 (]: Finished running node model.data_takehome.stg__pcns
[0m09:52:56.128583 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: Close
[0m09:52:56.128852 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bbbfd77-5fbb-4868-98ac-c408168dcaa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b96a50>]}
[0m09:52:56.129047 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m09:52:56.129331 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bbbfd77-5fbb-4868-98ac-c408168dcaa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c58f20>]}
[0m09:52:56.130238 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: Close
[0m09:52:56.129629 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.stg__activities .......................... [[32mOK[0m in 0.08s]
[0m09:52:56.130556 [info ] [Thread-2 (]: 2 of 7 OK created sql view model main.stg__patients ............................ [[32mOK[0m in 0.08s]
[0m09:52:56.133479 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bbbfd77-5fbb-4868-98ac-c408168dcaa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cc81a0>]}
[0m09:52:56.133836 [debug] [Thread-1 (]: Finished running node model.data_takehome.stg__activities
[0m09:52:56.134084 [debug] [Thread-2 (]: Finished running node model.data_takehome.stg__patients
[0m09:52:56.134380 [info ] [Thread-4 (]: 4 of 7 OK created sql view model main.stg__practices ........................... [[32mOK[0m in 0.08s]
[0m09:52:56.134736 [debug] [Thread-4 (]: Finished running node model.data_takehome.stg__practices
[0m09:52:56.134991 [debug] [Thread-6 (]: Began running node model.data_takehome.int__patients
[0m09:52:56.135307 [info ] [Thread-6 (]: 5 of 7 START sql table model main.int__patients ................................ [RUN]
[0m09:52:56.135530 [debug] [Thread-8 (]: Began running node model.data_takehome.int__practices
[0m09:52:56.135760 [debug] [Thread-6 (]: Acquiring new duckdb connection 'model.data_takehome.int__patients'
[0m09:52:56.135972 [info ] [Thread-8 (]: 6 of 7 START sql table model main.int__practices ............................... [RUN]
[0m09:52:56.136188 [debug] [Thread-6 (]: Began compiling node model.data_takehome.int__patients
[0m09:52:56.136401 [debug] [Thread-8 (]: Acquiring new duckdb connection 'model.data_takehome.int__practices'
[0m09:52:56.137937 [debug] [Thread-6 (]: Writing injected SQL for node "model.data_takehome.int__patients"
[0m09:52:56.138141 [debug] [Thread-8 (]: Began compiling node model.data_takehome.int__practices
[0m09:52:56.139730 [debug] [Thread-8 (]: Writing injected SQL for node "model.data_takehome.int__practices"
[0m09:52:56.140469 [debug] [Thread-6 (]: Began executing node model.data_takehome.int__patients
[0m09:52:56.146956 [debug] [Thread-8 (]: Began executing node model.data_takehome.int__practices
[0m09:52:56.151105 [debug] [Thread-6 (]: Writing runtime sql for node "model.data_takehome.int__patients"
[0m09:52:56.152720 [debug] [Thread-8 (]: Writing runtime sql for node "model.data_takehome.int__practices"
[0m09:52:56.153598 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m09:52:56.153793 [debug] [Thread-6 (]: On model.data_takehome.int__patients: BEGIN
[0m09:52:56.153973 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m09:52:56.156723 [debug] [Thread-8 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m09:52:56.156928 [debug] [Thread-6 (]: SQL status: OK in 0.003 seconds
[0m09:52:56.157096 [debug] [Thread-8 (]: On model.data_takehome.int__practices: BEGIN
[0m09:52:56.157254 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m09:52:56.157403 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m09:52:56.157599 [debug] [Thread-6 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */

  
    
    

    create  table
      "data_takehome"."main"."int__patients__dbt_tmp"
  
    as (
      WITH patients AS (
  SELECT 
    json_extract_string(data, '$.patient_id') AS patient_id,
    json_extract_string(data, '$.practice_id') AS practice_id,
    json_extract_string(data, '$.age') AS age,
    json_extract_string(data, '$.gender') AS gender,
    json_extract_string(data, '$.registration_date') AS registration_date,
    json_extract_string(data, '$.conditions') AS conditions,
    json_extract_string(data, '$.contact.email') AS email,
    json_extract_string(data, '$.contact.phone') AS phone
  FROM "data_takehome"."main"."stg__patients"
)

, clean_patients as (
-- remove square brackets from conditions column and clean phone number
SELECT 
  patient_id,
  case when practice_id = 'invalid' then '999'
       when practice_id IS NULL then '0' ELSE practice_id END AS practice_id,
  age,
  gender,
  registration_date,
  replace(CASE
    WHEN conditions LIKE '[%' AND conditions LIKE '%]'
    THEN substr(conditions, 2, length(conditions)-2)
    ELSE conditions
  END, '"', '') as conditions,
  email,
      regexp_replace(
        -- Step 2: Handle leading 1 or 001
        CASE
            WHEN regexp_matches(regexp_replace(phone, '[^0-9]', '', 'g'), '^(1|001)')
            THEN regexp_replace(regexp_replace(phone, '[^0-9]', '', 'g'), '^(1|001)', '')
            -- Step 3: Preserve numbers before letters, remove after
            ELSE regexp_replace(
                regexp_replace(phone, '([0-9]+)[a-zA-Z].*', '\1'),
                '[^0-9]', '', 'g'
            )
        END,
        -- Final cleanup in case any special chars remain
        '[^0-9]', '', 'g'
    ) AS phone
FROM patients)

select
     patient_id
   , CAST(practice_id AS INT) AS practice_id
   , practice_id
   , age
   , gender
   , registration_date
   , conditions
   , email
   , phone
from (
select *
 , dense_rank() over (partition by patient_id order by registration_date desc) as rank
from clean_patients) as a
where rank = 1
    );
  
  
[0m09:52:56.157846 [debug] [Thread-8 (]: SQL status: OK in 0.000 seconds
[0m09:52:56.157987 [debug] [Thread-8 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m09:52:56.158142 [debug] [Thread-8 (]: On model.data_takehome.int__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__practices"} */

  
    
    

    create  table
      "data_takehome"."main"."int__practices__dbt_tmp"
  
    as (
      with pcns as (
select *
FROM "data_takehome"."main"."stg__pcns"
)

, practices as (
select *
FROM "data_takehome"."main"."stg__practices"
)


select
     practices.id
   , practices.practice_name
   , practices.location
   , practices.established_date
   , practices.pcn
   , pcn_name
  from practices
  left join pcns
  on pcns.id = practices.pcn
    );
  
  
[0m09:52:56.160658 [debug] [Thread-8 (]: SQL status: OK in 0.002 seconds
[0m09:52:56.162259 [debug] [Thread-8 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m09:52:56.162446 [debug] [Thread-8 (]: On model.data_takehome.int__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__practices"} */
alter table "data_takehome"."main"."int__practices" rename to "int__practices__dbt_backup"
[0m09:52:56.162858 [debug] [Thread-8 (]: SQL status: OK in 0.000 seconds
[0m09:52:56.164359 [debug] [Thread-8 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m09:52:56.164524 [debug] [Thread-8 (]: On model.data_takehome.int__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__practices"} */
alter table "data_takehome"."main"."int__practices__dbt_tmp" rename to "int__practices"
[0m09:52:56.164710 [debug] [Thread-6 (]: SQL status: OK in 0.007 seconds
[0m09:52:56.166099 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m09:52:56.166266 [debug] [Thread-6 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */
alter table "data_takehome"."main"."int__patients" rename to "int__patients__dbt_backup"
[0m09:52:56.166435 [debug] [Thread-8 (]: SQL status: OK in 0.002 seconds
[0m09:52:56.168969 [debug] [Thread-8 (]: On model.data_takehome.int__practices: COMMIT
[0m09:52:56.169142 [debug] [Thread-8 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m09:52:56.169290 [debug] [Thread-8 (]: On model.data_takehome.int__practices: COMMIT
[0m09:52:56.169435 [debug] [Thread-6 (]: SQL status: OK in 0.003 seconds
[0m09:52:56.170775 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m09:52:56.170934 [debug] [Thread-6 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */
alter table "data_takehome"."main"."int__patients__dbt_tmp" rename to "int__patients"
[0m09:52:56.171089 [debug] [Thread-8 (]: SQL status: OK in 0.002 seconds
[0m09:52:56.172131 [debug] [Thread-8 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m09:52:56.172293 [debug] [Thread-8 (]: On model.data_takehome.int__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__practices"} */
drop table if exists "data_takehome"."main"."int__practices__dbt_backup" cascade
[0m09:52:56.172448 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m09:52:56.173212 [debug] [Thread-6 (]: On model.data_takehome.int__patients: COMMIT
[0m09:52:56.173356 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m09:52:56.173497 [debug] [Thread-6 (]: On model.data_takehome.int__patients: COMMIT
[0m09:52:56.173733 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m09:52:56.174387 [debug] [Thread-8 (]: On model.data_takehome.int__practices: Close
[0m09:52:56.174624 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bbbfd77-5fbb-4868-98ac-c408168dcaa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d83ce0>]}
[0m09:52:56.174788 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m09:52:56.176116 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m09:52:56.175053 [info ] [Thread-8 (]: 6 of 7 OK created sql table model main.int__practices .......................... [[32mOK[0m in 0.04s]
[0m09:52:56.176323 [debug] [Thread-6 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */
drop table if exists "data_takehome"."main"."int__patients__dbt_backup" cascade
[0m09:52:56.176569 [debug] [Thread-8 (]: Finished running node model.data_takehome.int__practices
[0m09:52:56.176891 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m09:52:56.177499 [debug] [Thread-6 (]: On model.data_takehome.int__patients: Close
[0m09:52:56.183138 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bbbfd77-5fbb-4868-98ac-c408168dcaa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bacdd0>]}
[0m09:52:56.183460 [info ] [Thread-6 (]: 5 of 7 OK created sql table model main.int__patients ........................... [[32mOK[0m in 0.05s]
[0m09:52:56.183724 [debug] [Thread-6 (]: Finished running node model.data_takehome.int__patients
[0m09:52:56.184093 [debug] [Thread-10 ]: Began running node model.data_takehome.patient_metadata
[0m09:52:56.184342 [info ] [Thread-10 ]: 7 of 7 START sql table model main.patient_metadata ............................. [RUN]
[0m09:52:56.184666 [debug] [Thread-10 ]: Acquiring new duckdb connection 'model.data_takehome.patient_metadata'
[0m09:52:56.184830 [debug] [Thread-10 ]: Began compiling node model.data_takehome.patient_metadata
[0m09:52:56.186436 [debug] [Thread-10 ]: Writing injected SQL for node "model.data_takehome.patient_metadata"
[0m09:52:56.187165 [debug] [Thread-10 ]: Began executing node model.data_takehome.patient_metadata
[0m09:52:56.188684 [debug] [Thread-10 ]: Writing runtime sql for node "model.data_takehome.patient_metadata"
[0m09:52:56.189121 [debug] [Thread-10 ]: Using duckdb connection "model.data_takehome.patient_metadata"
[0m09:52:56.189268 [debug] [Thread-10 ]: On model.data_takehome.patient_metadata: BEGIN
[0m09:52:56.189403 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m09:52:56.191946 [debug] [Thread-10 ]: SQL status: OK in 0.003 seconds
[0m09:52:56.192123 [debug] [Thread-10 ]: Using duckdb connection "model.data_takehome.patient_metadata"
[0m09:52:56.192287 [debug] [Thread-10 ]: On model.data_takehome.patient_metadata: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patient_metadata"} */

  
    
    

    create  table
      "data_takehome"."main"."patient_metadata__dbt_tmp"
  
    as (
      with patients as (
select *
 FROM "data_takehome"."main"."int__patients"
)

, practices as (
select *
 FROM "data_takehome"."main"."int__practices"
)

select
      patient_id
    , practice_id
    , practices.practice_name
    , practices.location
    , pcn_name
    , age
    , gender
    , registration_date
    , conditions
FROM patients
LEFT JOIN practices
ON patients.practice_id = practices.id
    );
  
  
[0m09:52:56.193540 [debug] [Thread-10 ]: SQL status: OK in 0.001 seconds
[0m09:52:56.195050 [debug] [Thread-10 ]: Using duckdb connection "model.data_takehome.patient_metadata"
[0m09:52:56.195219 [debug] [Thread-10 ]: On model.data_takehome.patient_metadata: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patient_metadata"} */
alter table "data_takehome"."main"."patient_metadata" rename to "patient_metadata__dbt_backup"
[0m09:52:56.195446 [debug] [Thread-10 ]: SQL status: OK in 0.000 seconds
[0m09:52:56.197658 [debug] [Thread-10 ]: Using duckdb connection "model.data_takehome.patient_metadata"
[0m09:52:56.197854 [debug] [Thread-10 ]: On model.data_takehome.patient_metadata: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patient_metadata"} */
alter table "data_takehome"."main"."patient_metadata__dbt_tmp" rename to "patient_metadata"
[0m09:52:56.198141 [debug] [Thread-10 ]: SQL status: OK in 0.000 seconds
[0m09:52:56.198985 [debug] [Thread-10 ]: On model.data_takehome.patient_metadata: COMMIT
[0m09:52:56.199156 [debug] [Thread-10 ]: Using duckdb connection "model.data_takehome.patient_metadata"
[0m09:52:56.199302 [debug] [Thread-10 ]: On model.data_takehome.patient_metadata: COMMIT
[0m09:52:56.200045 [debug] [Thread-10 ]: SQL status: OK in 0.001 seconds
[0m09:52:56.201285 [debug] [Thread-10 ]: Using duckdb connection "model.data_takehome.patient_metadata"
[0m09:52:56.201458 [debug] [Thread-10 ]: On model.data_takehome.patient_metadata: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patient_metadata"} */
drop table if exists "data_takehome"."main"."patient_metadata__dbt_backup" cascade
[0m09:52:56.201789 [debug] [Thread-10 ]: SQL status: OK in 0.000 seconds
[0m09:52:56.202459 [debug] [Thread-10 ]: On model.data_takehome.patient_metadata: Close
[0m09:52:56.206480 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bbbfd77-5fbb-4868-98ac-c408168dcaa9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cd4e30>]}
[0m09:52:56.206807 [info ] [Thread-10 ]: 7 of 7 OK created sql table model main.patient_metadata ........................ [[32mOK[0m in 0.02s]
[0m09:52:56.207057 [debug] [Thread-10 ]: Finished running node model.data_takehome.patient_metadata
[0m09:52:56.208050 [debug] [MainThread]: Using duckdb connection "master"
[0m09:52:56.208191 [debug] [MainThread]: On master: BEGIN
[0m09:52:56.208307 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:52:56.210718 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m09:52:56.210880 [debug] [MainThread]: On master: COMMIT
[0m09:52:56.211012 [debug] [MainThread]: Using duckdb connection "master"
[0m09:52:56.211129 [debug] [MainThread]: On master: COMMIT
[0m09:52:56.211259 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m09:52:56.211381 [debug] [MainThread]: On master: Close
[0m09:52:56.211835 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:52:56.211971 [debug] [MainThread]: Connection 'model.data_takehome.stg__activities' was properly closed.
[0m09:52:56.212088 [debug] [MainThread]: Connection 'model.data_takehome.stg__patients' was properly closed.
[0m09:52:56.212194 [debug] [MainThread]: Connection 'model.data_takehome.stg__pcns' was properly closed.
[0m09:52:56.212294 [debug] [MainThread]: Connection 'model.data_takehome.stg__practices' was properly closed.
[0m09:52:56.212397 [debug] [MainThread]: Connection 'model.data_takehome.int__patients' was properly closed.
[0m09:52:56.212497 [debug] [MainThread]: Connection 'model.data_takehome.int__practices' was properly closed.
[0m09:52:56.212595 [debug] [MainThread]: Connection 'model.data_takehome.patient_metadata' was properly closed.
[0m09:52:56.212781 [info ] [MainThread]: 
[0m09:52:56.212935 [info ] [MainThread]: Finished running 4 view models, 3 table models in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m09:52:56.213549 [debug] [MainThread]: Command end result
[0m09:52:56.227312 [info ] [MainThread]: 
[0m09:52:56.227573 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:52:56.227721 [info ] [MainThread]: 
[0m09:52:56.227872 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m09:52:56.229864 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6792753, "process_user_time": 1.022291, "process_kernel_time": 0.199344, "process_mem_max_rss": "155500544", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m09:52:56.230133 [debug] [MainThread]: Command `dbt run` succeeded at 09:52:56.230091 after 0.68 seconds
[0m09:52:56.230306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106444920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062ae630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10684dd30>]}
[0m09:52:56.230463 [debug] [MainThread]: Flushing usage events
[0m10:20:32.128954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104450b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047399d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047395e0>]}


============================== 10:20:32.138667 | 6a1566a7-2f28-48e8-b6c4-e691b14defcf ==============================
[0m10:20:32.138667 [info ] [MainThread]: Running with dbt=1.8.1
[0m10:20:32.138995 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:20:32.287013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a1566a7-2f28-48e8-b6c4-e691b14defcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104711d60>]}
[0m10:20:32.329069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a1566a7-2f28-48e8-b6c4-e691b14defcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10409d520>]}
[0m10:20:32.329858 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m10:20:32.382967 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m10:20:32.440991 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:20:32.441317 [debug] [MainThread]: Partial parsing: updated file: data_takehome://models/intermediate/int__patients.sql
[0m10:20:32.537596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a1566a7-2f28-48e8-b6c4-e691b14defcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104894260>]}
[0m10:20:32.579394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a1566a7-2f28-48e8-b6c4-e691b14defcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a51eb0>]}
[0m10:20:32.579669 [info ] [MainThread]: Found 4 seeds, 7 models, 421 macros
[0m10:20:32.579837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a1566a7-2f28-48e8-b6c4-e691b14defcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cdbf50>]}
[0m10:20:32.580703 [info ] [MainThread]: 
[0m10:20:32.580986 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m10:20:32.583267 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_data_takehome'
[0m10:20:32.625658 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome"
[0m10:20:32.625880 [debug] [ThreadPool]: On list_data_takehome: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m10:20:32.626020 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:20:32.636275 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m10:20:32.637016 [debug] [ThreadPool]: On list_data_takehome: Close
[0m10:20:32.638028 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data_takehome, now create_data_takehome_main)
[0m10:20:32.638277 [debug] [ThreadPool]: Creating schema "database: "data_takehome"
schema: "main"
"
[0m10:20:32.641509 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m10:20:32.641672 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
        select type from duckdb_databases()
        where database_name='data_takehome'
        and type='sqlite'
    
  
[0m10:20:32.641799 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:20:32.644435 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m10:20:32.645097 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m10:20:32.645235 [debug] [ThreadPool]: On create_data_takehome_main: BEGIN
[0m10:20:32.645377 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:20:32.645495 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m10:20:32.645610 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
    
        create schema if not exists "data_takehome"."main"
    
[0m10:20:32.645832 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:20:32.646213 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m10:20:32.646333 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m10:20:32.646441 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m10:20:32.646575 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m10:20:32.646695 [debug] [ThreadPool]: On create_data_takehome_main: Close
[0m10:20:32.647833 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_data_takehome_main, now list_data_takehome_main)
[0m10:20:32.650418 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m10:20:32.650562 [debug] [ThreadPool]: On list_data_takehome_main: BEGIN
[0m10:20:32.650673 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:20:32.652856 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m10:20:32.653003 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m10:20:32.653131 [debug] [ThreadPool]: On list_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome_main"} */
select
      'data_takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'data_takehome'
  
[0m10:20:32.664077 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m10:20:32.666751 [debug] [ThreadPool]: On list_data_takehome_main: ROLLBACK
[0m10:20:32.667701 [debug] [ThreadPool]: Failed to rollback 'list_data_takehome_main'
[0m10:20:32.667844 [debug] [ThreadPool]: On list_data_takehome_main: Close
[0m10:20:32.669376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a1566a7-2f28-48e8-b6c4-e691b14defcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c9d910>]}
[0m10:20:32.669592 [debug] [MainThread]: Using duckdb connection "master"
[0m10:20:32.669719 [debug] [MainThread]: On master: BEGIN
[0m10:20:32.669829 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:20:32.672120 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m10:20:32.672284 [debug] [MainThread]: On master: COMMIT
[0m10:20:32.672412 [debug] [MainThread]: Using duckdb connection "master"
[0m10:20:32.672529 [debug] [MainThread]: On master: COMMIT
[0m10:20:32.672664 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:20:32.672783 [debug] [MainThread]: On master: Close
[0m10:20:32.673233 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m10:20:32.673407 [info ] [MainThread]: 
[0m10:20:32.675652 [debug] [Thread-1 (]: Began running node model.data_takehome.stg__activities
[0m10:20:32.675859 [debug] [Thread-2 (]: Began running node model.data_takehome.stg__patients
[0m10:20:32.676262 [debug] [Thread-3 (]: Began running node model.data_takehome.stg__pcns
[0m10:20:32.676119 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg__activities ............................... [RUN]
[0m10:20:32.676739 [debug] [Thread-4 (]: Began running node model.data_takehome.stg__practices
[0m10:20:32.676519 [info ] [Thread-2 (]: 2 of 7 START sql view model main.stg__patients ................................. [RUN]
[0m10:20:32.677230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_takehome_main, now model.data_takehome.stg__activities)
[0m10:20:32.676973 [info ] [Thread-3 (]: 3 of 7 START sql view model main.stg__pcns ..................................... [RUN]
[0m10:20:32.677442 [info ] [Thread-4 (]: 4 of 7 START sql view model main.stg__practices ................................ [RUN]
[0m10:20:32.677710 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.data_takehome.stg__patients'
[0m10:20:32.677870 [debug] [Thread-1 (]: Began compiling node model.data_takehome.stg__activities
[0m10:20:32.678057 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.data_takehome.stg__pcns'
[0m10:20:32.678248 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.data_takehome.stg__practices'
[0m10:20:32.678404 [debug] [Thread-2 (]: Began compiling node model.data_takehome.stg__patients
[0m10:20:32.682225 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_takehome.stg__activities"
[0m10:20:32.682445 [debug] [Thread-3 (]: Began compiling node model.data_takehome.stg__pcns
[0m10:20:32.682607 [debug] [Thread-4 (]: Began compiling node model.data_takehome.stg__practices
[0m10:20:32.683760 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_takehome.stg__patients"
[0m10:20:32.684960 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_takehome.stg__pcns"
[0m10:20:32.686219 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_takehome.stg__practices"
[0m10:20:32.686512 [debug] [Thread-1 (]: Began executing node model.data_takehome.stg__activities
[0m10:20:32.701540 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_takehome.stg__activities"
[0m10:20:32.701813 [debug] [Thread-4 (]: Began executing node model.data_takehome.stg__practices
[0m10:20:32.704069 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_takehome.stg__practices"
[0m10:20:32.704340 [debug] [Thread-3 (]: Began executing node model.data_takehome.stg__pcns
[0m10:20:32.704522 [debug] [Thread-2 (]: Began executing node model.data_takehome.stg__patients
[0m10:20:32.706037 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_takehome.stg__pcns"
[0m10:20:32.707584 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_takehome.stg__patients"
[0m10:20:32.707800 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m10:20:32.708020 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m10:20:32.708191 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: BEGIN
[0m10:20:32.708390 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: BEGIN
[0m10:20:32.708567 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:20:32.708761 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m10:20:32.708922 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m10:20:32.709074 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m10:20:32.711525 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:20:32.711758 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: BEGIN
[0m10:20:32.711921 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: BEGIN
[0m10:20:32.712070 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m10:20:32.712210 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m10:20:32.712354 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m10:20:32.712490 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m10:20:32.712628 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m10:20:32.712775 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */

  
  create view "data_takehome"."main"."stg__activities__dbt_tmp" as (
    with activities as (
select * from "data_takehome"."main"."raw_activities" )

select * from activities
  );

[0m10:20:32.712977 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m10:20:32.713131 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */

  
  create view "data_takehome"."main"."stg__practices__dbt_tmp" as (
    with practices as (
select * from "data_takehome"."main"."raw_practices" )

select * from practices
  );

[0m10:20:32.713269 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m10:20:32.713429 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m10:20:32.713607 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m10:20:32.713781 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */

  
  create view "data_takehome"."main"."stg__patients__dbt_tmp" as (
    with patients as (
select * from "data_takehome"."main"."raw_patients" )

select * from patients
  );

[0m10:20:32.713926 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:20:32.714076 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */

  
  create view "data_takehome"."main"."stg__pcns__dbt_tmp" as (
    with pcns as (
select * from "data_takehome"."main"."raw_pcns" )

select * from pcns
  );

[0m10:20:32.714213 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m10:20:32.717364 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m10:20:32.718822 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m10:20:32.718996 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */
alter view "data_takehome"."main"."stg__activities" rename to "stg__activities__dbt_backup"
[0m10:20:32.719154 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m10:20:32.719303 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m10:20:32.719448 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */
alter view "data_takehome"."main"."stg__practices" rename to "stg__practices__dbt_backup"
[0m10:20:32.720838 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m10:20:32.722187 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m10:20:32.722365 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:20:32.722535 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m10:20:32.722676 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */
alter view "data_takehome"."main"."stg__patients" rename to "stg__patients__dbt_backup"
[0m10:20:32.722826 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */
alter view "data_takehome"."main"."stg__pcns" rename to "stg__pcns__dbt_backup"
[0m10:20:32.724042 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m10:20:32.725265 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m10:20:32.725523 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */
alter view "data_takehome"."main"."stg__activities__dbt_tmp" rename to "stg__activities"
[0m10:20:32.725674 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m10:20:32.725820 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */
alter view "data_takehome"."main"."stg__practices__dbt_tmp" rename to "stg__practices"
[0m10:20:32.725958 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m10:20:32.727255 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m10:20:32.727484 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:20:32.728725 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m10:20:32.728869 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m10:20:32.729016 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */
alter view "data_takehome"."main"."stg__patients__dbt_tmp" rename to "stg__patients"
[0m10:20:32.736760 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: COMMIT
[0m10:20:32.736929 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */
alter view "data_takehome"."main"."stg__pcns__dbt_tmp" rename to "stg__pcns"
[0m10:20:32.737611 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: COMMIT
[0m10:20:32.737791 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m10:20:32.737990 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m10:20:32.738129 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m10:20:32.738254 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m10:20:32.738391 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: COMMIT
[0m10:20:32.738524 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: COMMIT
[0m10:20:32.739177 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: COMMIT
[0m10:20:32.739795 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: COMMIT
[0m10:20:32.740872 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m10:20:32.741106 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m10:20:32.741258 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m10:20:32.741391 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m10:20:32.741530 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: COMMIT
[0m10:20:32.741670 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: COMMIT
[0m10:20:32.743989 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m10:20:32.745000 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m10:20:32.745217 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */
drop view if exists "data_takehome"."main"."stg__practices__dbt_backup" cascade
[0m10:20:32.745386 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m10:20:32.745556 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */
drop view if exists "data_takehome"."main"."stg__activities__dbt_backup" cascade
[0m10:20:32.745703 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m10:20:32.746736 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m10:20:32.747780 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m10:20:32.747945 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */
drop view if exists "data_takehome"."main"."stg__patients__dbt_backup" cascade
[0m10:20:32.748090 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m10:20:32.748262 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */
drop view if exists "data_takehome"."main"."stg__pcns__dbt_backup" cascade
[0m10:20:32.749456 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: Close
[0m10:20:32.749634 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m10:20:32.750342 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a1566a7-2f28-48e8-b6c4-e691b14defcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105140bc0>]}
[0m10:20:32.750527 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m10:20:32.750676 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m10:20:32.751248 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: Close
[0m10:20:32.752120 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: Close
[0m10:20:32.751538 [info ] [Thread-4 (]: 4 of 7 OK created sql view model main.stg__practices ........................... [[32mOK[0m in 0.07s]
[0m10:20:32.752767 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: Close
[0m10:20:32.752984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a1566a7-2f28-48e8-b6c4-e691b14defcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105195310>]}
[0m10:20:32.753192 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a1566a7-2f28-48e8-b6c4-e691b14defcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10505ddc0>]}
[0m10:20:32.753452 [debug] [Thread-4 (]: Finished running node model.data_takehome.stg__practices
[0m10:20:32.756883 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a1566a7-2f28-48e8-b6c4-e691b14defcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051b9880>]}
[0m10:20:32.757171 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.stg__activities .......................... [[32mOK[0m in 0.08s]
[0m10:20:32.757986 [debug] [Thread-1 (]: Finished running node model.data_takehome.stg__activities
[0m10:20:32.757396 [info ] [Thread-2 (]: 2 of 7 OK created sql view model main.stg__patients ............................ [[32mOK[0m in 0.08s]
[0m10:20:32.757772 [info ] [Thread-3 (]: 3 of 7 OK created sql view model main.stg__pcns ................................ [[32mOK[0m in 0.08s]
[0m10:20:32.758357 [debug] [Thread-2 (]: Finished running node model.data_takehome.stg__patients
[0m10:20:32.758593 [debug] [Thread-3 (]: Finished running node model.data_takehome.stg__pcns
[0m10:20:32.758958 [debug] [Thread-6 (]: Began running node model.data_takehome.int__patients
[0m10:20:32.759128 [debug] [Thread-7 (]: Began running node model.data_takehome.int__practices
[0m10:20:32.759384 [info ] [Thread-6 (]: 5 of 7 START sql table model main.int__patients ................................ [RUN]
[0m10:20:32.759655 [info ] [Thread-7 (]: 6 of 7 START sql table model main.int__practices ............................... [RUN]
[0m10:20:32.759937 [debug] [Thread-6 (]: Acquiring new duckdb connection 'model.data_takehome.int__patients'
[0m10:20:32.760178 [debug] [Thread-7 (]: Acquiring new duckdb connection 'model.data_takehome.int__practices'
[0m10:20:32.760352 [debug] [Thread-6 (]: Began compiling node model.data_takehome.int__patients
[0m10:20:32.760508 [debug] [Thread-7 (]: Began compiling node model.data_takehome.int__practices
[0m10:20:32.762059 [debug] [Thread-6 (]: Writing injected SQL for node "model.data_takehome.int__patients"
[0m10:20:32.763281 [debug] [Thread-7 (]: Writing injected SQL for node "model.data_takehome.int__practices"
[0m10:20:32.764093 [debug] [Thread-6 (]: Began executing node model.data_takehome.int__patients
[0m10:20:32.764251 [debug] [Thread-7 (]: Began executing node model.data_takehome.int__practices
[0m10:20:32.773452 [debug] [Thread-6 (]: Writing runtime sql for node "model.data_takehome.int__patients"
[0m10:20:32.775073 [debug] [Thread-7 (]: Writing runtime sql for node "model.data_takehome.int__practices"
[0m10:20:32.775840 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m10:20:32.776032 [debug] [Thread-6 (]: On model.data_takehome.int__patients: BEGIN
[0m10:20:32.776217 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m10:20:32.778811 [debug] [Thread-6 (]: SQL status: OK in 0.003 seconds
[0m10:20:32.779023 [debug] [Thread-7 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m10:20:32.779191 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m10:20:32.779426 [debug] [Thread-7 (]: On model.data_takehome.int__practices: BEGIN
[0m10:20:32.779641 [debug] [Thread-6 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */

  
    
    

    create  table
      "data_takehome"."main"."int__patients__dbt_tmp"
  
    as (
      WITH patients AS (
  SELECT 
    json_extract_string(data, '$.patient_id') AS patient_id,
    json_extract_string(data, '$.practice_id') AS practice_id,
    json_extract_string(data, '$.age') AS age,
    json_extract_string(data, '$.gender') AS gender,
    json_extract_string(data, '$.registration_date') AS registration_date,
    json_extract_string(data, '$.conditions') AS conditions,
    json_extract_string(data, '$.contact.email') AS email,
    json_extract_string(data, '$.contact.phone') AS phone
  FROM "data_takehome"."main"."stg__patients"
)

, clean_patients as (
-- remove square brackets from conditions column and clean phone number
SELECT 
  patient_id,
  case when practice_id = 'invalid' then '999'
       when practice_id IS NULL then '0' ELSE practice_id END AS practice_id,
  age,
  gender,
  registration_date,
  replace(CASE
    WHEN conditions LIKE '[%' AND conditions LIKE '%]'
    THEN substr(conditions, 2, length(conditions)-2)
    ELSE conditions
  END, '"', '') as conditions,
  email,
      regexp_replace(
        -- Step 2: Handle leading 1 or 001
        CASE
            WHEN regexp_matches(regexp_replace(phone, '[^0-9]', '', 'g'), '^(1|001)')
            THEN regexp_replace(regexp_replace(phone, '[^0-9]', '', 'g'), '^(1|001)', '')
            -- Step 3: Preserve numbers before letters, remove after
            ELSE regexp_replace(
                regexp_replace(phone, '([0-9]+)[a-zA-Z].*', '\1'),
                '[^0-9]', '', 'g'
            )
        END,
        -- Final cleanup in case any special chars remain
        '[^0-9]', '', 'g'
    ) AS phone
FROM patients)

select
     patient_id
   , CAST(practice_id AS INT) AS practice_id
   , practice_id
   , CAST(nullif(age, 'unknown') AS INT) AS age
   , gender
   , registration_date
   , conditions
   , email
   , phone
from (
select *
 , dense_rank() over (partition by patient_id order by registration_date desc) as rank
from clean_patients) as a
where rank = 1
    );
  
  
[0m10:20:32.779837 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m10:20:32.780049 [debug] [Thread-7 (]: SQL status: OK in 0.000 seconds
[0m10:20:32.780194 [debug] [Thread-7 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m10:20:32.780346 [debug] [Thread-7 (]: On model.data_takehome.int__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__practices"} */

  
    
    

    create  table
      "data_takehome"."main"."int__practices__dbt_tmp"
  
    as (
      with pcns as (
select *
FROM "data_takehome"."main"."stg__pcns"
)

, practices as (
select *
FROM "data_takehome"."main"."stg__practices"
)


select
     practices.id
   , practices.practice_name
   , practices.location
   , practices.established_date
   , practices.pcn
   , pcn_name
  from practices
  left join pcns
  on pcns.id = practices.pcn
    );
  
  
[0m10:20:32.782738 [debug] [Thread-7 (]: SQL status: OK in 0.002 seconds
[0m10:20:32.784254 [debug] [Thread-7 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m10:20:32.784435 [debug] [Thread-7 (]: On model.data_takehome.int__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__practices"} */
alter table "data_takehome"."main"."int__practices" rename to "int__practices__dbt_backup"
[0m10:20:32.784810 [debug] [Thread-7 (]: SQL status: OK in 0.000 seconds
[0m10:20:32.786626 [debug] [Thread-7 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m10:20:32.786796 [debug] [Thread-7 (]: On model.data_takehome.int__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__practices"} */
alter table "data_takehome"."main"."int__practices__dbt_tmp" rename to "int__practices"
[0m10:20:32.786990 [debug] [Thread-6 (]: SQL status: OK in 0.007 seconds
[0m10:20:32.788275 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m10:20:32.788434 [debug] [Thread-6 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */
alter table "data_takehome"."main"."int__patients" rename to "int__patients__dbt_backup"
[0m10:20:32.788647 [debug] [Thread-7 (]: SQL status: OK in 0.002 seconds
[0m10:20:32.788818 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m10:20:32.792067 [debug] [Thread-7 (]: On model.data_takehome.int__practices: COMMIT
[0m10:20:32.793313 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m10:20:32.793468 [debug] [Thread-7 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m10:20:32.793637 [debug] [Thread-6 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */
alter table "data_takehome"."main"."int__patients__dbt_tmp" rename to "int__patients"
[0m10:20:32.793799 [debug] [Thread-7 (]: On model.data_takehome.int__practices: COMMIT
[0m10:20:32.794018 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m10:20:32.794879 [debug] [Thread-6 (]: On model.data_takehome.int__patients: COMMIT
[0m10:20:32.795036 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m10:20:32.795180 [debug] [Thread-6 (]: On model.data_takehome.int__patients: COMMIT
[0m10:20:32.795325 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m10:20:32.796314 [debug] [Thread-7 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m10:20:32.796518 [debug] [Thread-7 (]: On model.data_takehome.int__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__practices"} */
drop table if exists "data_takehome"."main"."int__practices__dbt_backup" cascade
[0m10:20:32.796671 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m10:20:32.797621 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m10:20:32.797769 [debug] [Thread-6 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */
drop table if exists "data_takehome"."main"."int__patients__dbt_backup" cascade
[0m10:20:32.798036 [debug] [Thread-7 (]: SQL status: OK in 0.001 seconds
[0m10:20:32.798618 [debug] [Thread-7 (]: On model.data_takehome.int__practices: Close
[0m10:20:32.798841 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a1566a7-2f28-48e8-b6c4-e691b14defcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cf6ed0>]}
[0m10:20:32.799253 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m10:20:32.799122 [info ] [Thread-7 (]: 6 of 7 OK created sql table model main.int__practices .......................... [[32mOK[0m in 0.04s]
[0m10:20:32.800007 [debug] [Thread-6 (]: On model.data_takehome.int__patients: Close
[0m10:20:32.800268 [debug] [Thread-7 (]: Finished running node model.data_takehome.int__practices
[0m10:20:32.805619 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a1566a7-2f28-48e8-b6c4-e691b14defcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051b6420>]}
[0m10:20:32.806005 [info ] [Thread-6 (]: 5 of 7 OK created sql table model main.int__patients ........................... [[32mOK[0m in 0.05s]
[0m10:20:32.806249 [debug] [Thread-6 (]: Finished running node model.data_takehome.int__patients
[0m10:20:32.806557 [debug] [Thread-9 (]: Began running node model.data_takehome.patient_metadata
[0m10:20:32.806784 [info ] [Thread-9 (]: 7 of 7 START sql table model main.patient_metadata ............................. [RUN]
[0m10:20:32.807047 [debug] [Thread-9 (]: Acquiring new duckdb connection 'model.data_takehome.patient_metadata'
[0m10:20:32.807195 [debug] [Thread-9 (]: Began compiling node model.data_takehome.patient_metadata
[0m10:20:32.808676 [debug] [Thread-9 (]: Writing injected SQL for node "model.data_takehome.patient_metadata"
[0m10:20:32.809419 [debug] [Thread-9 (]: Began executing node model.data_takehome.patient_metadata
[0m10:20:32.811047 [debug] [Thread-9 (]: Writing runtime sql for node "model.data_takehome.patient_metadata"
[0m10:20:32.811578 [debug] [Thread-9 (]: Using duckdb connection "model.data_takehome.patient_metadata"
[0m10:20:32.811732 [debug] [Thread-9 (]: On model.data_takehome.patient_metadata: BEGIN
[0m10:20:32.811875 [debug] [Thread-9 (]: Opening a new connection, currently in state init
[0m10:20:32.814321 [debug] [Thread-9 (]: SQL status: OK in 0.002 seconds
[0m10:20:32.814501 [debug] [Thread-9 (]: Using duckdb connection "model.data_takehome.patient_metadata"
[0m10:20:32.814664 [debug] [Thread-9 (]: On model.data_takehome.patient_metadata: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patient_metadata"} */

  
    
    

    create  table
      "data_takehome"."main"."patient_metadata__dbt_tmp"
  
    as (
      with patients as (
select *
 FROM "data_takehome"."main"."int__patients"
)

, practices as (
select *
 FROM "data_takehome"."main"."int__practices"
)

select
      patient_id
    , practice_id
    , practices.practice_name
    , practices.location
    , pcn_name
    , age
    , gender
    , registration_date
    , conditions
FROM patients
LEFT JOIN practices
ON patients.practice_id = practices.id
    );
  
  
[0m10:20:32.816012 [debug] [Thread-9 (]: SQL status: OK in 0.001 seconds
[0m10:20:32.817487 [debug] [Thread-9 (]: Using duckdb connection "model.data_takehome.patient_metadata"
[0m10:20:32.817657 [debug] [Thread-9 (]: On model.data_takehome.patient_metadata: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patient_metadata"} */
alter table "data_takehome"."main"."patient_metadata" rename to "patient_metadata__dbt_backup"
[0m10:20:32.817885 [debug] [Thread-9 (]: SQL status: OK in 0.000 seconds
[0m10:20:32.819128 [debug] [Thread-9 (]: Using duckdb connection "model.data_takehome.patient_metadata"
[0m10:20:32.819276 [debug] [Thread-9 (]: On model.data_takehome.patient_metadata: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patient_metadata"} */
alter table "data_takehome"."main"."patient_metadata__dbt_tmp" rename to "patient_metadata"
[0m10:20:32.819473 [debug] [Thread-9 (]: SQL status: OK in 0.000 seconds
[0m10:20:32.820302 [debug] [Thread-9 (]: On model.data_takehome.patient_metadata: COMMIT
[0m10:20:32.820444 [debug] [Thread-9 (]: Using duckdb connection "model.data_takehome.patient_metadata"
[0m10:20:32.820574 [debug] [Thread-9 (]: On model.data_takehome.patient_metadata: COMMIT
[0m10:20:32.821192 [debug] [Thread-9 (]: SQL status: OK in 0.000 seconds
[0m10:20:32.822244 [debug] [Thread-9 (]: Using duckdb connection "model.data_takehome.patient_metadata"
[0m10:20:32.822473 [debug] [Thread-9 (]: On model.data_takehome.patient_metadata: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patient_metadata"} */
drop table if exists "data_takehome"."main"."patient_metadata__dbt_backup" cascade
[0m10:20:32.822802 [debug] [Thread-9 (]: SQL status: OK in 0.000 seconds
[0m10:20:32.823491 [debug] [Thread-9 (]: On model.data_takehome.patient_metadata: Close
[0m10:20:32.827391 [debug] [Thread-9 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a1566a7-2f28-48e8-b6c4-e691b14defcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10504c140>]}
[0m10:20:32.827677 [info ] [Thread-9 (]: 7 of 7 OK created sql table model main.patient_metadata ........................ [[32mOK[0m in 0.02s]
[0m10:20:32.827925 [debug] [Thread-9 (]: Finished running node model.data_takehome.patient_metadata
[0m10:20:32.828864 [debug] [MainThread]: Using duckdb connection "master"
[0m10:20:32.829010 [debug] [MainThread]: On master: BEGIN
[0m10:20:32.829128 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:20:32.831553 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m10:20:32.831716 [debug] [MainThread]: On master: COMMIT
[0m10:20:32.831844 [debug] [MainThread]: Using duckdb connection "master"
[0m10:20:32.831957 [debug] [MainThread]: On master: COMMIT
[0m10:20:32.832085 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m10:20:32.832207 [debug] [MainThread]: On master: Close
[0m10:20:32.832672 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:20:32.832828 [debug] [MainThread]: Connection 'model.data_takehome.stg__activities' was properly closed.
[0m10:20:32.832950 [debug] [MainThread]: Connection 'model.data_takehome.stg__patients' was properly closed.
[0m10:20:32.833063 [debug] [MainThread]: Connection 'model.data_takehome.stg__pcns' was properly closed.
[0m10:20:32.833163 [debug] [MainThread]: Connection 'model.data_takehome.stg__practices' was properly closed.
[0m10:20:32.833258 [debug] [MainThread]: Connection 'model.data_takehome.int__patients' was properly closed.
[0m10:20:32.833358 [debug] [MainThread]: Connection 'model.data_takehome.int__practices' was properly closed.
[0m10:20:32.833457 [debug] [MainThread]: Connection 'model.data_takehome.patient_metadata' was properly closed.
[0m10:20:32.833644 [info ] [MainThread]: 
[0m10:20:32.833799 [info ] [MainThread]: Finished running 4 view models, 3 table models in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m10:20:32.834421 [debug] [MainThread]: Command end result
[0m10:20:32.848924 [info ] [MainThread]: 
[0m10:20:32.849179 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:20:32.849420 [info ] [MainThread]: 
[0m10:20:32.849619 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m10:20:32.851590 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.756437, "process_user_time": 1.091233, "process_kernel_time": 0.214264, "process_mem_max_rss": "159875072", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m10:20:32.851851 [debug] [MainThread]: Command `dbt run` succeeded at 10:20:32.851808 after 0.76 seconds
[0m10:20:32.852030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104450b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104927920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104927c80>]}
[0m10:20:32.852200 [debug] [MainThread]: Flushing usage events
[0m20:50:15.641857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102d47200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104951730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104951370>]}


============================== 20:50:15.651203 | 05f0a95e-7055-48c4-b610-764e33acf6fc ==============================
[0m20:50:15.651203 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:50:15.651536 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:50:15.809245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05f0a95e-7055-48c4-b610-764e33acf6fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049bd040>]}
[0m20:50:15.851721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05f0a95e-7055-48c4-b610-764e33acf6fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049bc530>]}
[0m20:50:15.852550 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m20:50:15.914180 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:50:15.972669 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m20:50:15.972995 [debug] [MainThread]: Partial parsing: added file: data_takehome://models/schema.yml
[0m20:50:15.973183 [debug] [MainThread]: Partial parsing: updated file: data_takehome://models/intermediate/int__patients.sql
[0m20:50:16.067958 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m20:50:16.068274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '05f0a95e-7055-48c4-b610-764e33acf6fc', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d9c710>]}
[0m20:50:16.144739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05f0a95e-7055-48c4-b610-764e33acf6fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104912960>]}
[0m20:50:16.194540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05f0a95e-7055-48c4-b610-764e33acf6fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ee6930>]}
[0m20:50:16.194822 [info ] [MainThread]: Found 4 seeds, 7 models, 1 test, 421 macros
[0m20:50:16.194993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05f0a95e-7055-48c4-b610-764e33acf6fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104da3ef0>]}
[0m20:50:16.195847 [info ] [MainThread]: 
[0m20:50:16.196131 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:50:16.198456 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_data_takehome'
[0m20:50:16.245768 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome"
[0m20:50:16.246004 [debug] [ThreadPool]: On list_data_takehome: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where catalog_name = '"data_takehome"'
    
  
  
[0m20:50:16.246143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:16.257031 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m20:50:16.258130 [debug] [ThreadPool]: On list_data_takehome: Close
[0m20:50:16.259315 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_data_takehome, now create_data_takehome_main)
[0m20:50:16.259532 [debug] [ThreadPool]: Creating schema "database: "data_takehome"
schema: "main"
"
[0m20:50:16.262784 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m20:50:16.262945 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
        select type from duckdb_databases()
        where database_name='data_takehome'
        and type='sqlite'
    
  
[0m20:50:16.263072 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:50:16.265701 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m20:50:16.266359 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m20:50:16.266493 [debug] [ThreadPool]: On create_data_takehome_main: BEGIN
[0m20:50:16.266634 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:50:16.266748 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m20:50:16.266867 [debug] [ThreadPool]: On create_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "create_data_takehome_main"} */

    
    
        create schema if not exists "data_takehome"."main"
    
[0m20:50:16.267096 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:50:16.267472 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m20:50:16.267599 [debug] [ThreadPool]: Using duckdb connection "create_data_takehome_main"
[0m20:50:16.267707 [debug] [ThreadPool]: On create_data_takehome_main: COMMIT
[0m20:50:16.267845 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m20:50:16.267967 [debug] [ThreadPool]: On create_data_takehome_main: Close
[0m20:50:16.269099 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_data_takehome_main, now list_data_takehome_main)
[0m20:50:16.271623 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m20:50:16.271764 [debug] [ThreadPool]: On list_data_takehome_main: BEGIN
[0m20:50:16.271878 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:50:16.274088 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:50:16.274240 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m20:50:16.274373 [debug] [ThreadPool]: On list_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome_main"} */
select
      'data_takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'data_takehome'
  
[0m20:50:16.285760 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m20:50:16.288444 [debug] [ThreadPool]: On list_data_takehome_main: ROLLBACK
[0m20:50:16.289399 [debug] [ThreadPool]: Failed to rollback 'list_data_takehome_main'
[0m20:50:16.289537 [debug] [ThreadPool]: On list_data_takehome_main: Close
[0m20:50:16.291087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05f0a95e-7055-48c4-b610-764e33acf6fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053d8170>]}
[0m20:50:16.291298 [debug] [MainThread]: Using duckdb connection "master"
[0m20:50:16.291427 [debug] [MainThread]: On master: BEGIN
[0m20:50:16.291540 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:50:16.293874 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:50:16.294042 [debug] [MainThread]: On master: COMMIT
[0m20:50:16.294168 [debug] [MainThread]: Using duckdb connection "master"
[0m20:50:16.294280 [debug] [MainThread]: On master: COMMIT
[0m20:50:16.294411 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:50:16.294529 [debug] [MainThread]: On master: Close
[0m20:50:16.295001 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m20:50:16.295151 [info ] [MainThread]: 
[0m20:50:16.297408 [debug] [Thread-1 (]: Began running node model.data_takehome.stg__activities
[0m20:50:16.297604 [debug] [Thread-2 (]: Began running node model.data_takehome.stg__patients
[0m20:50:16.297777 [debug] [Thread-3 (]: Began running node model.data_takehome.stg__pcns
[0m20:50:16.297931 [debug] [Thread-4 (]: Began running node model.data_takehome.stg__practices
[0m20:50:16.298166 [info ] [Thread-1 (]: 1 of 7 START sql view model main.stg__activities ............................... [RUN]
[0m20:50:16.298444 [info ] [Thread-2 (]: 2 of 7 START sql view model main.stg__patients ................................. [RUN]
[0m20:50:16.298717 [info ] [Thread-3 (]: 3 of 7 START sql view model main.stg__pcns ..................................... [RUN]
[0m20:50:16.298949 [info ] [Thread-4 (]: 4 of 7 START sql view model main.stg__practices ................................ [RUN]
[0m20:50:16.299175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_takehome_main, now model.data_takehome.stg__activities)
[0m20:50:16.299393 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.data_takehome.stg__patients'
[0m20:50:16.299590 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.data_takehome.stg__pcns'
[0m20:50:16.299773 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.data_takehome.stg__practices'
[0m20:50:16.299924 [debug] [Thread-1 (]: Began compiling node model.data_takehome.stg__activities
[0m20:50:16.300071 [debug] [Thread-2 (]: Began compiling node model.data_takehome.stg__patients
[0m20:50:16.300212 [debug] [Thread-3 (]: Began compiling node model.data_takehome.stg__pcns
[0m20:50:16.300349 [debug] [Thread-4 (]: Began compiling node model.data_takehome.stg__practices
[0m20:50:16.303750 [debug] [Thread-1 (]: Writing injected SQL for node "model.data_takehome.stg__activities"
[0m20:50:16.304932 [debug] [Thread-2 (]: Writing injected SQL for node "model.data_takehome.stg__patients"
[0m20:50:16.306055 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_takehome.stg__pcns"
[0m20:50:16.307165 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_takehome.stg__practices"
[0m20:50:16.308301 [debug] [Thread-1 (]: Began executing node model.data_takehome.stg__activities
[0m20:50:16.320901 [debug] [Thread-4 (]: Began executing node model.data_takehome.stg__practices
[0m20:50:16.325977 [debug] [Thread-4 (]: Writing runtime sql for node "model.data_takehome.stg__practices"
[0m20:50:16.326209 [debug] [Thread-2 (]: Began executing node model.data_takehome.stg__patients
[0m20:50:16.326859 [debug] [Thread-1 (]: Writing runtime sql for node "model.data_takehome.stg__activities"
[0m20:50:16.328481 [debug] [Thread-2 (]: Writing runtime sql for node "model.data_takehome.stg__patients"
[0m20:50:16.328772 [debug] [Thread-3 (]: Began executing node model.data_takehome.stg__pcns
[0m20:50:16.328994 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m20:50:16.330453 [debug] [Thread-3 (]: Writing runtime sql for node "model.data_takehome.stg__pcns"
[0m20:50:16.330675 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: BEGIN
[0m20:50:16.330859 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m20:50:16.331016 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m20:50:16.331191 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:50:16.331349 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: BEGIN
[0m20:50:16.331510 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: BEGIN
[0m20:50:16.334272 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m20:50:16.334474 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m20:50:16.334616 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:50:16.334759 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:50:16.334904 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m20:50:16.335051 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: BEGIN
[0m20:50:16.335245 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:50:16.335408 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */

  
  create view "data_takehome"."main"."stg__practices__dbt_tmp" as (
    with practices as (
select * from "data_takehome"."main"."raw_practices" )

select * from practices
  );

[0m20:50:16.335560 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:50:16.335689 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:50:16.335830 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m20:50:16.335981 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m20:50:16.336179 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */

  
  create view "data_takehome"."main"."stg__activities__dbt_tmp" as (
    with activities as (
select * from "data_takehome"."main"."raw_activities" )

select * from activities
  );

[0m20:50:16.336358 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:50:16.336498 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */

  
  create view "data_takehome"."main"."stg__patients__dbt_tmp" as (
    with patients as (
select * from "data_takehome"."main"."raw_patients" )

select * from patients
  );

[0m20:50:16.336645 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:50:16.336815 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m20:50:16.339911 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m20:50:16.340113 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */

  
  create view "data_takehome"."main"."stg__pcns__dbt_tmp" as (
    with pcns as (
select * from "data_takehome"."main"."raw_pcns" )

select * from pcns
  );

[0m20:50:16.340291 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m20:50:16.340436 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */
alter view "data_takehome"."main"."stg__practices" rename to "stg__practices__dbt_backup"
[0m20:50:16.340587 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m20:50:16.341979 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m20:50:16.343395 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m20:50:16.343562 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m20:50:16.343743 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */
alter view "data_takehome"."main"."stg__activities" rename to "stg__activities__dbt_backup"
[0m20:50:16.343911 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m20:50:16.344049 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */
alter view "data_takehome"."main"."stg__patients" rename to "stg__patients__dbt_backup"
[0m20:50:16.345399 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m20:50:16.346701 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m20:50:16.346905 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */
alter view "data_takehome"."main"."stg__pcns" rename to "stg__pcns__dbt_backup"
[0m20:50:16.347088 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:50:16.347231 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */
alter view "data_takehome"."main"."stg__practices__dbt_tmp" rename to "stg__practices"
[0m20:50:16.347363 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m20:50:16.348645 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m20:50:16.348884 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:50:16.349038 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m20:50:16.350845 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m20:50:16.351016 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */
alter view "data_takehome"."main"."stg__patients__dbt_tmp" rename to "stg__patients"
[0m20:50:16.352250 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m20:50:16.358705 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */
alter view "data_takehome"."main"."stg__activities__dbt_tmp" rename to "stg__activities"
[0m20:50:16.360222 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: COMMIT
[0m20:50:16.360420 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */
alter view "data_takehome"."main"."stg__pcns__dbt_tmp" rename to "stg__pcns"
[0m20:50:16.360636 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m20:50:16.360779 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:50:16.360949 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m20:50:16.361129 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: COMMIT
[0m20:50:16.361264 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m20:50:16.361946 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: COMMIT
[0m20:50:16.362568 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: COMMIT
[0m20:50:16.363341 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: COMMIT
[0m20:50:16.363528 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m20:50:16.363675 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m20:50:16.363827 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m20:50:16.363967 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m20:50:16.364109 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: COMMIT
[0m20:50:16.364242 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: COMMIT
[0m20:50:16.366532 [debug] [Thread-4 (]: Using duckdb connection "model.data_takehome.stg__practices"
[0m20:50:16.366706 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: COMMIT
[0m20:50:16.366953 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__practices"} */
drop view if exists "data_takehome"."main"."stg__practices__dbt_backup" cascade
[0m20:50:16.367112 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m20:50:16.367250 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m20:50:16.368318 [debug] [Thread-2 (]: Using duckdb connection "model.data_takehome.stg__patients"
[0m20:50:16.368459 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m20:50:16.369490 [debug] [Thread-1 (]: Using duckdb connection "model.data_takehome.stg__activities"
[0m20:50:16.369679 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__patients"} */
drop view if exists "data_takehome"."main"."stg__patients__dbt_backup" cascade
[0m20:50:16.369834 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m20:50:16.370780 [debug] [Thread-3 (]: Using duckdb connection "model.data_takehome.stg__pcns"
[0m20:50:16.370935 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__activities"} */
drop view if exists "data_takehome"."main"."stg__activities__dbt_backup" cascade
[0m20:50:16.372086 [debug] [Thread-4 (]: On model.data_takehome.stg__practices: Close
[0m20:50:16.372260 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.stg__pcns"} */
drop view if exists "data_takehome"."main"."stg__pcns__dbt_backup" cascade
[0m20:50:16.372778 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m20:50:16.373181 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05f0a95e-7055-48c4-b610-764e33acf6fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033434d0>]}
[0m20:50:16.373344 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m20:50:16.373902 [debug] [Thread-2 (]: On model.data_takehome.stg__patients: Close
[0m20:50:16.374166 [info ] [Thread-4 (]: 4 of 7 OK created sql view model main.stg__practices ........................... [[32mOK[0m in 0.07s]
[0m20:50:16.374808 [debug] [Thread-1 (]: On model.data_takehome.stg__activities: Close
[0m20:50:16.374960 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m20:50:16.375173 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05f0a95e-7055-48c4-b610-764e33acf6fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053ba3f0>]}
[0m20:50:16.375409 [debug] [Thread-4 (]: Finished running node model.data_takehome.stg__practices
[0m20:50:16.375588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05f0a95e-7055-48c4-b610-764e33acf6fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ee57f0>]}
[0m20:50:16.376120 [debug] [Thread-3 (]: On model.data_takehome.stg__pcns: Close
[0m20:50:16.376351 [info ] [Thread-2 (]: 2 of 7 OK created sql view model main.stg__patients ............................ [[32mOK[0m in 0.08s]
[0m20:50:16.379916 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05f0a95e-7055-48c4-b610-764e33acf6fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10546d7f0>]}
[0m20:50:16.376722 [info ] [Thread-1 (]: 1 of 7 OK created sql view model main.stg__activities .......................... [[32mOK[0m in 0.08s]
[0m20:50:16.380257 [debug] [Thread-2 (]: Finished running node model.data_takehome.stg__patients
[0m20:50:16.380732 [debug] [Thread-1 (]: Finished running node model.data_takehome.stg__activities
[0m20:50:16.380531 [info ] [Thread-3 (]: 3 of 7 OK created sql view model main.stg__pcns ................................ [[32mOK[0m in 0.08s]
[0m20:50:16.381137 [debug] [Thread-6 (]: Began running node model.data_takehome.int__patients
[0m20:50:16.381370 [debug] [Thread-3 (]: Finished running node model.data_takehome.stg__pcns
[0m20:50:16.381596 [info ] [Thread-6 (]: 5 of 7 START sql table model main.int__patients ................................ [RUN]
[0m20:50:16.381878 [debug] [Thread-6 (]: Acquiring new duckdb connection 'model.data_takehome.int__patients'
[0m20:50:16.382050 [debug] [Thread-6 (]: Began compiling node model.data_takehome.int__patients
[0m20:50:16.382211 [debug] [Thread-8 (]: Began running node model.data_takehome.int__practices
[0m20:50:16.383663 [debug] [Thread-6 (]: Writing injected SQL for node "model.data_takehome.int__patients"
[0m20:50:16.383883 [info ] [Thread-8 (]: 6 of 7 START sql table model main.int__practices ............................... [RUN]
[0m20:50:16.384148 [debug] [Thread-8 (]: Acquiring new duckdb connection 'model.data_takehome.int__practices'
[0m20:50:16.384308 [debug] [Thread-8 (]: Began compiling node model.data_takehome.int__practices
[0m20:50:16.385700 [debug] [Thread-8 (]: Writing injected SQL for node "model.data_takehome.int__practices"
[0m20:50:16.385950 [debug] [Thread-6 (]: Began executing node model.data_takehome.int__patients
[0m20:50:16.395450 [debug] [Thread-6 (]: Writing runtime sql for node "model.data_takehome.int__patients"
[0m20:50:16.395819 [debug] [Thread-8 (]: Began executing node model.data_takehome.int__practices
[0m20:50:16.397344 [debug] [Thread-8 (]: Writing runtime sql for node "model.data_takehome.int__practices"
[0m20:50:16.397612 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m20:50:16.397783 [debug] [Thread-6 (]: On model.data_takehome.int__patients: BEGIN
[0m20:50:16.397935 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m20:50:16.400449 [debug] [Thread-6 (]: SQL status: OK in 0.002 seconds
[0m20:50:16.400820 [debug] [Thread-8 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m20:50:16.400977 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m20:50:16.401138 [debug] [Thread-8 (]: On model.data_takehome.int__practices: BEGIN
[0m20:50:16.401341 [debug] [Thread-6 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */

  
    
    

    create  table
      "data_takehome"."main"."int__patients__dbt_tmp"
  
    as (
      WITH patients AS (
  SELECT 
    json_extract_string(data, '$.patient_id') AS patient_id,
    json_extract_string(data, '$.practice_id') AS practice_id,
    json_extract_string(data, '$.age') AS age,
    json_extract_string(data, '$.gender') AS gender,
    json_extract_string(data, '$.registration_date') AS registration_date,
    json_extract_string(data, '$.conditions') AS conditions,
    json_extract_string(data, '$.contact.email') AS email,
    json_extract_string(data, '$.contact.phone') AS phone
  FROM "data_takehome"."main"."stg__patients"
)

, clean_patients as (
-- remove square brackets from conditions column and clean phone number
SELECT 
  patient_id,
  case when practice_id = 'invalid' then '999'
       when practice_id IS NULL then '0' ELSE practice_id END AS practice_id,
  age,
  gender,
  registration_date,
  replace(CASE
    WHEN conditions LIKE '[%' AND conditions LIKE '%]'
    THEN substr(conditions, 2, length(conditions)-2)
    ELSE conditions
  END, '"', '') as conditions,
  email,
      regexp_replace(
        -- Step 2: Handle leading 1 or 001
        CASE
            WHEN regexp_matches(regexp_replace(phone, '[^0-9]', '', 'g'), '^(1|001)')
            THEN regexp_replace(regexp_replace(phone, '[^0-9]', '', 'g'), '^(1|001)', '')
            -- Step 3: Preserve numbers before letters, remove after
            ELSE regexp_replace(
                regexp_replace(phone, '([0-9]+)[a-zA-Z].*', '\1'),
                '[^0-9]', '', 'g'
            )
        END,
        -- Final cleanup in case any special chars remain
        '[^0-9]', '', 'g'
    ) AS phone
FROM patients)

select
     patient_id
   , CAST(practice_id AS INT) AS practice_id
   , CAST(nullif(age, 'unknown') AS INT) AS age
   , gender
   , registration_date
   , conditions
   , email
   , phone
from (
select *
 , dense_rank() over (partition by patient_id order by registration_date desc) as rank
from clean_patients) as a
where rank = 1
    );
  
  
[0m20:50:16.401532 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m20:50:16.401735 [debug] [Thread-8 (]: SQL status: OK in 0.000 seconds
[0m20:50:16.401873 [debug] [Thread-8 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m20:50:16.402021 [debug] [Thread-8 (]: On model.data_takehome.int__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__practices"} */

  
    
    

    create  table
      "data_takehome"."main"."int__practices__dbt_tmp"
  
    as (
      with pcns as (
select *
FROM "data_takehome"."main"."stg__pcns"
)

, practices as (
select *
FROM "data_takehome"."main"."stg__practices"
)


select
     practices.id
   , practices.practice_name
   , practices.location
   , practices.established_date
   , practices.pcn
   , pcn_name
  from practices
  left join pcns
  on pcns.id = practices.pcn
    );
  
  
[0m20:50:16.404774 [debug] [Thread-8 (]: SQL status: OK in 0.003 seconds
[0m20:50:16.406296 [debug] [Thread-8 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m20:50:16.406481 [debug] [Thread-8 (]: On model.data_takehome.int__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__practices"} */
alter table "data_takehome"."main"."int__practices" rename to "int__practices__dbt_backup"
[0m20:50:16.406906 [debug] [Thread-8 (]: SQL status: OK in 0.000 seconds
[0m20:50:16.409412 [debug] [Thread-8 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m20:50:16.409621 [debug] [Thread-8 (]: On model.data_takehome.int__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__practices"} */
alter table "data_takehome"."main"."int__practices__dbt_tmp" rename to "int__practices"
[0m20:50:16.409814 [debug] [Thread-6 (]: SQL status: OK in 0.008 seconds
[0m20:50:16.411130 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m20:50:16.411292 [debug] [Thread-6 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */
alter table "data_takehome"."main"."int__patients" rename to "int__patients__dbt_backup"
[0m20:50:16.411488 [debug] [Thread-8 (]: SQL status: OK in 0.002 seconds
[0m20:50:16.411657 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m20:50:16.414189 [debug] [Thread-8 (]: On model.data_takehome.int__practices: COMMIT
[0m20:50:16.415472 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m20:50:16.415633 [debug] [Thread-8 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m20:50:16.415807 [debug] [Thread-6 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */
alter table "data_takehome"."main"."int__patients__dbt_tmp" rename to "int__patients"
[0m20:50:16.415977 [debug] [Thread-8 (]: On model.data_takehome.int__practices: COMMIT
[0m20:50:16.416210 [debug] [Thread-6 (]: SQL status: OK in 0.000 seconds
[0m20:50:16.417077 [debug] [Thread-6 (]: On model.data_takehome.int__patients: COMMIT
[0m20:50:16.417226 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m20:50:16.417364 [debug] [Thread-6 (]: On model.data_takehome.int__patients: COMMIT
[0m20:50:16.417501 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m20:50:16.418546 [debug] [Thread-8 (]: Using duckdb connection "model.data_takehome.int__practices"
[0m20:50:16.418757 [debug] [Thread-8 (]: On model.data_takehome.int__practices: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__practices"} */
drop table if exists "data_takehome"."main"."int__practices__dbt_backup" cascade
[0m20:50:16.418919 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m20:50:16.419869 [debug] [Thread-6 (]: Using duckdb connection "model.data_takehome.int__patients"
[0m20:50:16.420016 [debug] [Thread-6 (]: On model.data_takehome.int__patients: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.int__patients"} */
drop table if exists "data_takehome"."main"."int__patients__dbt_backup" cascade
[0m20:50:16.420286 [debug] [Thread-8 (]: SQL status: OK in 0.001 seconds
[0m20:50:16.420903 [debug] [Thread-8 (]: On model.data_takehome.int__practices: Close
[0m20:50:16.421131 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05f0a95e-7055-48c4-b610-764e33acf6fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105034e60>]}
[0m20:50:16.421540 [debug] [Thread-6 (]: SQL status: OK in 0.001 seconds
[0m20:50:16.421408 [info ] [Thread-8 (]: 6 of 7 OK created sql table model main.int__practices .......................... [[32mOK[0m in 0.04s]
[0m20:50:16.422184 [debug] [Thread-6 (]: On model.data_takehome.int__patients: Close
[0m20:50:16.422423 [debug] [Thread-8 (]: Finished running node model.data_takehome.int__practices
[0m20:50:16.427755 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05f0a95e-7055-48c4-b610-764e33acf6fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054b97f0>]}
[0m20:50:16.428167 [info ] [Thread-6 (]: 5 of 7 OK created sql table model main.int__patients ........................... [[32mOK[0m in 0.05s]
[0m20:50:16.428452 [debug] [Thread-6 (]: Finished running node model.data_takehome.int__patients
[0m20:50:16.428807 [debug] [Thread-10 ]: Began running node model.data_takehome.patient_metadata
[0m20:50:16.429065 [info ] [Thread-10 ]: 7 of 7 START sql table model main.patient_metadata ............................. [RUN]
[0m20:50:16.429342 [debug] [Thread-10 ]: Acquiring new duckdb connection 'model.data_takehome.patient_metadata'
[0m20:50:16.429496 [debug] [Thread-10 ]: Began compiling node model.data_takehome.patient_metadata
[0m20:50:16.430912 [debug] [Thread-10 ]: Writing injected SQL for node "model.data_takehome.patient_metadata"
[0m20:50:16.431692 [debug] [Thread-10 ]: Began executing node model.data_takehome.patient_metadata
[0m20:50:16.433309 [debug] [Thread-10 ]: Writing runtime sql for node "model.data_takehome.patient_metadata"
[0m20:50:16.433824 [debug] [Thread-10 ]: Using duckdb connection "model.data_takehome.patient_metadata"
[0m20:50:16.434001 [debug] [Thread-10 ]: On model.data_takehome.patient_metadata: BEGIN
[0m20:50:16.434145 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m20:50:16.436943 [debug] [Thread-10 ]: SQL status: OK in 0.003 seconds
[0m20:50:16.437159 [debug] [Thread-10 ]: Using duckdb connection "model.data_takehome.patient_metadata"
[0m20:50:16.437322 [debug] [Thread-10 ]: On model.data_takehome.patient_metadata: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patient_metadata"} */

  
    
    

    create  table
      "data_takehome"."main"."patient_metadata__dbt_tmp"
  
    as (
      with patients as (
select *
 FROM "data_takehome"."main"."int__patients"
)

, practices as (
select *
 FROM "data_takehome"."main"."int__practices"
)

select
      patient_id
    , practice_id
    , practices.practice_name
    , practices.location
    , pcn_name
    , age
    , gender
    , registration_date
    , conditions
FROM patients
LEFT JOIN practices
ON patients.practice_id = practices.id
    );
  
  
[0m20:50:16.438493 [debug] [Thread-10 ]: SQL status: OK in 0.001 seconds
[0m20:50:16.439999 [debug] [Thread-10 ]: Using duckdb connection "model.data_takehome.patient_metadata"
[0m20:50:16.440158 [debug] [Thread-10 ]: On model.data_takehome.patient_metadata: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patient_metadata"} */
alter table "data_takehome"."main"."patient_metadata" rename to "patient_metadata__dbt_backup"
[0m20:50:16.440370 [debug] [Thread-10 ]: SQL status: OK in 0.000 seconds
[0m20:50:16.441572 [debug] [Thread-10 ]: Using duckdb connection "model.data_takehome.patient_metadata"
[0m20:50:16.441720 [debug] [Thread-10 ]: On model.data_takehome.patient_metadata: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patient_metadata"} */
alter table "data_takehome"."main"."patient_metadata__dbt_tmp" rename to "patient_metadata"
[0m20:50:16.441913 [debug] [Thread-10 ]: SQL status: OK in 0.000 seconds
[0m20:50:16.442728 [debug] [Thread-10 ]: On model.data_takehome.patient_metadata: COMMIT
[0m20:50:16.442869 [debug] [Thread-10 ]: Using duckdb connection "model.data_takehome.patient_metadata"
[0m20:50:16.442996 [debug] [Thread-10 ]: On model.data_takehome.patient_metadata: COMMIT
[0m20:50:16.443642 [debug] [Thread-10 ]: SQL status: OK in 0.001 seconds
[0m20:50:16.444628 [debug] [Thread-10 ]: Using duckdb connection "model.data_takehome.patient_metadata"
[0m20:50:16.444842 [debug] [Thread-10 ]: On model.data_takehome.patient_metadata: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "node_id": "model.data_takehome.patient_metadata"} */
drop table if exists "data_takehome"."main"."patient_metadata__dbt_backup" cascade
[0m20:50:16.445131 [debug] [Thread-10 ]: SQL status: OK in 0.000 seconds
[0m20:50:16.445746 [debug] [Thread-10 ]: On model.data_takehome.patient_metadata: Close
[0m20:50:16.449246 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05f0a95e-7055-48c4-b610-764e33acf6fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053bde50>]}
[0m20:50:16.449534 [info ] [Thread-10 ]: 7 of 7 OK created sql table model main.patient_metadata ........................ [[32mOK[0m in 0.02s]
[0m20:50:16.449784 [debug] [Thread-10 ]: Finished running node model.data_takehome.patient_metadata
[0m20:50:16.451032 [debug] [MainThread]: Using duckdb connection "master"
[0m20:50:16.451201 [debug] [MainThread]: On master: BEGIN
[0m20:50:16.451322 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:50:16.453746 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m20:50:16.453913 [debug] [MainThread]: On master: COMMIT
[0m20:50:16.454041 [debug] [MainThread]: Using duckdb connection "master"
[0m20:50:16.454155 [debug] [MainThread]: On master: COMMIT
[0m20:50:16.454286 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m20:50:16.454406 [debug] [MainThread]: On master: Close
[0m20:50:16.454877 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:50:16.455035 [debug] [MainThread]: Connection 'model.data_takehome.stg__activities' was properly closed.
[0m20:50:16.455153 [debug] [MainThread]: Connection 'model.data_takehome.stg__patients' was properly closed.
[0m20:50:16.455261 [debug] [MainThread]: Connection 'model.data_takehome.stg__pcns' was properly closed.
[0m20:50:16.455361 [debug] [MainThread]: Connection 'model.data_takehome.stg__practices' was properly closed.
[0m20:50:16.455458 [debug] [MainThread]: Connection 'model.data_takehome.int__patients' was properly closed.
[0m20:50:16.455556 [debug] [MainThread]: Connection 'model.data_takehome.int__practices' was properly closed.
[0m20:50:16.455651 [debug] [MainThread]: Connection 'model.data_takehome.patient_metadata' was properly closed.
[0m20:50:16.455836 [info ] [MainThread]: 
[0m20:50:16.455991 [info ] [MainThread]: Finished running 4 view models, 3 table models in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m20:50:16.456615 [debug] [MainThread]: Command end result
[0m20:50:16.471566 [info ] [MainThread]: 
[0m20:50:16.471845 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:50:16.472000 [info ] [MainThread]: 
[0m20:50:16.472158 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m20:50:16.478074 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8723209, "process_user_time": 1.202282, "process_kernel_time": 0.262643, "process_mem_max_rss": "161890304", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:50:16.478350 [debug] [MainThread]: Command `dbt run` succeeded at 20:50:16.478306 after 0.87 seconds
[0m20:50:16.478527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104951730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054c3fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050367b0>]}
[0m20:50:16.478691 [debug] [MainThread]: Flushing usage events
[0m20:50:33.830032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1027cef30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041adbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041ad7f0>]}


============================== 20:50:33.832686 | d430694f-cea5-4e44-ab03-41eee23085be ==============================
[0m20:50:33.832686 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:50:33.833000 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'debug': 'False', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate --static', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:50:33.922282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd430694f-cea5-4e44-ab03-41eee23085be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104081400>]}
[0m20:50:33.964776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd430694f-cea5-4e44-ab03-41eee23085be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104339c40>]}
[0m20:50:33.965334 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m20:50:34.014987 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:50:34.067158 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:50:34.067384 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:50:34.088304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd430694f-cea5-4e44-ab03-41eee23085be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043398b0>]}
[0m20:50:34.095893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd430694f-cea5-4e44-ab03-41eee23085be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10464a000>]}
[0m20:50:34.096140 [info ] [MainThread]: Found 4 seeds, 7 models, 1 test, 421 macros
[0m20:50:34.096303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd430694f-cea5-4e44-ab03-41eee23085be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041677d0>]}
[0m20:50:34.097162 [info ] [MainThread]: 
[0m20:50:34.097431 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:50:34.099886 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_data_takehome_main'
[0m20:50:34.127356 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m20:50:34.127596 [debug] [ThreadPool]: On list_data_takehome_main: BEGIN
[0m20:50:34.127730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:34.130656 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m20:50:34.130822 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m20:50:34.130960 [debug] [ThreadPool]: On list_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome_main"} */
select
      'data_takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'data_takehome'
  
[0m20:50:34.140504 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m20:50:34.142977 [debug] [ThreadPool]: On list_data_takehome_main: ROLLBACK
[0m20:50:34.143662 [debug] [ThreadPool]: Failed to rollback 'list_data_takehome_main'
[0m20:50:34.143806 [debug] [ThreadPool]: On list_data_takehome_main: Close
[0m20:50:34.145420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd430694f-cea5-4e44-ab03-41eee23085be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104165730>]}
[0m20:50:34.145698 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m20:50:34.145857 [info ] [MainThread]: 
[0m20:50:34.148387 [debug] [Thread-1 (]: Began running node seed.data_takehome.raw_activities
[0m20:50:34.148627 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_takehome_main, now seed.data_takehome.raw_activities)
[0m20:50:34.148792 [debug] [Thread-1 (]: Began compiling node seed.data_takehome.raw_activities
[0m20:50:34.151771 [debug] [Thread-1 (]: Began executing node seed.data_takehome.raw_activities
[0m20:50:34.152095 [debug] [Thread-1 (]: Finished running node seed.data_takehome.raw_activities
[0m20:50:34.152269 [debug] [Thread-1 (]: Began running node seed.data_takehome.raw_patients
[0m20:50:34.152429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.data_takehome.raw_activities, now seed.data_takehome.raw_patients)
[0m20:50:34.152574 [debug] [Thread-1 (]: Began compiling node seed.data_takehome.raw_patients
[0m20:50:34.153344 [debug] [Thread-1 (]: Began executing node seed.data_takehome.raw_patients
[0m20:50:34.153617 [debug] [Thread-1 (]: Finished running node seed.data_takehome.raw_patients
[0m20:50:34.153776 [debug] [Thread-1 (]: Began running node seed.data_takehome.raw_pcns
[0m20:50:34.153926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.data_takehome.raw_patients, now seed.data_takehome.raw_pcns)
[0m20:50:34.154063 [debug] [Thread-1 (]: Began compiling node seed.data_takehome.raw_pcns
[0m20:50:34.154807 [debug] [Thread-1 (]: Began executing node seed.data_takehome.raw_pcns
[0m20:50:34.155056 [debug] [Thread-1 (]: Finished running node seed.data_takehome.raw_pcns
[0m20:50:34.155286 [debug] [Thread-1 (]: Began running node seed.data_takehome.raw_practices
[0m20:50:34.155482 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.data_takehome.raw_pcns, now seed.data_takehome.raw_practices)
[0m20:50:34.155641 [debug] [Thread-1 (]: Began compiling node seed.data_takehome.raw_practices
[0m20:50:34.156378 [debug] [Thread-1 (]: Began executing node seed.data_takehome.raw_practices
[0m20:50:34.156654 [debug] [Thread-1 (]: Finished running node seed.data_takehome.raw_practices
[0m20:50:34.156856 [debug] [Thread-3 (]: Began running node model.data_takehome.stg__activities
[0m20:50:34.157049 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.data_takehome.stg__activities'
[0m20:50:34.157203 [debug] [Thread-3 (]: Began compiling node model.data_takehome.stg__activities
[0m20:50:34.158478 [debug] [Thread-3 (]: Writing injected SQL for node "model.data_takehome.stg__activities"
[0m20:50:34.158730 [debug] [Thread-4 (]: Began running node model.data_takehome.stg__patients
[0m20:50:34.158925 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.data_takehome.stg__patients'
[0m20:50:34.159060 [debug] [Thread-4 (]: Began compiling node model.data_takehome.stg__patients
[0m20:50:34.160167 [debug] [Thread-4 (]: Writing injected SQL for node "model.data_takehome.stg__patients"
[0m20:50:34.160344 [debug] [Thread-5 (]: Began running node model.data_takehome.stg__pcns
[0m20:50:34.160528 [debug] [Thread-5 (]: Acquiring new duckdb connection 'model.data_takehome.stg__pcns'
[0m20:50:34.160669 [debug] [Thread-5 (]: Began compiling node model.data_takehome.stg__pcns
[0m20:50:34.161853 [debug] [Thread-5 (]: Writing injected SQL for node "model.data_takehome.stg__pcns"
[0m20:50:34.162159 [debug] [Thread-6 (]: Began running node model.data_takehome.stg__practices
[0m20:50:34.162416 [debug] [Thread-6 (]: Acquiring new duckdb connection 'model.data_takehome.stg__practices'
[0m20:50:34.162572 [debug] [Thread-6 (]: Began compiling node model.data_takehome.stg__practices
[0m20:50:34.163844 [debug] [Thread-6 (]: Writing injected SQL for node "model.data_takehome.stg__practices"
[0m20:50:34.164193 [debug] [Thread-3 (]: Began executing node model.data_takehome.stg__activities
[0m20:50:34.164488 [debug] [Thread-3 (]: Finished running node model.data_takehome.stg__activities
[0m20:50:34.164659 [debug] [Thread-6 (]: Began executing node model.data_takehome.stg__practices
[0m20:50:34.164929 [debug] [Thread-6 (]: Finished running node model.data_takehome.stg__practices
[0m20:50:34.165086 [debug] [Thread-4 (]: Began executing node model.data_takehome.stg__patients
[0m20:50:34.165340 [debug] [Thread-4 (]: Finished running node model.data_takehome.stg__patients
[0m20:50:34.165493 [debug] [Thread-5 (]: Began executing node model.data_takehome.stg__pcns
[0m20:50:34.165727 [debug] [Thread-5 (]: Finished running node model.data_takehome.stg__pcns
[0m20:50:34.166013 [debug] [Thread-8 (]: Began running node model.data_takehome.int__patients
[0m20:50:34.166267 [debug] [Thread-8 (]: Acquiring new duckdb connection 'model.data_takehome.int__patients'
[0m20:50:34.166452 [debug] [Thread-8 (]: Began compiling node model.data_takehome.int__patients
[0m20:50:34.166632 [debug] [Thread-9 (]: Began running node model.data_takehome.int__practices
[0m20:50:34.168257 [debug] [Thread-8 (]: Writing injected SQL for node "model.data_takehome.int__patients"
[0m20:50:34.168501 [debug] [Thread-9 (]: Acquiring new duckdb connection 'model.data_takehome.int__practices'
[0m20:50:34.168747 [debug] [Thread-9 (]: Began compiling node model.data_takehome.int__practices
[0m20:50:34.170059 [debug] [Thread-9 (]: Writing injected SQL for node "model.data_takehome.int__practices"
[0m20:50:34.170321 [debug] [Thread-8 (]: Began executing node model.data_takehome.int__patients
[0m20:50:34.170618 [debug] [Thread-8 (]: Finished running node model.data_takehome.int__patients
[0m20:50:34.170811 [debug] [Thread-9 (]: Began executing node model.data_takehome.int__practices
[0m20:50:34.171111 [debug] [Thread-9 (]: Finished running node model.data_takehome.int__practices
[0m20:50:34.171280 [debug] [Thread-11 ]: Began running node test.data_takehome.unique_int__patients_patient_id.96eaf91145
[0m20:50:34.171529 [debug] [Thread-11 ]: Acquiring new duckdb connection 'test.data_takehome.unique_int__patients_patient_id.96eaf91145'
[0m20:50:34.171684 [debug] [Thread-13 ]: Began running node model.data_takehome.patient_metadata
[0m20:50:34.171821 [debug] [Thread-11 ]: Began compiling node test.data_takehome.unique_int__patients_patient_id.96eaf91145
[0m20:50:34.172017 [debug] [Thread-13 ]: Acquiring new duckdb connection 'model.data_takehome.patient_metadata'
[0m20:50:34.177262 [debug] [Thread-11 ]: Writing injected SQL for node "test.data_takehome.unique_int__patients_patient_id.96eaf91145"
[0m20:50:34.177459 [debug] [Thread-13 ]: Began compiling node model.data_takehome.patient_metadata
[0m20:50:34.178734 [debug] [Thread-13 ]: Writing injected SQL for node "model.data_takehome.patient_metadata"
[0m20:50:34.179084 [debug] [Thread-13 ]: Began executing node model.data_takehome.patient_metadata
[0m20:50:34.179381 [debug] [Thread-13 ]: Finished running node model.data_takehome.patient_metadata
[0m20:50:34.179536 [debug] [Thread-11 ]: Began executing node test.data_takehome.unique_int__patients_patient_id.96eaf91145
[0m20:50:34.179837 [debug] [Thread-11 ]: Finished running node test.data_takehome.unique_int__patients_patient_id.96eaf91145
[0m20:50:34.180534 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:50:34.180667 [debug] [MainThread]: Connection 'seed.data_takehome.raw_practices' was properly closed.
[0m20:50:34.180783 [debug] [MainThread]: Connection 'model.data_takehome.stg__activities' was properly closed.
[0m20:50:34.180889 [debug] [MainThread]: Connection 'model.data_takehome.stg__patients' was properly closed.
[0m20:50:34.180989 [debug] [MainThread]: Connection 'model.data_takehome.stg__pcns' was properly closed.
[0m20:50:34.181087 [debug] [MainThread]: Connection 'model.data_takehome.stg__practices' was properly closed.
[0m20:50:34.181180 [debug] [MainThread]: Connection 'model.data_takehome.int__patients' was properly closed.
[0m20:50:34.181275 [debug] [MainThread]: Connection 'model.data_takehome.int__practices' was properly closed.
[0m20:50:34.181369 [debug] [MainThread]: Connection 'test.data_takehome.unique_int__patients_patient_id.96eaf91145' was properly closed.
[0m20:50:34.181464 [debug] [MainThread]: Connection 'model.data_takehome.patient_metadata' was properly closed.
[0m20:50:34.182193 [debug] [MainThread]: Command end result
[0m20:50:34.221164 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m20:50:34.221362 [info ] [MainThread]: Building catalog
[0m20:50:34.225568 [debug] [ThreadPool]: Acquiring new duckdb connection 'data_takehome.information_schema'
[0m20:50:34.228849 [debug] [ThreadPool]: Using duckdb connection "data_takehome.information_schema"
[0m20:50:34.229011 [debug] [ThreadPool]: On data_takehome.information_schema: BEGIN
[0m20:50:34.229133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:50:34.231644 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m20:50:34.231781 [debug] [ThreadPool]: Using duckdb connection "data_takehome.information_schema"
[0m20:50:34.231918 [debug] [ThreadPool]: On data_takehome.information_schema: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "data_takehome.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , '' as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'data_takehome'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , '' as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'data_takehome'
    )
    select
        'data_takehome' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        '' as column_comment,
        '' as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m20:50:34.247254 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m20:50:34.258152 [debug] [ThreadPool]: On data_takehome.information_schema: ROLLBACK
[0m20:50:34.258689 [debug] [ThreadPool]: Failed to rollback 'data_takehome.information_schema'
[0m20:50:34.258833 [debug] [ThreadPool]: On data_takehome.information_schema: Close
[0m20:50:34.286485 [info ] [MainThread]: Catalog written to /Users/qamr/Documents/Development/suvera/data-dbt-takehome/target/catalog.json
[0m20:50:34.288185 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.48725933, "process_user_time": 0.953361, "process_kernel_time": 0.145856, "process_mem_max_rss": "149028864", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:50:34.288482 [debug] [MainThread]: Command `dbt docs generate` succeeded at 20:50:34.288437 after 0.49 seconds
[0m20:50:34.288634 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m20:50:34.288746 [debug] [MainThread]: Connection 'data_takehome.information_schema' was properly closed.
[0m20:50:34.288883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e07440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104522840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104623260>]}
[0m20:50:34.289042 [debug] [MainThread]: Flushing usage events
[0m20:52:51.278377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106546db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d79af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d79760>]}


============================== 20:52:51.291852 | 217aec72-7e0d-4622-b208-3afc7924f3f3 ==============================
[0m20:52:51.291852 [info ] [MainThread]: Running with dbt=1.8.1
[0m20:52:51.292187 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/qamr/Documents/Development/suvera/data-dbt-takehome/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate --static', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:52:51.452886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '217aec72-7e0d-4622-b208-3afc7924f3f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106fdd60>]}
[0m20:52:51.496938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '217aec72-7e0d-4622-b208-3afc7924f3f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110cd310>]}
[0m20:52:51.497759 [info ] [MainThread]: Registered adapter: duckdb=1.8.1
[0m20:52:51.552262 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m20:52:51.620235 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:52:51.620468 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:52:51.641623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '217aec72-7e0d-4622-b208-3afc7924f3f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bd6ae0>]}
[0m20:52:51.654569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '217aec72-7e0d-4622-b208-3afc7924f3f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113e2330>]}
[0m20:52:51.654826 [info ] [MainThread]: Found 4 seeds, 7 models, 1 test, 421 macros
[0m20:52:51.654991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '217aec72-7e0d-4622-b208-3afc7924f3f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113a2ff0>]}
[0m20:52:51.655906 [info ] [MainThread]: 
[0m20:52:51.656183 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m20:52:51.658749 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_data_takehome_main'
[0m20:52:51.701861 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m20:52:51.702085 [debug] [ThreadPool]: On list_data_takehome_main: BEGIN
[0m20:52:51.702219 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:52:51.710212 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m20:52:51.710422 [debug] [ThreadPool]: Using duckdb connection "list_data_takehome_main"
[0m20:52:51.710564 [debug] [ThreadPool]: On list_data_takehome_main: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "list_data_takehome_main"} */
select
      'data_takehome' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where table_schema = 'main'
    and table_catalog = 'data_takehome'
  
[0m20:52:51.728096 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m20:52:51.731357 [debug] [ThreadPool]: On list_data_takehome_main: ROLLBACK
[0m20:52:51.732293 [debug] [ThreadPool]: Failed to rollback 'list_data_takehome_main'
[0m20:52:51.732432 [debug] [ThreadPool]: On list_data_takehome_main: Close
[0m20:52:51.734533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '217aec72-7e0d-4622-b208-3afc7924f3f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11112ac00>]}
[0m20:52:51.734854 [info ] [MainThread]: Concurrency: 24 threads (target='dev')
[0m20:52:51.735014 [info ] [MainThread]: 
[0m20:52:51.737968 [debug] [Thread-1 (]: Began running node seed.data_takehome.raw_activities
[0m20:52:51.738180 [debug] [Thread-2 (]: Began running node seed.data_takehome.raw_patients
[0m20:52:51.738405 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_data_takehome_main, now seed.data_takehome.raw_activities)
[0m20:52:51.738566 [debug] [Thread-3 (]: Began running node seed.data_takehome.raw_pcns
[0m20:52:51.738721 [debug] [Thread-4 (]: Began running node seed.data_takehome.raw_practices
[0m20:52:51.738913 [debug] [Thread-2 (]: Acquiring new duckdb connection 'seed.data_takehome.raw_patients'
[0m20:52:51.739072 [debug] [Thread-1 (]: Began compiling node seed.data_takehome.raw_activities
[0m20:52:51.739276 [debug] [Thread-3 (]: Acquiring new duckdb connection 'seed.data_takehome.raw_pcns'
[0m20:52:51.739459 [debug] [Thread-4 (]: Acquiring new duckdb connection 'seed.data_takehome.raw_practices'
[0m20:52:51.739608 [debug] [Thread-2 (]: Began compiling node seed.data_takehome.raw_patients
[0m20:52:51.742644 [debug] [Thread-1 (]: Began executing node seed.data_takehome.raw_activities
[0m20:52:51.742820 [debug] [Thread-3 (]: Began compiling node seed.data_takehome.raw_pcns
[0m20:52:51.742980 [debug] [Thread-4 (]: Began compiling node seed.data_takehome.raw_practices
[0m20:52:51.743767 [debug] [Thread-2 (]: Began executing node seed.data_takehome.raw_patients
[0m20:52:51.744083 [debug] [Thread-1 (]: Finished running node seed.data_takehome.raw_activities
[0m20:52:51.744893 [debug] [Thread-3 (]: Began executing node seed.data_takehome.raw_pcns
[0m20:52:51.745680 [debug] [Thread-4 (]: Began executing node seed.data_takehome.raw_practices
[0m20:52:51.745976 [debug] [Thread-2 (]: Finished running node seed.data_takehome.raw_patients
[0m20:52:51.746321 [debug] [Thread-3 (]: Finished running node seed.data_takehome.raw_pcns
[0m20:52:51.746535 [debug] [Thread-6 (]: Began running node model.data_takehome.stg__activities
[0m20:52:51.746827 [debug] [Thread-4 (]: Finished running node seed.data_takehome.raw_practices
[0m20:52:51.747113 [debug] [Thread-8 (]: Began running node model.data_takehome.stg__patients
[0m20:52:51.747308 [debug] [Thread-6 (]: Acquiring new duckdb connection 'model.data_takehome.stg__activities'
[0m20:52:51.747457 [debug] [Thread-9 (]: Began running node model.data_takehome.stg__pcns
[0m20:52:51.747688 [debug] [Thread-8 (]: Acquiring new duckdb connection 'model.data_takehome.stg__patients'
[0m20:52:51.747873 [debug] [Thread-11 ]: Began running node model.data_takehome.stg__practices
[0m20:52:51.748027 [debug] [Thread-6 (]: Began compiling node model.data_takehome.stg__activities
[0m20:52:51.748220 [debug] [Thread-9 (]: Acquiring new duckdb connection 'model.data_takehome.stg__pcns'
[0m20:52:51.748362 [debug] [Thread-8 (]: Began compiling node model.data_takehome.stg__patients
[0m20:52:51.748530 [debug] [Thread-11 ]: Acquiring new duckdb connection 'model.data_takehome.stg__practices'
[0m20:52:51.749794 [debug] [Thread-6 (]: Writing injected SQL for node "model.data_takehome.stg__activities"
[0m20:52:51.749957 [debug] [Thread-9 (]: Began compiling node model.data_takehome.stg__pcns
[0m20:52:51.751073 [debug] [Thread-8 (]: Writing injected SQL for node "model.data_takehome.stg__patients"
[0m20:52:51.751225 [debug] [Thread-11 ]: Began compiling node model.data_takehome.stg__practices
[0m20:52:51.752435 [debug] [Thread-9 (]: Writing injected SQL for node "model.data_takehome.stg__pcns"
[0m20:52:51.753823 [debug] [Thread-11 ]: Writing injected SQL for node "model.data_takehome.stg__practices"
[0m20:52:51.754179 [debug] [Thread-8 (]: Began executing node model.data_takehome.stg__patients
[0m20:52:51.754339 [debug] [Thread-6 (]: Began executing node model.data_takehome.stg__activities
[0m20:52:51.754788 [debug] [Thread-8 (]: Finished running node model.data_takehome.stg__patients
[0m20:52:51.755090 [debug] [Thread-6 (]: Finished running node model.data_takehome.stg__activities
[0m20:52:51.755268 [debug] [Thread-9 (]: Began executing node model.data_takehome.stg__pcns
[0m20:52:51.755409 [debug] [Thread-11 ]: Began executing node model.data_takehome.stg__practices
[0m20:52:51.755662 [debug] [Thread-13 ]: Began running node model.data_takehome.int__patients
[0m20:52:51.755935 [debug] [Thread-9 (]: Finished running node model.data_takehome.stg__pcns
[0m20:52:51.756208 [debug] [Thread-11 ]: Finished running node model.data_takehome.stg__practices
[0m20:52:51.756404 [debug] [Thread-13 ]: Acquiring new duckdb connection 'model.data_takehome.int__patients'
[0m20:52:51.756630 [debug] [Thread-13 ]: Began compiling node model.data_takehome.int__patients
[0m20:52:51.756799 [debug] [Thread-15 ]: Began running node model.data_takehome.int__practices
[0m20:52:51.758183 [debug] [Thread-13 ]: Writing injected SQL for node "model.data_takehome.int__patients"
[0m20:52:51.758389 [debug] [Thread-15 ]: Acquiring new duckdb connection 'model.data_takehome.int__practices'
[0m20:52:51.758563 [debug] [Thread-15 ]: Began compiling node model.data_takehome.int__practices
[0m20:52:51.759856 [debug] [Thread-15 ]: Writing injected SQL for node "model.data_takehome.int__practices"
[0m20:52:51.760080 [debug] [Thread-13 ]: Began executing node model.data_takehome.int__patients
[0m20:52:51.760346 [debug] [Thread-13 ]: Finished running node model.data_takehome.int__patients
[0m20:52:51.760577 [debug] [Thread-17 ]: Began running node test.data_takehome.unique_int__patients_patient_id.96eaf91145
[0m20:52:51.760730 [debug] [Thread-15 ]: Began executing node model.data_takehome.int__practices
[0m20:52:51.760935 [debug] [Thread-17 ]: Acquiring new duckdb connection 'test.data_takehome.unique_int__patients_patient_id.96eaf91145'
[0m20:52:51.761214 [debug] [Thread-15 ]: Finished running node model.data_takehome.int__practices
[0m20:52:51.761359 [debug] [Thread-17 ]: Began compiling node test.data_takehome.unique_int__patients_patient_id.96eaf91145
[0m20:52:51.765990 [debug] [Thread-17 ]: Writing injected SQL for node "test.data_takehome.unique_int__patients_patient_id.96eaf91145"
[0m20:52:51.766240 [debug] [Thread-19 ]: Began running node model.data_takehome.patient_metadata
[0m20:52:51.766477 [debug] [Thread-19 ]: Acquiring new duckdb connection 'model.data_takehome.patient_metadata'
[0m20:52:51.766638 [debug] [Thread-19 ]: Began compiling node model.data_takehome.patient_metadata
[0m20:52:51.768671 [debug] [Thread-19 ]: Writing injected SQL for node "model.data_takehome.patient_metadata"
[0m20:52:51.768899 [debug] [Thread-17 ]: Began executing node test.data_takehome.unique_int__patients_patient_id.96eaf91145
[0m20:52:51.769174 [debug] [Thread-17 ]: Finished running node test.data_takehome.unique_int__patients_patient_id.96eaf91145
[0m20:52:51.769405 [debug] [Thread-19 ]: Began executing node model.data_takehome.patient_metadata
[0m20:52:51.769691 [debug] [Thread-19 ]: Finished running node model.data_takehome.patient_metadata
[0m20:52:51.770420 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:52:51.770555 [debug] [MainThread]: Connection 'seed.data_takehome.raw_activities' was properly closed.
[0m20:52:51.770668 [debug] [MainThread]: Connection 'seed.data_takehome.raw_patients' was properly closed.
[0m20:52:51.770768 [debug] [MainThread]: Connection 'seed.data_takehome.raw_pcns' was properly closed.
[0m20:52:51.770863 [debug] [MainThread]: Connection 'seed.data_takehome.raw_practices' was properly closed.
[0m20:52:51.770961 [debug] [MainThread]: Connection 'model.data_takehome.stg__activities' was properly closed.
[0m20:52:51.771056 [debug] [MainThread]: Connection 'model.data_takehome.stg__patients' was properly closed.
[0m20:52:51.771152 [debug] [MainThread]: Connection 'model.data_takehome.stg__pcns' was properly closed.
[0m20:52:51.771248 [debug] [MainThread]: Connection 'model.data_takehome.stg__practices' was properly closed.
[0m20:52:51.771343 [debug] [MainThread]: Connection 'model.data_takehome.int__patients' was properly closed.
[0m20:52:51.771437 [debug] [MainThread]: Connection 'model.data_takehome.int__practices' was properly closed.
[0m20:52:51.771530 [debug] [MainThread]: Connection 'test.data_takehome.unique_int__patients_patient_id.96eaf91145' was properly closed.
[0m20:52:51.771623 [debug] [MainThread]: Connection 'model.data_takehome.patient_metadata' was properly closed.
[0m20:52:51.772383 [debug] [MainThread]: Command end result
[0m20:52:51.813037 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m20:52:51.813245 [info ] [MainThread]: Building catalog
[0m20:52:51.817512 [debug] [ThreadPool]: Acquiring new duckdb connection 'data_takehome.information_schema'
[0m20:52:51.820943 [debug] [ThreadPool]: Using duckdb connection "data_takehome.information_schema"
[0m20:52:51.821119 [debug] [ThreadPool]: On data_takehome.information_schema: BEGIN
[0m20:52:51.821240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:52:51.823839 [debug] [ThreadPool]: SQL status: OK in 0.003 seconds
[0m20:52:51.824012 [debug] [ThreadPool]: Using duckdb connection "data_takehome.information_schema"
[0m20:52:51.824231 [debug] [ThreadPool]: On data_takehome.information_schema: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "data_takehome", "target_name": "dev", "connection_name": "data_takehome.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , '' as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'data_takehome'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , '' as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'data_takehome'
    )
    select
        'data_takehome' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        '' as column_comment,
        '' as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m20:52:51.841767 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m20:52:51.852567 [debug] [ThreadPool]: On data_takehome.information_schema: ROLLBACK
[0m20:52:51.853083 [debug] [ThreadPool]: Failed to rollback 'data_takehome.information_schema'
[0m20:52:51.853222 [debug] [ThreadPool]: On data_takehome.information_schema: Close
[0m20:52:51.881062 [info ] [MainThread]: Catalog written to /Users/qamr/Documents/Development/suvera/data-dbt-takehome/target/catalog.json
[0m20:52:51.883913 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.6410928, "process_user_time": 0.95591, "process_kernel_time": 0.206603, "process_mem_max_rss": "148160512", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m20:52:51.884241 [debug] [MainThread]: Command `dbt docs generate` succeeded at 20:52:51.884194 after 0.64 seconds
[0m20:52:51.884406 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m20:52:51.884525 [debug] [MainThread]: Connection 'data_takehome.information_schema' was properly closed.
[0m20:52:51.884679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107ed190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10499a960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116ff440>]}
[0m20:52:51.884841 [debug] [MainThread]: Flushing usage events
[0m20:53:11.045348 [debug] [MainThread]: Error sending anonymous usage statistics. Disabling tracking for this execution. If you wish to permanently disable tracking, see: https://docs.getdbt.com/reference/global-configs#send-anonymous-usage-stats.
